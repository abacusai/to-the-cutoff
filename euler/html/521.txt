<p>
Let $\operatorname{smpf}(n)$ be the smallest prime factor of $n$.<br>
$\operatorname{smpf}(91)=7$ because $91=7\times 13$ and $\operatorname{smpf}(45)=3$ because $45=3\times 3\times 5$.<br>
Let $S(n)$ be the sum of $\operatorname{smpf}(i)$ for $2 \le i \le n$.<br>
E.g. $S(100)=1257$.
</p>

<p>
Find $S(10^{12}) \bmod 10^9$.
</p>

