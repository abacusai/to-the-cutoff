<p>
Let $S(n)$ be the sum of all positive integers $m$ not exceeding $n$ having the following property:<br>
$a^{m + 4} \equiv a \pmod m$ for all integers $a$.
</p>
<p>
The values of $m \le 100$ that satisfy this property are $1, 2, 3, 5$ and $21$, thus $S(100) = 1+2+3+5+21 = 32$.<br>
You are given $S(10^6) = 22868117$.
</p>
<p>
Find $S(10^{12})$.
</p>


