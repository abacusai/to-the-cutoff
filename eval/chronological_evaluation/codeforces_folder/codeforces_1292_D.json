[
    {
        "name": "Chaotic V.",
        "description": "\u00c6sir - CHAOS \u00c6sir - V. \"Everything has been planned out. No more hidden\nconcerns. The condition of Cytus is also perfect. The time right now......\n00:01:12...... It's time.\" The emotion samples are now sufficient. After\nalmost 3 years, it's time for Ivy to awake her bonded sister, Vanessa. The\nsystem inside A.R.C.'s Library core can be considered as an undirected graph\nwith infinite number of processing nodes, numbered with all positive integers\n(\n    1, 2, 3, \n    \u2026\n). The node with a number \n    x\n (\n    x > 1\n), is\ndirectly connected with a node with number \n    x/f(x)\n, with\n\n    f(x)\n being the lowest prime divisor of \n    x\n. Vanessa's mind is\ndivided into \n    n\n fragments. Due to more than 500 years of coma, the\nfragments have been scattered: the \n    i\n-th fragment is now located at the\nnode with a number \n    k_i!\n (a factorial of \n    k_i\n). To maximize the\nchance of successful awakening, Ivy decides to place the samples in a node\n\n    P\n, so that the total length of paths from each fragment to \n    P\n is\nsmallest possible. If there are multiple fragments located at the same node,\nthe path from that node to \n    P\n needs to be counted multiple times. In the\nworld of zeros and ones, such a requirement is very simple for Ivy. Not longer\nthan a second later, she has already figured out such a node. But for a mere\nhuman like you, is this still possible? For simplicity, please answer the\nminimal sum of paths' lengths from every fragment to the emotion samples'\nassembly node \n    P\n. Input The first line contains an integer \n    n\n (\n    1\n    \n    \u2264 n \n    \u2264 10^6\n) \u2014 number of fragments of Vanessa's mind. The second\nline contains \n    n\n integers: \n    k_1, k_2, \n    \u2026, k_n\n (\n    0 \n    \u2264 k_i\n    \n    \u2264 5000\n), denoting the nodes where fragments of Vanessa's mind are\nlocated: the \n    i\n-th fragment is at the node with a number \n    k_i!\n.\nOutput Print a single integer, denoting the minimal sum of path from every\nfragment to the node with the emotion samples (a.k.a. node \n    P\n). As a\nreminder, if there are multiple fragments at the same node, the distance from\nthat node to \n    P\n needs to be counted multiple times as well. Examples\nInput 3 2 1 4 Output 5 Input 4 3 1 4 4 Output 6 Input 4 3 1 4 1 Output 6 Input\n5 3 1 4 1 5 Output 11 Note Considering the first \n    24\n nodes of the system,\nthe node network will look as follows (the nodes \n    1!\n, \n    2!\n, \n    3!\n,\n\n    4!\n are drawn bold): For the first example, Ivy will place the emotion\nsamples at the node \n    1\n. From here: The distance from Vanessa's first\nfragment to the node \n    1\n is \n    1\n. The distance from Vanessa's second\nfragment to the node \n    1\n is \n    0\n. The distance from Vanessa's third\nfragment to the node \n    1\n is \n    4\n. The total length is \n    5\n. For the\nsecond example, the assembly node will be \n    6\n. From here: The distance\nfrom Vanessa's first fragment to the node \n    6\n is \n    0\n. The distance\nfrom Vanessa's second fragment to the node \n    6\n is \n    2\n. The distance\nfrom Vanessa's third fragment to the node \n    6\n is \n    2\n. The distance\nfrom Vanessa's fourth fragment to the node \n    6\n is again \n    2\n. The total\npath length is \n    6\n.\n\n",
        "cf_contest_id": 1292,
        "cf_index": "D",
        "cf_rating": 2700,
        "difficulty": 0,
        "cf_tags": [
            "dp",
            "graphs",
            "greedy",
            "math",
            "number theory",
            "trees"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "3\r\n2 1 4\r\n",
                "5\r\n"
            ],
            [
                "4\r\n3 1 4 4\r\n",
                "6\r\n"
            ],
            [
                "4\r\n3 1 4 1\r\n",
                "6\r\n"
            ],
            [
                "5\r\n3 1 4 1 5\r\n",
                "11\r\n"
            ]
        ],
        "private_cases": [
            [
                "11\r\n5000 5000 5000 5000 5000 5000 0 1 0 1 0\r\n",
                "77835\r\n"
            ],
            [
                "1\r\n0\r\n",
                "0\r\n"
            ],
            [
                "1\r\n1\r\n",
                "0\r\n"
            ],
            [
                "4\r\n0 1 1 0\r\n",
                "0\r\n"
            ],
            [
                "17\r\n1 9 2 8 4 5 7 3 8 4 6 2 8 4 1 0 5\r\n",
                "87\r\n"
            ],
            [
                "4\r\n57 918 827 953\r\n",
                "7835\r\n"
            ],
            [
                "51\r\n17 26 14 0 41 18 40 14 29 25 5 23 46 20 8 14 12 27 8 38 9 42 17 16 31 2 5 45 16 35 37 1 46 27 27 16 20 38 11 48 11 3 23 40 10 46 31 47 32 49 17\r\n",
                "2366\r\n"
            ],
            [
                "95\r\n28 12 46 4 24 37 23 19 7 22 29 34 10 10 9 11 9 17 26 23 8 42 12 31 33 39 25 17 1 41 30 21 11 26 14 43 19 24 32 14 3 42 29 47 40 16 27 43 33 28 6 25 40 4 0 21 5 36 2 3 35 38 49 41 32 34 0 27 30 44 45 18 2 6 1 50 13 22 20 20 7 5 16 18 13 15 15 36 39 37 31 35 48 38 8\r\n",
                "4286\r\n"
            ],
            [
                "49\r\n27 12 48 48 9 10 29 50 48 48 48 48 11 14 18 27 48 48 48 48 1 48 33 48 27 48 48 48 12 16 48 48 22 48 48 36 31 32 31 48 50 43 20 48 48 48 48 48 16\r\n",
                "3484\r\n"
            ],
            [
                "17\r\n12 12 5 1 3 12 4 2 12 12 12 12 6 12 7 12 0\r\n",
                "179\r\n"
            ],
            [
                "70\r\n50 0 50 0 0 0 0 0 0 50 50 50 50 0 50 50 0 50 50 0 0 0 50 50 0 0 50 0 50 0 50 0 0 50 0 0 0 0 50 50 50 50 0 0 0 0 0 0 0 0 50 0 50 50 0 50 0 0 0 0 50 0 50 0 0 50 0 50 0 0\r\n",
                "3024\r\n"
            ],
            [
                "13\r\n0 0 0 0 0 0 0 0 0 0 0 0 50\r\n",
                "108\r\n"
            ],
            [
                "45\r\n50 0 0 0 0 0 0 0 0 50 0 0 50 0 0 50 50 0 0 0 0 0 50 0 0 0 0 0 50 50 0 0 0 0 50 0 50 0 50 0 0 0 0 0 50\r\n",
                "1296\r\n"
            ],
            [
                "24\r\n50 0 50 50 50 0 50 50 0 50 50 50 50 50 0 50 50 0 50 50 50 50 50 50\r\n",
                "540\r\n"
            ],
            [
                "68\r\n50 50 50 50 50 50 50 50 0 0 50 50 50 50 50 50 50 50 50 50 50 50 0 50 50 50 50 50 50 50 50 50 50 50 0 50 50 50 50 50 50 50 50 50 50 50 50 50 0 50 50 0 0 50 50 50 50 50 50 50 50 0 50 50 50 50 50 50\r\n",
                "864\r\n"
            ],
            [
                "75\r\n2597 1818 260 4655 4175 2874 2987 4569 2029 4314 444 2276 4937 1209 1797 4965 3526 275 3535 2198 4402 2144 1369 13 4453 1655 4456 711 3563 1650 3997 885 782 147 2426 974 2917 2100 4549 2465 3015 3485 3238 4086 171 3934 1903 133 2278 2573 688 551 872 459 2044 1401 2429 4933 3747 587 2781 4173 4651 4012 1407 2352 1461 566 2062 4599 1430 2269 3914 1820 4728\r\n",
                "565559\r\n"
            ],
            [
                "29\r\n8 27 14 21 6 20 2 11 3 19 10 16 0 25 18 4 23 17 15 26 28 1 13 5 9 22 12 7 24\r\n",
                "692\r\n"
            ],
            [
                "87\r\n1120 1120 1120 872 1120 731 3583 2815 4019 1291 4568 973 1120 1705 1120 822 203 1120 1120 1120 1120 4196 3166 4589 3030 1120 1120 1120 711 1120 500 1120 1120 3551 1120 1120 1120 1700 1120 1120 2319 4554 1120 1312 1120 1120 4176 1120 1120 3661 1120 1120 1120 1120 142 63 4125 1120 4698 3469 1829 567 1120 1120 1083 486 1120 1120 1120 1120 3763 1120 247 4496 454 1120 1120 1532 1120 4142 352 1120 359 2880 1120 1120 4494\r\n",
                "438276\r\n"
            ],
            [
                "27\r\n9 1144 1144 2 8 1144 12 0 1144 1144 7 3 1144 1144 11 10 1 1144 1144 5 1144 4 1144 1144 1144 1144 6\r\n",
                "43222\r\n"
            ],
            [
                "27\r\n0 5000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5000 5000 0 0 0 5000\r\n",
                "62268\r\n"
            ],
            [
                "59\r\n0 0 0 5000 0 0 0 5000 5000 0 5000 0 0 0 5000 0 0 0 0 0 0 0 0 0 5000 0 0 0 0 5000 0 5000 0 5000 0 0 5000 0 5000 0 0 0 0 0 0 5000 0 0 0 0 5000 0 0 0 5000 0 0 0 5000\r\n",
                "233505\r\n"
            ],
            [
                "80\r\n0 0 0 0 5000 0 0 5000 5000 5000 0 5000 0 5000 5000 0 0 0 0 5000 5000 0 0 5000 0 5000 5000 5000 0 5000 0 5000 5000 5000 0 0 5000 0 0 5000 5000 0 0 5000 0 5000 5000 5000 0 0 5000 5000 5000 0 0 5000 0 0 5000 0 5000 5000 0 5000 0 5000 0 5000 0 5000 0 0 0 0 5000 5000 5000 0 0 0\r\n",
                "591546\r\n"
            ],
            [
                "20\r\n0 5000 5000 5000 5000 5000 0 5000 5000 0 5000 5000 5000 0 5000 5000 5000 5000 0 5000\r\n",
                "77835\r\n"
            ],
            [
                "78\r\n0 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 0 5000 5000 5000 5000 5000 5000 0 0 5000 5000 5000 5000 5000 0 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 0 5000 5000 0 5000 0 5000 5000 5000 5000 0 5000 5000 5000 5000 5000 5000 5000 0 5000 5000 0 0 0 5000 5000 5000 5000 0 5000 5000 5000 5000 5000 5000 0 5000 5000 0 5000\r\n",
                "249072\r\n"
            ],
            [
                "4\r\n13 14 15 16\r\n",
                "76\r\n"
            ],
            [
                "3\r\n1 5 6\r\n",
                "10\r\n"
            ],
            [
                "3\r\n15 13 2\r\n",
                "42\r\n"
            ],
            [
                "3\r\n1 8 9\r\n",
                "20\r\n"
            ],
            [
                "3\r\n2 5 6\r\n",
                "11\r\n"
            ]
        ]
    }
]