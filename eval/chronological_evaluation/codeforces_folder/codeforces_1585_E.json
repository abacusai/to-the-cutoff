[
    {
        "name": "Frequency Queries",
        "description": "Petya has a rooted tree with an integer written on each vertex. The vertex\n\n    1\n is the root. You are to answer some questions about the tree. A tree\nis a connected graph without cycles. A rooted tree has a special vertex called\nthe root. The parent of a node \n    v\n is the next vertex on the shortest path\nfrom \n    v\n to the root. Each question is defined by three integers \n    v\n,\n\n    l\n, and \n    k\n. To get the answer to the question, you need to perform\nthe following steps: First, write down the sequence of all integers written on\nthe shortest path from the vertex \n    v\n to the root (including those written\nin the \n    v\n and the root). Count the number of times each integer occurs.\nRemove all integers with less than \n    l\n occurrences. Replace the sequence,\nremoving all duplicates and ordering the elements by the number of occurrences\nin the original list in increasing order. In case of a tie, you can choose the\norder of these elements arbitrary. The answer to the question is the\n\n    k\n-th number in the remaining sequence. Note that the answer is not\nalways uniquely determined, because there could be several orderings. Also, it\nis possible that the length of the sequence on this step is less than \n    k\n,\nin this case the answer is \n    -1\n. For example, if the sequence of integers\non the path from \n    v\n to the root is \n    [2, 2, 1, 7, 1, 1, 4, 4, 4, 4]\n,\n\n    l = 2\n and \n    k = 2\n, then the answer is \n    1\n. Please answer all\nquestions about the tree. Input Each test contains multiple test cases. The\nfirst line contains the number of test cases \n    t\n (\n    1 \n    \u2264 t \n    \u2264\n    10^6\n). Description of the test cases follows. The first line of each test\ncase contains two integers \n    n\n, \n    q\n (\n    1 \n    \u2264 n, q \n    \u2264 10^6\n)\n\u2014 the number of vertices in the tree and the number of questions. The second\nline contains \n    n\n integers \n    a_1, a_2, \n    \u2026, a_n\n (\n    1 \n    \u2264 a_i\n    \n    \u2264 n\n), where \n    a_i\n is the number written on the \n    i\n-th vertex.\nThe third line contains \n    n-1\n integers \n    p_2, p_3, \n    \u2026, p_n\n (\n    1\n    \n    \u2264 p_i \n    \u2264 n\n), where \n    p_i\n is the parent of node \n    i\n. It's\nguaranteed that the values \n    p\n define a correct tree. Each of the next\n\n    q\n lines contains three integers \n    v\n, \n    l\n, \n    k\n (\n    1 \n    \u2264\n    v, l, k \n    \u2264 n\n) \u2014 descriptions of questions. It is guaranteed that the\nsum of \n    n\n and the sum of \n    q\n over all test cases do not exceed\n\n    10^6\n. Output For each question of each test case print the answer to the\nquestion. In case of multiple answers, print any. Example Input 2 3 3 1 1 1 1\n2 3 1 1 3 1 2 3 2 1 5 5 1 2 1 1 2 1 1 2 2 3 1 1 2 1 2 4 1 1 4 2 1 4 2 2 Output\n1 -1 1 1 1 2 1 -1\n\n",
        "cf_contest_id": 1585,
        "cf_index": "E",
        "cf_rating": 2400,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "dfs and similar",
            "trees"
        ],
        "time_limit_seconds": 4.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "2\r\n3 3\r\n1 1 1\r\n1 2\r\n3 1 1\r\n3 1 2\r\n3 2 1\r\n5 5\r\n1 2 1 1 2\r\n1 1 2 2\r\n3 1 1\r\n2 1 2\r\n4 1 1\r\n4 2 1\r\n4 2 2\r\n",
                "1 -1 1 \r\n1 1 2 1 -1 \r\n"
            ]
        ],
        "private_cases": [
            [
                "1\r\n1 1\r\n1\r\n\r\n1 1 1\r\n",
                "1 \r\n"
            ]
        ]
    }
]