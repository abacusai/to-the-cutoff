[
    {
        "name": "Koxia and Game",
        "description": "Koxia and Mahiru are playing a game with three arrays \n    a\n, \n    b\n, and\n\n    c\n of length \n    n\n. Each element of \n    a\n, \n    b\n and \n    c\n is an\ninteger between \n    1\n and \n    n\n inclusive. The game consists of \n    n\n\nrounds. In the \n    i\n-th round, they perform the following moves: Let \n    S\n\nbe the multiset \n    a_i, b_i, c_i\n. Koxia removes one element from\nthe multiset \n    S\n by her choice. Mahiru chooses one integer from the two\nremaining in the multiset \n    S\n. Let \n    d_i\n be the integer Mahiru chose\nin the \n    i\n-th round. If \n    d\n is a permutation\n    ^\n    \u2020\n, Koxia\nwins. Otherwise, Mahiru wins. Currently, only the arrays \n    a\n and \n    b\n\nhave been chosen. As an avid supporter of Koxia, you want to choose an array\n\n    c\n such that Koxia will win. Count the number of such \n    c\n, modulo\n\n    998\n     244\n     353\n. Note that Koxia and Mahiru both play optimally.\n\n    ^\n    \u2020\n A permutation of length \n    n\n is an array consisting of\n\n    n\n distinct integers from \n    1\n to \n    n\n in arbitrary order. For\nexample, \n    [2,3,1,5,4]\n is a permutation, but \n    [1,2,2]\n is not a\npermutation (\n    2\n appears twice in the array), and \n    [1,3,4]\n is also\nnot a permutation (\n    n=3\n but there is \n    4\n in the array). Input Each\ntest consists of multiple test cases. The first line contains a single integer\n\n    t\n (\n    1 \n    \u2264 t \n    \u2264 2 \n    \u00b7 10^4\n) \u2014 the number of test cases.\nThe description of test cases follows. The first line of each test case\ncontains a single integer \n    n\n (\n    1 \n    \u2264 n \n    \u226410^5\n) \u2014 the size\nof the arrays. The second line of each test case contains \n    n\n integers\n\n    a_1, a_2, \n    \u2026, a_n\n (\n    1 \n    \u2264 a_i \n    \u2264 n\n). The third line of\neach test case contains \n    n\n integers \n    b_1, b_2, \n    \u2026, b_n\n (\n    1\n    \n    \u2264 b_i \n    \u2264 n\n). It is guaranteed that the sum of \n    n\n over all\ntest cases does not exceed \n    10^5\n. Output Output a single integer \u2014 the\nnumber of \n    c\n makes Koxia win, modulo \n    998\n     244\n     353\n. Example\nInput 2 3 1 2 2 1 3 3 5 3 3 1 3 4 4 5 2 5 5 Output 6 0 Note In the first test\ncase, there are \n    6\n possible arrays \n    c\n that make Koxia win \u2014 \n    [1,\n    2, 3]\n, \n    [1, 3, 2]\n, \n    [2, 2, 3]\n, \n    [2, 3, 2]\n, \n    [3, 2, 3]\n,\n\n    [3, 3, 2]\n. In the second test case, it can be proved that no array\n\n    c\n makes Koxia win.\n\n",
        "cf_contest_id": 1770,
        "cf_index": "D",
        "cf_rating": 2000,
        "difficulty": 0,
        "cf_tags": [
            "constructive algorithms",
            "data structures",
            "dfs and similar",
            "dsu",
            "flows",
            "games",
            "graph matchings",
            "graphs",
            "implementation"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2\r\n3\r\n1 2 2\r\n1 3 3\r\n5\r\n3 3 1 3 4\r\n4 5 2 5 5\r\n",
                "6\r\n0\r\n"
            ]
        ],
        "private_cases": []
    }
]