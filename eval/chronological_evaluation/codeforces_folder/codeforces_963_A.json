[
    {
        "name": "Alternating Sum",
        "description": "You are given two integers \n    a\n and \n    b\n. Moreover, you are given a\nsequence \n    s_0, s_1, \n    \u2026, s_n\n. All values in \n    s\n are integers\n\n    1\n or \n    -1\n. It's known that sequence is \n    k\n-periodic and \n    k\n\ndivides \n    n+1\n. In other words, for each \n    k \n    \u2264 i \n    \u2264 n\n it's\nsatisfied that \n    s_i = s_i - k\n. Find out the non-negative remainder of\ndivision of \n    \u2211\n    _i=0^n s_i a^n - i b^i\n by\n\n    10^9 + 9\n. Note that the modulo is unusual! Input The first line\ncontains four integers \n    n, a, b\n and \n    k\n \n    (1 \n    \u2264 n \n    \u2264 10^9,\n    1 \n    \u2264 a, b \n    \u2264 10^9, 1 \n    \u2264 k \n    \u2264 10^5)\n. The second line\ncontains a sequence of length \n    k\n consisting of characters '+' and '-'. If\nthe \n    i\n-th character (0-indexed) is '+', then \n    s_i = 1\n, otherwise\n\n    s_i = -1\n. Note that only the first \n    k\n members of the sequence are\ngiven, the rest can be obtained using the periodicity property. Output Output\na single integer \u2014 value of given expression modulo \n    10^9 + 9\n. Examples\nInput 2 2 3 3 +-+ Output 7 Input 4 1 5 1 \u00ad Output 999999228 Note In the first\nexample: \n    (\n    \u2211\n    _i=0^n s_i a^n - i b^i)\n = \n    2^2\n    3^0 - 2^1 3^1 + 2^0 3^2\n = 7 In the second example: \n    (\n    \u2211\n    _i=0^n s_i a^n - i b^i) = -1^4 5^0 - 1^3 5^1 -\n    1^2 5^2 - 1^1 5^3 - 1^0 5^4 = -781 \n    \u2261 999999228\n    \n    10^9 + 9\n.\n\n",
        "cf_contest_id": 963,
        "cf_index": "A",
        "cf_rating": 1800,
        "difficulty": 0,
        "cf_tags": [
            "math",
            "number theory"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2 2 3 3\r\n+-+\r\n",
                "7\r\n"
            ],
            [
                "4 1 5 1\r\n-\r\n",
                "999999228\r\n"
            ]
        ],
        "private_cases": [
            [
                "1 1 4 2\r\n-+\r\n",
                "3\r\n"
            ],
            [
                "3 1 4 4\r\n+--+\r\n",
                "45\r\n"
            ],
            [
                "5 1 1 6\r\n++---+\r\n",
                "0\r\n"
            ],
            [
                "5 2 2 6\r\n+--++-\r\n",
                "0\r\n"
            ],
            [
                "686653196 115381398 884618610 3\r\n+-+\r\n",
                "542231211\r\n"
            ],
            [
                "608663287 430477711 172252358 8\r\n-+--+-+-\r\n",
                "594681696\r\n"
            ],
            [
                "904132655 827386249 118827660 334\r\n+++-+++++--+++----+-+-+-+-+--+-+---++--++--++--+-+-+++-+++--+-+-+----+-+-++++-----+--++++------+++-+-+-++-++++++++-+-++-+++--+--++------+--+-+++--++--+---++-++-+-+-++---++-++--+-+-++-+------+-+----+++-+++--+-+-+--+--+--+------+--+---+--+-++--+++---+-+-++--------+-++--++-+-+-+-+-+-+--+-++++-+++--+--++----+--+-++-++--+--+-+-++-+-++++-\r\n",
                "188208979\r\n"
            ],
            [
                "234179195 430477711 115381398 12\r\n++++-+-+-+++\r\n",
                "549793323\r\n"
            ],
            [
                "75952547 967294208 907708706 252\r\n++--++--+++-+-+--++--++++++---+++-++-+-----++++--++-+-++------+-+-+-++-+-+-++++------++---+-++++---+-+-++++--++++++--+-+++-++--+--+---++++---+-+++-+++--+-+--+++++---+--++-++++--++++-+-++-+++-++-----+-+++++----++--+++-+-+++++-+--++-++-+--+-++++--+-+-+-+\r\n",
                "605712499\r\n"
            ],
            [
                "74709071 801809249 753674746 18\r\n++++++-+-+---+-+--\r\n",
                "13414893\r\n"
            ],
            [
                "743329 973758 92942 82\r\n++----+-++++----+--+++---+--++++-+-+---+++++--+--+++++++--++-+++----+--+++++-+--+-\r\n",
                "299311566\r\n"
            ],
            [
                "18111 291387 518587 2\r\n++\r\n",
                "724471355\r\n"
            ],
            [
                "996144 218286 837447 1\r\n-\r\n",
                "549104837\r\n"
            ],
            [
                "179358 828426 548710 67\r\n++++---+--++----+-+-++++----+--+---+------++-+-++++--+----+---+-+--\r\n",
                "759716474\r\n"
            ],
            [
                "397521 174985 279760 1\r\n+\r\n",
                "25679493\r\n"
            ],
            [
                "613632 812232 482342 1\r\n-\r\n",
                "891965141\r\n"
            ],
            [
                "936810 183454 647048 1\r\n+\r\n",
                "523548992\r\n"
            ],
            [
                "231531 250371 921383 28\r\n++-+------+--+--++++--+-+++-\r\n",
                "134450934\r\n"
            ],
            [
                "947301 87242 360762 97\r\n--+++--+++-++--++-++--++--+++---+++--++++--+++++--+-++-++-----+-++-+--++-----+-++-+--++-++-+-----\r\n",
                "405016159\r\n"
            ],
            [
                "425583346 814209084 570987274 1\r\n+\r\n",
                "63271171\r\n"
            ],
            [
                "354062556 688076879 786825319 1\r\n+\r\n",
                "545304776\r\n"
            ],
            [
                "206671954 13571766 192250278 1\r\n+\r\n",
                "717117421\r\n"
            ],
            [
                "23047921 621656196 160244047 1\r\n-\r\n",
                "101533009\r\n"
            ],
            [
                "806038018 740585177 987616107 293\r\n-+++++--++++---++-+--+-+---+-++++--+--+++--++---++++++++--+++++-+-++-+--+----+--+++-+-++-+++-+-+-+----------++-+-+++++++-+-+-+-++---+++-+-+-------+-+-++--++-++-++-++-+---+--++-++--+++--+++-+-+----++--+-+-++-+---+---+-+-+++------+-+++-+---++-+--+++----+++++---++-++--+----+++-+--+++-+------+-++\r\n",
                "441468166\r\n"
            ],
            [
                "262060935 184120408 148332034 148\r\n+--+-------+-+-+--++-+++--++-+-++++++--++-+++-+++--+-------+-+--+++-+-+-+---++-++-+-++---+--+-+-+--+------+++--+--+-+-+---+---+-+-++++---+++--+++---\r\n",
                "700325386\r\n"
            ],
            [
                "919350941 654611542 217223605 186\r\n++-++-+++++-+++--+---+++++++-++-+----+-++--+-++--++--+++-+++---+--+--++-+-+++-+-+++-++---+--+++-+-+++--+-+-------+-++------++---+-+---++-++-++---+-+--+-+--+++++---+--+--++++-++-++--+--++\r\n",
                "116291420\r\n"
            ],
            [
                "289455627 906207104 512692624 154\r\n-------++--+++---++-++------++----------+--+++-+-+++---+---+++--++++++--+-+-+--+---+-+-++-++--+-++--++++---+-+---+-----+--+-+---------+++-++---++-+-+-----\r\n",
                "48198216\r\n"
            ],
            [
                "258833760 515657142 791267045 1\r\n-\r\n",
                "935800888\r\n"
            ],
            [
                "691617927 66917103 843055237 8\r\n--+++---\r\n",
                "147768186\r\n"
            ],
            [
                "379582849 362892355 986900829 50\r\n++-++---+-+++++--++++--+--++--++-----+------++--+-\r\n",
                "927469713\r\n"
            ],
            [
                "176799169 363368399 841293419 1\r\n+\r\n",
                "746494802\r\n"
            ],
            [
                "144808247 203038656 166324035 4\r\n-+-+\r\n",
                "909066471\r\n"
            ],
            [
                "477607531 177367565 20080950 2\r\n++\r\n",
                "928662830\r\n"
            ],
            [
                "682074525 289438443 917164266 1\r\n+\r\n",
                "28048785\r\n"
            ],
            [
                "938449224 59852396 219719125 1\r\n-\r\n",
                "648647459\r\n"
            ],
            [
                "395171426 872478622 193568600 147\r\n+---++---+-+--+++++--+---+-++++-+-++---++++--+--+-+-++-+-++--------++---+++-+---++---+---+-+--+-++++-+++-+-+-++-+--+++-++-+-+-+-++++++-+---+---++--\r\n",
                "460881399\r\n"
            ],
            [
                "403493428 317461491 556701240 1\r\n-\r\n",
                "936516261\r\n"
            ],
            [
                "917751169 330191895 532837377 70\r\n-+-+++++++--++---++-+++++-+++-----+-+++---+--+-+-++-++-+-+-++-++-+----\r\n",
                "908035409\r\n"
            ],
            [
                "252089413 552678586 938424519 1\r\n-\r\n",
                "627032736\r\n"
            ],
            [
                "649316142 320010793 200197645 1\r\n-\r\n",
                "323650777\r\n"
            ],
            [
                "116399299 784781190 299072480 5\r\n++++-\r\n",
                "754650814\r\n"
            ]
        ]
    }
]