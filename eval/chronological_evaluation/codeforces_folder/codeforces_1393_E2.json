[
    {
        "name": "Twilight and Ancient Scroll (harder version)",
        "description": "This is a harder version of the problem E with larger constraints. Twilight\nSparkle has received a new task from Princess Celestia. This time she asked to\ndecipher the ancient scroll containing important knowledge of pony origin. To\nhide the crucial information from evil eyes, pony elders cast a spell on the\nscroll. That spell adds exactly one letter in any place to each word it is\ncast on. To make the path to the knowledge more tangled elders chose some of\nwords in the scroll and cast a spell on them. Twilight Sparkle knows that the\nelders admired the order in all things so the scroll original scroll contained\nwords in lexicographically non-decreasing order. She is asked to delete one\nletter from some of the words of the scroll (to undo the spell) to get some\nversion of the original scroll. Unfortunately, there may be more than one way\nto recover the ancient scroll. To not let the important knowledge slip by\nTwilight has to look through all variants of the original scroll and find the\nrequired one. To estimate the maximum time Twilight may spend on the work she\nneeds to know the number of variants she has to look through. She asks you to\nfind that number! Since that number can be very big, Twilight asks you to find\nit modulo \n    10^9+7\n. It may occur that princess Celestia has sent a wrong\nscroll so the answer may not exist. A string \n    a\n is lexicographically\nsmaller than a string \n    b\n if and only if one of the following holds:\n\n    a\n is a prefix of \n    b\n, but \n    a \n     b\n; in the first position\nwhere \n    a\n and \n    b\n differ, the string \n    a\n has a letter that appears\nearlier in the alphabet than the corresponding letter in \n    b\n. Input The\nfirst line contains a single integer \n    n\n (\n    1 \n    \u2264 n \n    \u2264 10^5\n): the\nnumber of words in the scroll. The \n    i\n-th of the next \n    n\n lines\ncontains a string consisting of lowercase English letters: the \n    i\n-th word\nin the scroll. The length of each word is at least one. The sum of lengths of\nwords does not exceed \n    10^6\n. Output Print one integer: the number of ways\nto get a version of the original from the scroll modulo \n    10^9+7\n. Examples\nInput 3 abcd zaza ataka Output 4 Input 4 dfs bfs sms mms Output 8 Input 3 abc\nbcd a Output 0 Input 6 lapochka kartyshka bigbabytape morgenshtern\nssshhhiiittt queen Output 2028 Note Notice that the elders could have written\nan empty word (but they surely cast a spell on it so it holds a length \n    1\n\nnow).\n\n",
        "cf_contest_id": 1393,
        "cf_index": "E2",
        "cf_rating": 3200,
        "difficulty": 0,
        "cf_tags": [
            "dp",
            "hashing",
            "implementation",
            "string suffix structures",
            "strings",
            "two pointers"
        ],
        "time_limit_seconds": 1.5,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3\r\nabcd\r\nzaza\r\nataka\r\n",
                "4"
            ],
            [
                "4\r\ndfs\r\nbfs\r\nsms\r\nmms\r\n",
                "8"
            ],
            [
                "3\r\nabc\r\nbcd\r\na\r\n",
                "0"
            ],
            [
                "6\r\nlapochka\r\nkartyshka\r\nbigbabytape\r\nmorgenshtern\r\nssshhhiiittt\r\nqueen\r\n",
                "2028"
            ]
        ],
        "private_cases": [
            [
                "12\r\naaaaaaaaa\r\nbbbbbbbbb\r\nccccccccc\r\nddddddddd\r\neeeeeeeee\r\nfffffffff\r\nggggggggg\r\nhhhhhhhhh\r\niiiiiiiii\r\njjjjjjjjj\r\nxxxxxxxxx\r\nzzzzzzzzz\r\n",
                "999993007"
            ]
        ]
    }
]