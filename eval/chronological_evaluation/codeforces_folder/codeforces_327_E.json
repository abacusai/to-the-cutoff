[
    {
        "name": "Axis Walking",
        "description": "Iahub wants to meet his girlfriend Iahubina. They both live in Ox axis (the\nhorizontal axis). Iahub lives at point 0 and Iahubina at point d. Iahub has n\npositive integers a1, a2, ..., an. The sum of those numbers is d. Suppose p1,\np2, ..., pn is a permutation of 1, 2, ..., n. Then, let b1 = ap1, b2 = ap2\nand so on. The array b is called a \"route\". There are n! different routes, one\nfor each permutation p. Iahub's travel schedule is: he walks b1 steps on Ox\naxis, then he makes a break in point b1. Then, he walks b2 more steps on Ox\naxis and makes a break in point b1 + b2. Similarly, at j-th (1 \u2264 j \u2264 n) time\nhe walks bj more steps on Ox axis and makes a break in point b1 + b2 + ... +\nbj. Iahub is very superstitious and has k integers which give him bad luck. He\ncalls a route \"good\" if he never makes a break in a point corresponding to one\nof those k numbers. For his own curiosity, answer how many good routes he can\nmake, modulo 1000000007 (10^9 + 7). Input The first line contains an integer n\n(1 \u2264 n \u2264 24). The following line contains n integers: a1, a2, ..., an (1 \u2264 ai\n\u2264 10^9). The third line contains integer k (0 \u2264 k \u2264 2). The fourth line\ncontains k positive integers, representing the numbers that give Iahub bad\nluck. Each of these numbers does not exceed 10^9. Output Output a single\ninteger \u2014 the answer of Iahub's dilemma modulo 1000000007 (10^9 + 7). Examples\nInput 3 2 3 5 2 5 7 Output 1 Input 3 2 2 2 2 1 3 Output 6 Note In the first\ncase consider six possible orderings: [2, 3, 5]. Iahub will stop at position\n2, 5 and 10. Among them, 5 is bad luck for him. [2, 5, 3]. Iahub will stop at\nposition 2, 7 and 10. Among them, 7 is bad luck for him. [3, 2, 5]. He will\nstop at the unlucky 5. [3, 5, 2]. This is a valid ordering. [5, 2, 3]. He got\nunlucky twice (5 and 7). [5, 3, 2]. Iahub would reject, as it sends him to\nposition 5. In the second case, note that it is possible that two different\nways have the identical set of stopping. In fact, all six possible ways have\nthe same stops: [2, 4, 6], so there's no bad luck for Iahub.\n\n",
        "cf_contest_id": 327,
        "cf_index": "E",
        "cf_rating": 2300,
        "difficulty": 0,
        "cf_tags": [
            "bitmasks",
            "combinatorics",
            "constructive algorithms",
            "dp",
            "meet-in-the-middle"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "3\r\n2 3 5\r\n2\r\n5 7\r\n",
                "1"
            ],
            [
                "3\r\n2 2 2\r\n2\r\n1 3\r\n",
                "6"
            ]
        ],
        "private_cases": [
            [
                "9\r\n2 5 2 5 1 4 1 4 4\r\n1\r\n8\r\n",
                "267840"
            ],
            [
                "6\r\n1 2 3 5 4 2\r\n2\r\n3 1\r\n",
                "432"
            ],
            [
                "8\r\n2 2 4 5 2 2 1 2\r\n1\r\n10\r\n",
                "27360"
            ],
            [
                "8\r\n1 3 1 5 2 2 2 3\r\n0\r\n",
                "40320"
            ],
            [
                "24\r\n609851762 541970088 699508557 642281480 226745116 4514801 300770784 629632703 631927993 696795951 325943153 220094527 740426290 229291314 124145240 561099183 706879073 768876553 629467905 67126170 543719762 30827848 624151081 609282601\r\n2\r\n572977796 314243139\r\n",
                "657629300"
            ],
            [
                "24\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n2\r\n10 15\r\n",
                "0"
            ],
            [
                "24\r\n812976862 772106469 156863123 724802782 69770812 597374983 883282868 597467277 198555259 981339094 507716124 895498411 860977326 226469008 558683509 611770421 367999400 518913797 427107149 988957659 710184001 382276308 639736660 903413823\r\n2\r\n657295760 422567089\r\n",
                "657629300"
            ],
            [
                "24\r\n821096416 468301767 395320995 328759067 59634917 884742609 66226107 135824603 95105278 910865523 168406620 311586942 783095176 172757262 611153810 131775746 137143633 945567432 170954492 204903235 603850968 504325831 328925964 177647169\r\n2\r\n974007440 51128436\r\n",
                "657629300"
            ],
            [
                "24\r\n544886266 339843650 593540613 719594669 379712480 674186102 256437976 231690343 139766840 940250360 140978835 640432555 22553521 471932164 114468628 959739944 366946085 807484177 989243136 479199340 336209113 661098256 460500233 579361050\r\n2\r\n317463993 403892905\r\n",
                "657629300"
            ],
            [
                "24\r\n1 1 2 2 2 1 2 2 2 2 1 2 2 2 1 2 2 1 1 2 1 2 1 2\r\n2\r\n20 29\r\n",
                "461726027"
            ],
            [
                "24\r\n1 2 1 1 1 2 2 2 2 1 2 1 1 2 2 1 2 2 2 2 2 2 1 2\r\n2\r\n7 30\r\n",
                "755050115"
            ],
            [
                "24\r\n2 1 2 1 1 2 1 2 1 2 1 1 2 1 1 2 2 1 2 1 1 2 1 2\r\n2\r\n24 29\r\n",
                "879792451"
            ],
            [
                "24\r\n2 1 2 2 2 1 1 2 1 1 1 2 1 1 2 2 1 2 2 2 2 1 2 2\r\n2\r\n12 5\r\n",
                "57792300"
            ],
            [
                "24\r\n2 2 1 2 1 1 1 2 1 2 2 1 2 2 1 2 1 1 1 2 1 2 2 2\r\n2\r\n7 22\r\n",
                "571189322"
            ],
            [
                "24\r\n64 303 396 59 228 192 338 340 301 363 180 306 378 331 318 21 133 23 71 72 163 318 399 226\r\n2\r\n584 700\r\n",
                "515124661"
            ],
            [
                "24\r\n225 268 301 361 178 367 134 230 265 342 73 296 84 120 375 124 357 126 324 133 66 386 101 54\r\n2\r\n367 833\r\n",
                "189387886"
            ],
            [
                "24\r\n294 17 330 139 102 226 165 35 127 107 116 305 120 368 267 191 68 174 233 335 174 127 183 368\r\n2\r\n516 548\r\n",
                "217753835"
            ],
            [
                "24\r\n391 3 135 28 143 262 259 76 37 206 63 382 92 376 292 91 323 103 4 229 303 205 140 136\r\n2\r\n826 868\r\n",
                "313676281"
            ],
            [
                "24\r\n29 308 286 258 78 359 277 306 110 372 98 319 127 329 308 205 156 126 292 105 347 70 53 154\r\n2\r\n947 541\r\n",
                "510235240"
            ],
            [
                "24\r\n25613 3313 29145 55613 83781 11456 11500 22710 95632 2093 77523 38888 91536 3344 36052 73495 27771 67722 44107 14226 17831 23239 90737 14354\r\n2\r\n365984 736317\r\n",
                "208696789"
            ],
            [
                "24\r\n82034 91996 89083 70747 97771 3601 53292 91442 22919 66523 31779 91204 82852 17969 53172 44008 6368 31133 70585 12808 32891 10296 51050 77121\r\n2\r\n887703 741393\r\n",
                "705883532"
            ],
            [
                "24\r\n49810 97417 34245 3393 77168 84234 51803 20550 23411 84625 59898 92291 26590 31186 16519 75061 20298 15683 78715 70201 88959 95866 15679 77936\r\n2\r\n571416 177425\r\n",
                "762039965"
            ],
            [
                "24\r\n33938 45941 19951 9286 89270 40675 93419 16954 91198 19080 4370 85539 78169 60756 79866 38818 85173 67529 54141 27594 85572 24540 88148 35648\r\n2\r\n962969 356562\r\n",
                "270821974"
            ],
            [
                "24\r\n34418 35009 89304 90988 92859 54011 59226 13358 91690 53534 65193 86627 46099 73973 43213 94063 99103 52079 29567 84986 41640 93757 52778 36463\r\n2\r\n130330 84754\r\n",
                "657629300"
            ],
            [
                "24\r\n997427172 175827444 974874468 545899507 803937201 197552158 585061918 767830250 17757371 734325659 602057052 992482647 151833409 119371750 253591399 4045321 76500842 157618036 265552661 456960617 327066248 929683697 229641477 626710970\r\n2\r\n633274455 552428680\r\n",
                "657629300"
            ],
            [
                "24\r\n458285588 177005962 128013065 440198534 486031156 822164026 636008198 42802980 557699777 684734710 419529287 305999543 220225550 145124103 613802800 272794495 907521183 38606391 594382198 246793569 962994282 844410130 468385887 822219553\r\n2\r\n994599959 833163048\r\n",
                "657629300"
            ],
            [
                "24\r\n361594948 618375968 135927470 481981209 460832950 297032791 537211374 760226654 537833671 487660113 89517875 621775895 436101339 730684968 971754746 394060022 883765717 212302586 628244439 476818009 451438668 464169267 561906106 165211785\r\n2\r\n355925464 116156872\r\n",
                "657629300"
            ],
            [
                "24\r\n822453364 617295031 994098771 376280236 288151097 626677363 145706709 182683032 517967565 438069165 201957407 935292791 651977129 756437320 331966147 515325549 714786058 93290941 809590328 264391506 232590895 233671508 653166869 360720368\r\n2\r\n422283672 691858536\r\n",
                "657629300"
            ],
            [
                "24\r\n578279076 763697741 854529528 418062910 970245052 251289231 341877181 752623059 203134162 388478216 19429643 543776983 720369270 194514537 984885389 341623779 691030591 119503488 138419865 349191754 868518929 295881589 186878575 848936792\r\n2\r\n636125529 267560200\r\n",
                "657629300"
            ],
            [
                "4\r\n1 5 2 2\r\n2\r\n6 3\r\n",
                "12"
            ],
            [
                "3\r\n4 2 3\r\n2\r\n1 5\r\n",
                "4"
            ],
            [
                "3\r\n5 3 3\r\n1\r\n5\r\n",
                "4"
            ],
            [
                "5\r\n1 1 5 1 2\r\n0\r\n",
                "120"
            ],
            [
                "1\r\n5\r\n2\r\n2 8\r\n",
                "1"
            ],
            [
                "1\r\n1\r\n0\r\n",
                "1"
            ],
            [
                "4\r\n5 2 3 3\r\n1\r\n9\r\n",
                "24"
            ],
            [
                "3\r\n1 1 4\r\n0\r\n",
                "6"
            ],
            [
                "2\r\n3 4\r\n0\r\n",
                "2"
            ],
            [
                "5\r\n3 5 4 5 4\r\n1\r\n9\r\n",
                "72"
            ],
            [
                "24\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n2\r\n13 17\r\n",
                "0"
            ],
            [
                "24\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n2\r\n13 21\r\n",
                "0"
            ],
            [
                "24\r\n10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000 10000000\r\n2\r\n160000000 160000000\r\n",
                "0"
            ],
            [
                "24\r\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24\r\n2\r\n300 300\r\n",
                "0"
            ],
            [
                "24\r\n100000000 200000000 300000000 400000000 500000000 600000000 700000000 800000000 900000000 1000000000 100000000 200000000 300000000 400000000 500000000 600000000 700000000 800000000 900000000 1000000000 100000000 200000000 300000000 400000000\r\n1\r\n100000000\r\n",
                "75425634"
            ],
            [
                "24\r\n100000000 200000000 300000000 400000000 500000000 600000000 700000000 800000000 900000000 1000000000 100000000 200000000 300000000 400000000 500000000 600000000 700000000 800000000 900000000 1000000000 100000000 200000000 300000000 400000000\r\n2\r\n100000000 500000000\r\n",
                "515036048"
            ],
            [
                "24\r\n100000000 200000000 300000000 400000000 500000000 600000000 700000000 800000000 900000000 1000000000 100000000 200000000 300000000 400000000 500000000 600000000 700000000 800000000 900000000 1000000000 100000000 200000000 300000000 400000000\r\n2\r\n1000000000 500000000\r\n",
                "900622535"
            ],
            [
                "24\r\n1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 10 1 2 3 4\r\n1\r\n1\r\n",
                "75425634"
            ],
            [
                "5\r\n1 2 3 4 5\r\n2\r\n1000 1001\r\n",
                "120"
            ]
        ]
    }
]