[
    {
        "name": "Upside Down",
        "description": "As we all know, Eleven has special abilities. Thus, Hopper convinced her to\nclose the gate to the Upside Down World with her mind. Upside down monsters\nlike to move between the worlds, so they are going to attack Hopper and Eleven\nin order to make them stop. The monsters live in the vines. The vines form a\ntree with n vertices, numbered from 1 through n. There's a lowercase English\nletter written in each tunnel (edge). Upside down is a magical world. There\nare m types of monsters in upside down, numbered from 1 through m. Each type\nof monster has a special word that gives them powers. The special word of type\ni is si. There are q monsters in upside down. Each one is at a junction\n(vertex) and is going to some other junction. If monster of type k goes from\njunction i to junction j, the power it gains is the number of times it sees\nits special world (sk) consecutively in the tunnels. More formally: If f(i, j)\nis the string we get when we concatenate the letters written in the tunnels on\nthe shortest path from i to j, then the power the monster gains is the number\nof occurrences of sk in f(i, j). Hopper and Eleven want to get prepared, so\nfor each monster, they want to know the power the monster gains after moving.\nInput The first line of input contains three integers, n, m and q (2 \u2264 n \u2264\n10^5, 1 \u2264 m, q \u2264 10^5). The next n - 1 lines contain the tunnels (edges). Each\nline contains two integers v and u (1 \u2264 v, u \u2264 n, v \u2260 u) and a lowercase\nEnglish letter c, meaning there's a tunnel connecting junctions v and u\nwritten c in it. It is guaranteed that the given graph is a tree. The next m\nlines contain the special words. i-th line of them contains a single string si\n(1 \u2264 |si| \u2264 10^5), consisting of lowercase English letters. It is guaranteed\nthat |s1| + |s2| + ... + |sm| \u2264 10^5). The next q lines contain the monsters.\nEach line contains three integers i, j and k (1 \u2264 i, j \u2264 n, i \u2260 j, 1 \u2264 k \u2264 m),\nmeaning a monster of type k is going from junction number i to junction number\nj. Output Print q lines. i-th line should contain a single integer, the power\nthe i-th monster gains after moving. Examples Input 6 4 5 1 6 b 2 3 a 1 2 b 5\n3 b 4 5 b a b bb aa 1 2 1 6 2 3 1 6 2 4 5 4 1 6 2 Output 0 1 1 0 1 Input 10 6\n7 1 3 s 10 1 d 2 6 s 5 2 d 7 4 l 8 9 d 8 10 l 7 2 d 8 7 l dl dssld d d l sl 4\n5 4 3 7 5 10 6 2 3 1 4 7 5 6 10 9 4 9 8 4 Output 2 2 0 0 0 1 1\n\n",
        "cf_contest_id": 917,
        "cf_index": "E",
        "cf_rating": 3400,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "string suffix structures",
            "strings",
            "trees"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "6 4 5\r\n1 6 b\r\n2 3 a\r\n1 2 b\r\n5 3 b\r\n4 5 b\r\na\r\nb\r\nbb\r\naa\r\n1 2 1\r\n6 2 3\r\n1 6 2\r\n4 5 4\r\n1 6 2\r\n",
                "0\r\n1\r\n1\r\n0\r\n1\r\n"
            ],
            [
                "10 6 7\r\n1 3 s\r\n10 1 d\r\n2 6 s\r\n5 2 d\r\n7 4 l\r\n8 9 d\r\n8 10 l\r\n7 2 d\r\n8 7 l\r\ndl\r\ndssld\r\nd\r\nd\r\nl\r\nsl\r\n4 5 4\r\n3 7 5\r\n10 6 2\r\n3 1 4\r\n7 5 6\r\n10 9 4\r\n9 8 4\r\n",
                "2\r\n2\r\n0\r\n0\r\n0\r\n1\r\n1\r\n"
            ]
        ],
        "private_cases": []
    }
]