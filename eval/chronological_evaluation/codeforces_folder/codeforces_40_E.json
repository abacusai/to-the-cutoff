[
    {
        "name": "Number Table",
        "description": "As it has been found out recently, all the Berland's current economical state\ncan be described using a simple table n \u00d7 m in size. n \u2014 the number of days in\neach Berland month, m \u2014 the number of months. Thus, a table cell corresponds\nto a day and a month of the Berland's year. Each cell will contain either 1,\nor -1, which means the state's gains in a particular month, on a particular\nday. 1 corresponds to profits, -1 corresponds to losses. It turned out\nimportant for successful development to analyze the data on the state of the\neconomy of the previous year, however when the treasurers referred to the\narchives to retrieve the data, it turned out that the table had been\nsubstantially damaged. In some table cells the number values had faded and\nwere impossible to be deciphered. It is known that the number of cells in\nwhich the data had been preserved is strictly less than max(n, m). However,\nthere is additional information \u2014 the product of the numbers in each line and\ncolumn equaled -1. Your task is to find out how many different tables may\nconform to the preserved data. As the answer to the task can be quite large,\nyou have to find it modulo p. Input The first line contains integers n and m\n(1 \u2264 n, m \u2264 1000). The second line contains the integer k (0 \u2264 k < max(n, m))\n\u2014 the number of cells in which the data had been preserved. The next k lines\ncontain the data on the state of the table in the preserved cells. Each line\nis of the form \"a b c\", where a (1 \u2264 a \u2264 n) \u2014 the number of the table row, b\n(1 \u2264 b \u2264 m) \u2014 the number of the column, c \u2014 the value containing in the cell\n(1 or -1). They are numbered starting from 1. It is guaranteed that no two\nlines with same a and b values exist. The last line contains an integer p (2 \u2264\np \u2264 10^9 + 7). Output Print the number of different tables that could conform\nto the preserved data modulo p. Examples Input 2 2 0 100 Output 2 Input 2 2 1\n1 1 -1 100 Output 1\n\n",
        "cf_contest_id": 40,
        "cf_index": "E",
        "cf_rating": 2500,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 216.0,
        "public_cases": [
            [
                "2 2\r\n0\r\n100\r\n",
                "2\r\n"
            ],
            [
                "2 2\r\n1\r\n1 1 -1\r\n100\r\n",
                "1\r\n"
            ]
        ],
        "private_cases": [
            [
                "7 6\r\n4\r\n3 2 -1\r\n7 1 1\r\n2 1 1\r\n3 4 -1\r\n179460773\r\n",
                "0\r\n"
            ],
            [
                "6 2\r\n3\r\n5 1 -1\r\n4 2 1\r\n1 2 -1\r\n958300150\r\n",
                "4\r\n"
            ],
            [
                "6 9\r\n3\r\n4 8 1\r\n2 5 1\r\n5 1 -1\r\n589655884\r\n",
                "0\r\n"
            ],
            [
                "4 5\r\n3\r\n1 3 1\r\n2 2 1\r\n4 2 1\r\n221011618\r\n",
                "0\r\n"
            ],
            [
                "4 4\r\n1\r\n3 3 -1\r\n852367357\r\n",
                "256\r\n"
            ],
            [
                "3 10\r\n6\r\n1 6 -1\r\n1 3 1\r\n1 7 -1\r\n3 2 1\r\n2 1 1\r\n2 10 -1\r\n483723090\r\n",
                "0\r\n"
            ],
            [
                "3 7\r\n0\r\n115078824\r\n",
                "4096\r\n"
            ],
            [
                "6 2\r\n1\r\n3 1 1\r\n865423160\r\n",
                "16\r\n"
            ],
            [
                "5 6\r\n3\r\n5 6 -1\r\n2 5 -1\r\n4 2 -1\r\n353435294\r\n",
                "0\r\n"
            ],
            [
                "4 11\r\n6\r\n3 10 1\r\n2 10 -1\r\n2 6 -1\r\n2 3 -1\r\n4 4 -1\r\n2 2 1\r\n841447432\r\n",
                "0\r\n"
            ],
            [
                "3 7\r\n2\r\n2 2 -1\r\n1 1 1\r\n181975928\r\n",
                "1024\r\n"
            ],
            [
                "11 11\r\n0\r\n669988067\r\n",
                "651673220\r\n"
            ],
            [
                "10 6\r\n3\r\n5 3 -1\r\n10 3 -1\r\n3 4 -1\r\n158000200\r\n",
                "110944104\r\n"
            ],
            [
                "9 10\r\n6\r\n5 8 1\r\n3 8 -1\r\n3 6 1\r\n5 2 -1\r\n6 2 1\r\n3 5 -1\r\n646012339\r\n",
                "0\r\n"
            ],
            [
                "8 6\r\n1\r\n8 6 -1\r\n945867588\r\n",
                "154252600\r\n"
            ],
            [
                "9 9\r\n2\r\n9 4 -1\r\n1 5 1\r\n474552973\r\n",
                "12113895\r\n"
            ],
            [
                "8 5\r\n3\r\n1 1 1\r\n3 2 -1\r\n1 4 1\r\n962565112\r\n",
                "0\r\n"
            ],
            [
                "1 7\r\n6\r\n1 1 -1\r\n1 2 -1\r\n1 3 -1\r\n1 4 -1\r\n1 5 -1\r\n1 6 -1\r\n10\r\n",
                "1\r\n"
            ],
            [
                "1 1\r\n0\r\n2\r\n",
                "1\r\n"
            ],
            [
                "1 1\r\n0\r\n1000000000\r\n",
                "1\r\n"
            ],
            [
                "1000 1000\r\n0\r\n2\r\n",
                "0\r\n"
            ],
            [
                "1000 1000\r\n0\r\n1000000007\r\n",
                "101469445\r\n"
            ],
            [
                "98 96\r\n15\r\n64 87 1\r\n83 68 -1\r\n74 80 1\r\n64 42 1\r\n20 10 -1\r\n31 37 1\r\n36 27 -1\r\n44 55 1\r\n98 10 -1\r\n23 44 -1\r\n77 17 -1\r\n40 20 -1\r\n63 3 1\r\n37 89 1\r\n19 90 -1\r\n962565112\r\n",
                "690616424\r\n"
            ],
            [
                "7 1\r\n6\r\n1 1 -1\r\n2 1 -1\r\n3 1 -1\r\n4 1 -1\r\n5 1 -1\r\n6 1 -1\r\n10\r\n",
                "1\r\n"
            ],
            [
                "7 1\r\n6\r\n1 1 -1\r\n2 1 -1\r\n6 1 -1\r\n4 1 -1\r\n5 1 -1\r\n7 1 -1\r\n10\r\n",
                "1\r\n"
            ],
            [
                "7 1\r\n6\r\n1 1 1\r\n2 1 -1\r\n3 1 1\r\n4 1 -1\r\n5 1 1\r\n6 1 -1\r\n10\r\n",
                "0\r\n"
            ],
            [
                "1 7\r\n6\r\n1 1 1\r\n1 2 -1\r\n1 3 1\r\n1 6 -1\r\n1 5 1\r\n1 7 -1\r\n10\r\n",
                "0\r\n"
            ],
            [
                "4 4\r\n3\r\n1 1 -1\r\n2 2 1\r\n3 3 -1\r\n1000000000\r\n",
                "64\r\n"
            ],
            [
                "500 1000\r\n0\r\n1000000007\r\n",
                "82701167\r\n"
            ],
            [
                "6 2\r\n3\r\n5 1 -1\r\n4 2 1\r\n1 2 -1\r\n958300155\r\n",
                "4\r\n"
            ],
            [
                "15 5\r\n13\r\n10 3 -1\r\n13 1 1\r\n8 5 -1\r\n5 1 1\r\n14 1 1\r\n10 5 1\r\n13 4 -1\r\n8 3 1\r\n14 2 1\r\n11 5 -1\r\n12 5 -1\r\n7 2 -1\r\n8 4 -1\r\n1000000007\r\n",
                "92960636\r\n"
            ],
            [
                "15 5\r\n12\r\n3 3 -1\r\n2 1 1\r\n6 2 1\r\n9 2 1\r\n5 4 -1\r\n8 5 1\r\n2 3 1\r\n14 5 1\r\n12 2 -1\r\n7 4 -1\r\n11 1 -1\r\n14 4 1\r\n1000000007\r\n",
                "185921272\r\n"
            ],
            [
                "5 3\r\n4\r\n1 1 -1\r\n1 2 1\r\n1 3 -1\r\n2 1 1\r\n1000000007\r\n",
                "0\r\n"
            ],
            [
                "3 5\r\n4\r\n1 1 -1\r\n2 1 1\r\n3 1 -1\r\n1 2 1\r\n1000000007\r\n",
                "0\r\n"
            ],
            [
                "1000 1\r\n0\r\n1000000007\r\n",
                "0\r\n"
            ],
            [
                "1000 2\r\n0\r\n1000000007\r\n",
                "344211605\r\n"
            ],
            [
                "2 1000\r\n0\r\n1000000007\r\n",
                "344211605\r\n"
            ],
            [
                "999 1\r\n0\r\n1000000007\r\n",
                "1\r\n"
            ],
            [
                "1 999\r\n0\r\n1000000007\r\n",
                "1\r\n"
            ],
            [
                "6 2\r\n5\r\n2 1 1\r\n5 2 1\r\n6 1 1\r\n5 1 1\r\n1 1 1\r\n1000000007\r\n",
                "0\r\n"
            ],
            [
                "999 1000\r\n0\r\n1000000007\r\n",
                "0\r\n"
            ],
            [
                "500 1000\r\n0\r\n1000000007\r\n",
                "82701167\r\n"
            ],
            [
                "1000 999\r\n0\r\n1000000007\r\n",
                "0\r\n"
            ],
            [
                "1000 500\r\n0\r\n1000000007\r\n",
                "82701167\r\n"
            ],
            [
                "1 7\r\n6\r\n1 1 -1\r\n1 2 1\r\n1 3 -1\r\n1 5 -1\r\n1 6 -1\r\n1 7 -1\r\n1000\r\n",
                "0\r\n"
            ],
            [
                "7 7\r\n6\r\n1 1 -1\r\n2 2 -1\r\n3 3 -1\r\n4 4 -1\r\n5 5 -1\r\n6 6 -1\r\n1000000007\r\n",
                "73741817\r\n"
            ],
            [
                "7 7\r\n6\r\n1 7 -1\r\n2 6 -1\r\n3 5 -1\r\n4 4 -1\r\n5 3 -1\r\n6 2 -1\r\n1000000007\r\n",
                "73741817\r\n"
            ],
            [
                "7 7\r\n6\r\n1 7 -1\r\n2 6 -1\r\n3 5 -1\r\n4 4 -1\r\n5 3 -1\r\n7 2 1\r\n1000000007\r\n",
                "73741817\r\n"
            ],
            [
                "7 7\r\n6\r\n1 7 -1\r\n2 6 -1\r\n3 5 -1\r\n4 4 -1\r\n5 3 -1\r\n6 2 -1\r\n1000000007\r\n",
                "73741817\r\n"
            ],
            [
                "2 4\r\n2\r\n1 1 1\r\n2 1 -1\r\n100\r\n",
                "4\r\n"
            ],
            [
                "1 5\r\n1\r\n1 5 1\r\n100\r\n",
                "0\r\n"
            ],
            [
                "3 1\r\n1\r\n1 1 -1\r\n100\r\n",
                "1\r\n"
            ],
            [
                "2 3\r\n2\r\n1 1 1\r\n2 1 1\r\n1000\r\n",
                "0\r\n"
            ]
        ]
    }
]