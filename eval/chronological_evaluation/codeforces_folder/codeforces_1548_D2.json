[
    {
        "name": "Gregor and the Odd Cows (Hard)",
        "description": "This is the hard version of the problem. The only difference from the easy\nversion is that in this version the coordinates can be both odd and even.\nThere are \n    n\n fence-posts at distinct coordinates on a plane. It is\nguaranteed that no three fence posts lie on the same line. There are an\ninfinite number of cows on the plane, one at every point with integer\ncoordinates. Gregor is a member of the Illuminati, and wants to build a\ntriangular fence, connecting \n    3\n distinct existing fence posts. A cow\nstrictly inside the fence is said to be enclosed. If there are an odd number\nof enclosed cows and the area of the fence is an integer, the fence is said to\nbe interesting. Find the number of interesting fences. Input The first line\ncontains the integer \n    n\n (\n    3 \n    \u2264 n \n    \u2264 6000\n), the number of fence\nposts which Gregor can choose to form the vertices of a fence. Each of the\nnext \n    n\n line contains two integers \n    x\n and \n    y\n (\n    0 \n    \u2264 x,y\n    \n    \u2264 10^7\n, where \n    (x,y)\n is the coordinate of a fence post. All fence\nposts lie at distinct coordinates. No three fence posts are on the same line.\nOutput Print a single integer, the number of interesting fences. Two fences\nare considered different if they are constructed with a different set of three\nfence posts. Examples Input 3 0 0 2 0 0 4 Output 1 Input 4 1 8 0 6 5 2 5 6\nOutput 1 Input 10 170 59 129 54 5 98 129 37 58 193 154 58 24 3 13 138 136 144\n174 150 Output 29 Note In the first example, there is only \n    1\n fence. That\nfence is interesting since its area is \n    4\n and there is \n    1\n enclosed\ncow, marked in red. In the second example, there are \n    4\n possible fences.\nOnly one of them is interesting however. That fence has an area of \n    8\n and\n\n    5\n enclosed cows.\n\n",
        "cf_contest_id": 1548,
        "cf_index": "D2",
        "cf_rating": 3300,
        "difficulty": 0,
        "cf_tags": [
            "brute force",
            "geometry",
            "math",
            "number theory"
        ],
        "time_limit_seconds": 6.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3\r\n0 0\r\n2 0\r\n0 4\r\n",
                "1\r\n"
            ],
            [
                "4\r\n1 8\r\n0 6\r\n5 2\r\n5 6\r\n",
                "1\r\n"
            ],
            [
                "10\r\n170 59\r\n129 54\r\n5 98\r\n129 37\r\n58 193\r\n154 58\r\n24 3\r\n13 138\r\n136 144\r\n174 150\r\n",
                "29\r\n"
            ]
        ],
        "private_cases": []
    }
]