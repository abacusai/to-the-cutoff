[
    {
        "name": "Sum Over Subsets",
        "description": "You are given a multiset \n    S\n. Over all pairs of subsets \n    A\n and\n\n    B\n, such that: \n    B \n    \u2282 A\n; \n    |B| = |A| - 1\n; greatest common\ndivisor of all elements in \n    A\n is equal to one; find the sum of\n\n    \u2211_x \n    \u2208 Ax\n    \u00b7\n    \u2211_x \n    \u2208 Bx\n, modulo\n\n    998\n     244\n     353\n. Input The first line contains one integer \n    m\n\n(\n    1 \n    \u2264 m \n    \u2264 10^5\n): the number of different values in the multiset\n\n    S\n. Each of the next \n    m\n lines contains two integers \n    a_i\n,\n\n    freq_i\n (\n    1 \n    \u2264 a_i \n    \u2264 10^5, 1 \n    \u2264 freq_i \n    \u2264 10^9\n).\nElement \n    a_i\n appears in the multiset \n    S\n \n    freq_i\n times. All\n\n    a_i\n are different. Output Print the required sum, modulo\n\n    998\n     244\n     353\n. Examples Input 2 1 1 2 1 Output 9 Input 4 1 1 2 1 3 1\n6 1 Output 1207 Input 1 1 5 Output 560 Note A multiset is a set where elements\nare allowed to coincide. \n    |X|\n is the cardinality of a set \n    X\n, the\nnumber of elements in it. \n    A \n    \u2282 B\n: Set \n    A\n is a subset of a\nset \n    B\n. In the first example \n    B=\n    \n    1\n    \n    , A=\n    \n    1,2\n and\n\n    B=\n    \n    2\n    \n    , A=\n    \n    1, 2\n have a product equal to \n    1\n    \u00b73 +\n    2\n    \u00b73=9\n. Other pairs of \n    A\n and \n    B\n don't satisfy the given\nconstraints.\n\n",
        "cf_contest_id": 1436,
        "cf_index": "F",
        "cf_rating": 2800,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "math",
            "number theory"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2\r\n1 1\r\n2 1\r\n",
                "9"
            ],
            [
                "4\r\n1 1\r\n2 1\r\n3 1\r\n6 1\r\n",
                "1207"
            ],
            [
                "1\r\n1 5\r\n",
                "560"
            ]
        ],
        "private_cases": [
            [
                "1\r\n11559 5\r\n",
                "0"
            ],
            [
                "1\r\n21662 10\r\n",
                "0"
            ],
            [
                "1\r\n92269 20\r\n",
                "0"
            ],
            [
                "5\r\n49360 1\r\n35256 1\r\n66972 1\r\n76614 1\r\n23793 1\r\n",
                "132018820"
            ],
            [
                "5\r\n28130 3\r\n84345 2\r\n83725 1\r\n51549 3\r\n63349 1\r\n",
                "117945351"
            ],
            [
                "5\r\n89890 2\r\n72865 6\r\n60734 3\r\n86101 7\r\n69842 2\r\n",
                "398720734"
            ],
            [
                "10\r\n28443 1\r\n36758 1\r\n29768 1\r\n26596 1\r\n78831 1\r\n59928 1\r\n63482 1\r\n7022 1\r\n3841 1\r\n55905 1\r\n",
                "406255794"
            ],
            [
                "10\r\n30344 1\r\n99666 1\r\n86370 2\r\n81244 2\r\n25803 1\r\n86160 2\r\n55944 4\r\n95226 2\r\n18699 1\r\n42366 4\r\n",
                "539462082"
            ],
            [
                "20\r\n92462 1\r\n50214 1\r\n6578 1\r\n36367 1\r\n22724 1\r\n2879 1\r\n60939 1\r\n54598 1\r\n21922 1\r\n81132 1\r\n83168 1\r\n15774 1\r\n69142 1\r\n30615 1\r\n40143 1\r\n38583 1\r\n92277 1\r\n47111 1\r\n75816 1\r\n82274 1\r\n",
                "55349260"
            ],
            [
                "1\r\n54560 5\r\n",
                "0"
            ],
            [
                "1\r\n19879 10\r\n",
                "0"
            ],
            [
                "1\r\n96910 20\r\n",
                "0"
            ],
            [
                "1\r\n959 30\r\n",
                "0"
            ],
            [
                "1\r\n48386 100\r\n",
                "0"
            ],
            [
                "1\r\n43821 20000\r\n",
                "0"
            ],
            [
                "1\r\n9626 100000\r\n",
                "0"
            ],
            [
                "5\r\n22287 1\r\n79293 1\r\n44342 1\r\n93648 1\r\n31886 1\r\n",
                "569218728"
            ],
            [
                "5\r\n94914 3\r\n22229 3\r\n64733 1\r\n60047 1\r\n93650 2\r\n",
                "23992911"
            ],
            [
                "5\r\n2292 2\r\n94073 4\r\n42543 4\r\n53398 4\r\n61640 6\r\n",
                "701433558"
            ],
            [
                "5\r\n69448 2\r\n59299 10\r\n76568 5\r\n38779 6\r\n21930 7\r\n",
                "81414101"
            ],
            [
                "5\r\n99173 17\r\n79067 24\r\n65478 19\r\n50020 16\r\n38416 24\r\n",
                "447640877"
            ],
            [
                "5\r\n39009 3998\r\n74790 3996\r\n38112 3980\r\n8231 4048\r\n1174 3978\r\n",
                "19341396"
            ],
            [
                "5\r\n40479 19970\r\n72987 20185\r\n99904 20058\r\n80029 19957\r\n13045 19830\r\n",
                "123998494"
            ],
            [
                "10\r\n63046 1\r\n73854 1\r\n75386 1\r\n71864 1\r\n28412 1\r\n26097 1\r\n19379 1\r\n15363 1\r\n90096 1\r\n22048 1\r\n",
                "64983739"
            ],
            [
                "10\r\n92266 4\r\n82584 3\r\n37093 1\r\n55849 1\r\n72600 3\r\n58657 2\r\n14206 1\r\n31556 1\r\n60682 2\r\n56722 2\r\n",
                "156070037"
            ],
            [
                "10\r\n70722 3\r\n4081 6\r\n6109 1\r\n13795 3\r\n42409 3\r\n12941 3\r\n39265 3\r\n20462 1\r\n25537 3\r\n30096 4\r\n",
                "515566357"
            ],
            [
                "10\r\n82453 8\r\n43312 10\r\n57885 9\r\n16967 11\r\n83794 13\r\n20422 15\r\n85527 7\r\n13341 9\r\n15764 10\r\n99662 8\r\n",
                "79747753"
            ],
            [
                "10\r\n43641 2046\r\n969 2022\r\n73449 1923\r\n57811 1986\r\n82664 1952\r\n98884 1953\r\n30836 1994\r\n37522 2092\r\n56990 2014\r\n57702 2018\r\n",
                "399908185"
            ],
            [
                "10\r\n30000 10093\r\n95065 9953\r\n55513 9980\r\n19762 9910\r\n21056 10035\r\n23414 9967\r\n17341 10066\r\n71119 10083\r\n41445 9880\r\n6085 10033\r\n",
                "965868279"
            ],
            [
                "20\r\n77048 1\r\n35951 1\r\n84200 1\r\n85813 1\r\n48514 1\r\n41042 1\r\n98965 1\r\n59553 1\r\n51695 1\r\n22919 1\r\n4858 1\r\n88826 1\r\n73400 1\r\n4909 1\r\n57202 1\r\n20339 1\r\n10521 1\r\n96447 1\r\n21197 1\r\n30356 1\r\n",
                "751802079"
            ],
            [
                "20\r\n35140 2\r\n676 1\r\n19917 2\r\n84658 2\r\n39567 1\r\n78855 2\r\n72389 3\r\n57992 2\r\n9312 2\r\n598 2\r\n40094 1\r\n48600 1\r\n12436 1\r\n3629 2\r\n79408 1\r\n55037 1\r\n9991 1\r\n50628 1\r\n47434 1\r\n68021 1\r\n",
                "157576286"
            ],
            [
                "20\r\n42096 3\r\n37303 7\r\n60618 4\r\n12022 4\r\n19798 4\r\n28074 5\r\n90378 4\r\n68308 5\r\n63494 6\r\n69445 6\r\n20711 4\r\n76986 5\r\n80024 4\r\n52891 5\r\n13724 3\r\n43992 8\r\n5799 4\r\n6789 6\r\n64195 6\r\n45252 7\r\n",
                "257873022"
            ],
            [
                "20\r\n69998 1008\r\n6963 1017\r\n93838 1049\r\n41127 988\r\n47104 955\r\n26137 1013\r\n69263 995\r\n72124 927\r\n50954 986\r\n77373 1014\r\n67507 1011\r\n64956 944\r\n74359 1009\r\n40489 1031\r\n37862 1048\r\n38632 969\r\n72165 976\r\n8093 1019\r\n51187 1025\r\n60095 1016\r\n",
                "954475308"
            ],
            [
                "20\r\n6418 4832\r\n94011 5002\r\n97036 5058\r\n11714 5020\r\n92535 5167\r\n55367 4977\r\n3955 4998\r\n57461 4906\r\n54008 5017\r\n24832 5122\r\n17076 4868\r\n12000 4999\r\n78239 5020\r\n77209 5064\r\n68990 4977\r\n67324 5083\r\n27834 5012\r\n69840 5040\r\n99768 4971\r\n79952 4867\r\n",
                "489497406"
            ],
            [
                "30\r\n56333 1\r\n59549 1\r\n78993 1\r\n53220 1\r\n5036 1\r\n96777 1\r\n3544 1\r\n14847 1\r\n72289 1\r\n19080 1\r\n61336 1\r\n5411 1\r\n61932 1\r\n83208 1\r\n39183 1\r\n42131 1\r\n35832 1\r\n8214 1\r\n3632 1\r\n38643 1\r\n97700 1\r\n31457 1\r\n56531 1\r\n51750 1\r\n94670 1\r\n2762 1\r\n91793 1\r\n63745 1\r\n29617 1\r\n70498 1\r\n",
                "744691098"
            ],
            [
                "30\r\n37584 3\r\n972 2\r\n82609 1\r\n30660 4\r\n79703 6\r\n17343 5\r\n58270 6\r\n39235 4\r\n17783 5\r\n51785 4\r\n97152 4\r\n48041 2\r\n356 4\r\n82001 6\r\n21474 3\r\n22700 2\r\n56832 3\r\n44691 3\r\n46058 1\r\n50266 1\r\n47728 3\r\n56919 2\r\n68904 2\r\n52623 2\r\n67791 3\r\n71931 3\r\n35348 4\r\n25586 7\r\n87796 3\r\n57369 2\r\n",
                "231918169"
            ],
            [
                "30\r\n99300 648\r\n52484 673\r\n51670 673\r\n97227 683\r\n62931 683\r\n59303 679\r\n30822 679\r\n7473 646\r\n77942 651\r\n38423 662\r\n30361 660\r\n55707 675\r\n87966 654\r\n55025 678\r\n89699 627\r\n53264 642\r\n88769 649\r\n92054 647\r\n48738 638\r\n47469 695\r\n92441 691\r\n3095 714\r\n53549 649\r\n63917 707\r\n37380 660\r\n56084 670\r\n90677 697\r\n57137 676\r\n20345 655\r\n56121 639\r\n",
                "295634974"
            ],
            [
                "30\r\n38596 3439\r\n69882 3358\r\n26491 3277\r\n92066 3311\r\n54505 3332\r\n72838 3384\r\n68769 3325\r\n60945 3362\r\n11659 3447\r\n73742 3373\r\n51560 3363\r\n36286 3264\r\n63973 3315\r\n31533 3261\r\n89087 3401\r\n55867 3353\r\n31713 3326\r\n86678 3291\r\n30050 3236\r\n71541 3347\r\n42819 3452\r\n7194 3362\r\n26385 3231\r\n43133 3343\r\n29440 3299\r\n82161 3298\r\n4059 3339\r\n83806 3313\r\n89508 3276\r\n11260 3322\r\n",
                "262062112"
            ],
            [
                "1\r\n54467 903593435\r\n",
                "0"
            ],
            [
                "5\r\n82827 897347884\r\n89429 493061397\r\n38980 320021710\r\n16498 356280663\r\n47250 728324420\r\n",
                "903200126"
            ],
            [
                "10\r\n85315 577176157\r\n3091 64040175\r\n49821 53514239\r\n44016 843611186\r\n67368 777844175\r\n84158 92766154\r\n16460 695829846\r\n50883 789245776\r\n70715 618721800\r\n35424 509334827\r\n",
                "796951555"
            ],
            [
                "20\r\n23630 101848054\r\n63778 42621572\r\n54302 435807896\r\n19688 790969860\r\n52625 411487090\r\n72618 541136271\r\n65226 784525457\r\n18840 40088548\r\n47897 624988420\r\n37132 866500039\r\n5552 712373678\r\n37200 906844401\r\n57708 159477597\r\n14803 46778951\r\n29925 888546843\r\n43048 747594063\r\n85949 317497796\r\n32499 828996831\r\n62919 621063640\r\n60290 79307030\r\n",
                "441326250"
            ],
            [
                "30\r\n50791 243945320\r\n48702 457583014\r\n41675 229737141\r\n51903 823204069\r\n62672 982333456\r\n13022 6181002\r\n21220 952812271\r\n49208 751131975\r\n73341 457778516\r\n17236 855209229\r\n34474 293240200\r\n4702 655177190\r\n39507 367063302\r\n94513 894252033\r\n62219 507962042\r\n88877 952246542\r\n74469 527469163\r\n54023 724142796\r\n96700 75943284\r\n13420 277201631\r\n20560 850751162\r\n58950 98255846\r\n30400 680347097\r\n13439 49002957\r\n76021 731122080\r\n19993 48566111\r\n19854 573549503\r\n21955 96326430\r\n4425 591320510\r\n75080 185572182\r\n",
                "913141755"
            ],
            [
                "2\r\n1 998244352\r\n2 1\r\n",
                "499122175"
            ]
        ]
    }
]