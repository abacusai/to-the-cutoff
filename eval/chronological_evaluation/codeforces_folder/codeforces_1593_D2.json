[
    {
        "name": "Half of Same",
        "description": "This problem is a complicated version of D1, but it has significant\ndifferences, so read the whole statement. Polycarp has an array of \n    n\n\n(\n    n\n is even) integers \n    a_1, a_2, \n    \u2026, a_n\n. Polycarp conceived of\na positive integer \n    k\n. After that, Polycarp began performing the\nfollowing operations on the array: take an index \n    i\n (\n    1 \n    \u2264 i \n    \u2264\n    n\n) and reduce the number \n    a_i\n by \n    k\n. After Polycarp performed\nsome (possibly zero) number of such operations, it turned out that at least\nhalf of the numbers in the array became the same. Find the maximum \n    k\n at\nwhich such a situation is possible, or print \n    -1\n if such a number can be\narbitrarily large. Input The first line contains one integer \n    t\n (\n    1\n    \n    \u2264 t \n    \u2264 10\n) \u2014 the number of test cases. Then \n    t\n test cases\nfollow. Each test case consists of two lines. The first line contains an even\ninteger \n    n\n (\n    4 \n    \u2264 n \n    \u2264 40\n) (\n    n\n is even). The second line\ncontains \n    n\n integers \n    a_1, a_2, \n    \u2026 a_n\n (\n    -10^6 \n    \u2264 a_i\n    \n    \u2264 10^6\n). It is guaranteed that the sum of all \n    n\n specified in the\ngiven test cases does not exceed \n    100\n. Output For each test case output\non a separate line an integer \n    k\n (\n    k \n    \u2265 1\n) \u2014 the maximum possible\nnumber that Polycarp used in operations on the array, or \n    -1\n, if such a\nnumber can be arbitrarily large. Example Input 4 6 48 13 22 -15 16 35 8 -1 0 1\n-1 0 1 -1 0 4 100 -1000 -1000 -1000 4 1 1 1 1 Output 13 2 -1 -1\n\n",
        "cf_contest_id": 1593,
        "cf_index": "D2",
        "cf_rating": 1900,
        "difficulty": 0,
        "cf_tags": [
            "brute force",
            "math",
            "number theory"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "4\r\n6\r\n48 13 22 -15 16 35\r\n8\r\n-1 0 1 -1 0 1 -1 0\r\n4\r\n100 -1000 -1000 -1000\r\n4\r\n1 1 1 1\r\n",
                "13\r\n2\r\n-1\r\n-1\r\n"
            ]
        ],
        "private_cases": [
            [
                "10\r\n10\r\n-30 45 -37 -11 25 61 97 7 7 35\r\n10\r\n48 -2 13 88 97 -27 40 88 41 -67\r\n10\r\n-13 -31 94 -43 19 95 -35 5 41 10\r\n10\r\n-28 -88 17 17 2 -43 -73 -73 -13 2\r\n10\r\n46 -73 47 54 -13 67 7 -33 1 -33\r\n10\r\n60 92 -100 -76 -12 -52 4 84 -38 36\r\n10\r\n50 62 56 -58 -10 87 29 52 14 -22\r\n10\r\n-78 50 -52 -28 -6 -28 17 51 40 -30\r\n10\r\n4 -80 39 -100 -9 -5 32 100 -73 59\r\n10\r\n70 68 4 8 -99 91 26 43 99 -82\r\n",
                "18\r\n5\r\n18\r\n45\r\n40\r\n16\r\n12\r\n3\r\n7\r\n2\r\n"
            ],
            [
                "1\r\n4\r\n-1000000 0 500000 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n4\r\n-900000 900000 -1000000 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n8\r\n-1000000 -1000000 -1000000 0 0 1000000 1000000 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n6\r\n300001 300001 600001 600001 1000000 1000000\r\n",
                "699999\r\n"
            ],
            [
                "1\r\n40\r\n-1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 -1000000 100 100 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n6\r\n-900000 -900000 900000 900000 69 696\r\n",
                "1800000\r\n"
            ],
            [
                "1\r\n6\r\n-900000 -900000 69 696 900000 900000\r\n",
                "1800000\r\n"
            ],
            [
                "1\r\n4\r\n-1000000 1 500000 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n6\r\n900000 900000 -900000 -900000 69 696\r\n",
                "1800000\r\n"
            ],
            [
                "1\r\n4\r\n-1000000 1000000 1 2\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n4\r\n-1000000 1000000 2 3\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n38\r\n0 1 2 99 4 99 99 7 99 99 99 11 12 99 99 15 16 99 18 19 99 99 22 99 99 25 99 99 28 99 30 31 32 99 34 35 99 99\r\n",
                "-1\r\n"
            ],
            [
                "1\r\n8\r\n0 0 0 1 1 1 2 2\r\n",
                "2\r\n"
            ],
            [
                "1\r\n4\r\n0 -1000000 1000000 500000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n4\r\n1000000 -1000000 1 2\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n4\r\n2 3 -1000000 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n4\r\n652522 593505 -709913 -925497\r\n",
                "1578019\r\n"
            ],
            [
                "1\r\n4\r\n-720720 720720 360360 -360360\r\n",
                "1441440\r\n"
            ],
            [
                "1\r\n30\r\n-486721 -365128 688615 -151904 66032 466445 -693382 64923 16806 607621 -553137 98820 513439 707093 -932072 -993848 -638397 -365199 511914 -486308 485420 -384431 604381 -440249 837838 -501326 -778356 -104872 -705697 199328\r\n",
                "2\r\n"
            ],
            [
                "1\r\n8\r\n384153 -797384 514332 522620 349732 590269 2678 136020\r\n",
                "8\r\n"
            ],
            [
                "1\r\n10\r\n615699 -58157 371773 123321 638189 -762591 804703 -635219 -571838 86055\r\n",
                "4\r\n"
            ],
            [
                "2\r\n4\r\n1 1 1 1\r\n4\r\n1 3 5 7\r\n",
                "-1\r\n6\r\n"
            ],
            [
                "1\r\n6\r\n0 2 3 7 14 64\r\n",
                "7\r\n"
            ],
            [
                "1\r\n4\r\n-1000000 1 2 1000000\r\n",
                "2000000\r\n"
            ],
            [
                "1\r\n10\r\n-1000000 26962 24464 5705 28145 23281 16827 9961 491 1000000\r\n",
                "3\r\n"
            ]
        ]
    }
]