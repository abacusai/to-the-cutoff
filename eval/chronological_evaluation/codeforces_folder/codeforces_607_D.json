[
    {
        "name": "Power Tree",
        "description": "Genos and Saitama went shopping for Christmas trees. However, a different type\nof tree caught their attention, the exalted Power Tree. A Power Tree starts\nout as a single root vertex indexed 1. A Power Tree grows through a magical\nphenomenon known as an update. In an update, a single vertex is added to the\ntree as a child of some other vertex. Every vertex in the tree (the root and\nall the added vertices) has some value vi associated with it. The power of a\nvertex is defined as the strength of the multiset composed of the value\nassociated with this vertex (vi) and the powers of its direct children. The\nstrength of a multiset is defined as the sum of all elements in the multiset\nmultiplied by the number of elements in it. Or in other words for some\nmultiset S: Saitama knows the updates that will be performed on the tree, so\nhe decided to test Genos by asking him queries about the tree during its\ngrowth cycle. An update is of the form 1 p v, and adds a new vertex with value\nv as a child of vertex p. A query is of the form 2 u, and asks for the power\nof vertex u. Please help Genos respond to these queries modulo 10^9 + 7. Input\nThe first line of the input contains two space separated integers v1 and q (1\n\u2264 v1 < 10^9, 1 \u2264 q \u2264 200 000) \u2014 the value of vertex 1 and the total number of\nupdates and queries respectively. The next q lines contain the updates and\nqueries. Each of them has one of the following forms: 1 pi vi, if these line\ndescribes an update. The index of the added vertex is equal to the smallest\npositive integer not yet used as an index in the tree. It is guaranteed that\npi is some already existing vertex and 1 \u2264 vi < 10^9. 2 ui, if these line\ndescribes a query. It is guaranteed ui will exist in the tree. It is\nguaranteed that the input will contain at least one query. Output For each\nquery, print out the power of the given vertex modulo 10^9 + 7. Examples Input\n2 5 1 1 3 1 2 5 1 3 7 1 4 11 2 1 Output 344 Input 5 5 1 1 4 1 2 3 2 2 1 2 7 2\n1 Output 14 94 Note For the first sample case, after all the updates the graph\nwill have vertices labelled in the following manner: 1 \u2014 2 \u2014 3 \u2014 4 \u2014 5 These\nvertices will have corresponding values: 2 \u2014 3 \u2014 5 \u2014 7 \u2014 11 And corresponding\npowers: 344 \u2014 170 \u2014 82 \u2014 36 \u2014 11\n\n",
        "cf_contest_id": 607,
        "cf_index": "D",
        "cf_rating": 2600,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "trees"
        ],
        "time_limit_seconds": 3.5,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2 5\r\n1 1 3\r\n1 2 5\r\n1 3 7\r\n1 4 11\r\n2 1\r\n",
                "344\r\n"
            ],
            [
                "5 5\r\n1 1 4\r\n1 2 3\r\n2 2\r\n1 2 7\r\n2 1\r\n",
                "14\r\n94\r\n"
            ]
        ],
        "private_cases": [
            [
                "999999999 2\r\n2 1\r\n2 1\r\n",
                "999999999\r\n999999999\r\n"
            ]
        ]
    }
]