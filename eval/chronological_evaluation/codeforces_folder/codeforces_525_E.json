[
    {
        "name": "Anya and Cubes",
        "description": "Anya loves to fold and stick. Today she decided to do just that. Anya has n\ncubes lying in a line and numbered from 1 to n from left to right, with\nnatural numbers written on them. She also has k stickers with exclamation\nmarks. We know that the number of stickers does not exceed the number of\ncubes. Anya can stick an exclamation mark on the cube and get the factorial of\nthe number written on the cube. For example, if a cube reads 5, then after the\nsticking it reads 5!, which equals 120. You need to help Anya count how many\nways there are to choose some of the cubes and stick on some of the chosen\ncubes at most k exclamation marks so that the sum of the numbers written on\nthe chosen cubes after the sticking becomes equal to S. Anya can stick at most\none exclamation mark on each cube. Can you do it? Two ways are considered the\nsame if they have the same set of chosen cubes and the same set of cubes with\nexclamation marks. Input The first line of the input contains three space-\nseparated integers n, k and S (1 \u2264 n \u2264 25, 0 \u2264 k \u2264 n, 1 \u2264 S \u2264 10^16) \u2014 the\nnumber of cubes and the number of stickers that Anya has, and the sum that she\nneeds to get. The second line contains n positive integers ai (1 \u2264 ai \u2264 10^9)\n\u2014 the numbers, written on the cubes. The cubes in the input are described in\nthe order from left to right, starting from the first one. Multiple cubes can\ncontain the same numbers. Output Output the number of ways to choose some\nnumber of cubes and stick exclamation marks on some of them so that the sum of\nthe numbers became equal to the given number S. Examples Input 2 2 30 4 3\nOutput 1 Input 2 2 7 4 3 Output 1 Input 3 1 1 1 1 1 Output 6 Note In the first\nsample the only way is to choose both cubes and stick an exclamation mark on\neach of them. In the second sample the only way is to choose both cubes but\ndon't stick an exclamation mark on any of them. In the third sample it is\npossible to choose any of the cubes in three ways, and also we may choose to\nstick or not to stick the exclamation mark on it. So, the total number of ways\nis six.\n\n",
        "cf_contest_id": 525,
        "cf_index": "E",
        "cf_rating": 2100,
        "difficulty": 0,
        "cf_tags": [
            "binary search",
            "bitmasks",
            "brute force",
            "dp",
            "math",
            "meet-in-the-middle"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2 2 30\r\n4 3\r\n",
                "1"
            ],
            [
                "2 2 7\r\n4 3\r\n",
                "1"
            ],
            [
                "3 1 1\r\n1 1 1\r\n",
                "6"
            ]
        ],
        "private_cases": [
            [
                "25 25 25\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n",
                "33554432"
            ],
            [
                "13 1 60\r\n3 6 3 4 3 5 1 4 4 4 3 4 3\r\n",
                "155"
            ],
            [
                "10 10 1002\r\n5 6 5 3 4 3 3 2 6 4\r\n",
                "124"
            ],
            [
                "7 6 14\r\n1 3 2 4 1 1 6\r\n",
                "84"
            ],
            [
                "8 7 169\r\n4 3 4 3 5 5 2 5\r\n",
                "24"
            ],
            [
                "1 0 384338286\r\n384338286\r\n",
                "1"
            ],
            [
                "10 6 14\r\n1 1 1 2 2 2 1 1 2 1\r\n",
                "848"
            ],
            [
                "10 8 35\r\n3 3 2 3 1 1 3 3 2 2\r\n",
                "203"
            ],
            [
                "5 3 364332\r\n8 6 4 6 9\r\n",
                "1"
            ],
            [
                "4 2 6227020842\r\n17 15 13 10\r\n",
                "1"
            ],
            [
                "25 15 38\r\n2 1 2 1 1 2 1 2 1 2 1 1 2 2 2 2 2 1 1 1 2 1 2 1 2\r\n",
                "29703676"
            ],
            [
                "25 1 25\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n",
                "26"
            ],
            [
                "23 22 2557\r\n109 117 119 123 117 122 106 100 108 105 119 105 108 120 113 101 115 101 114 123 101 100 111\r\n",
                "1"
            ],
            [
                "25 21 7825123418112377\r\n19 20 17 20 18 19 17 20 19 18 18 20 17 20 18 17 20 19 19 20 17 17 18 17 19\r\n",
                "175"
            ],
            [
                "25 9 137\r\n4 3 1 4 1 2 2 1 1 1 4 4 3 4 4 3 2 1 3 2 4 2 4 1 4\r\n",
                "2310192318"
            ],
            [
                "17 17 2925\r\n5 6 6 5 5 5 5 6 5 5 6 6 6 5 5 6 6\r\n",
                "4774"
            ],
            [
                "25 16 13326087796\r\n157576937 627434432 942652043 706432863 631136945 714549755 465703470 663358517 695561723 249240606 833566455 396564536 758483017 253748999 978210764 530023233 193812243 317718202 184788435 892848108 150420430 330992298 780787784 196460118 674015883\r\n",
                "1"
            ],
            [
                "25 19 6402373705728432\r\n18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18\r\n",
                "25"
            ],
            [
                "25 20 7469435990016370\r\n18 17 18 18 18 17 18 18 17 18 18 17 18 17 17 18 18 17 17 17 18 17 18 18 17\r\n",
                "2310"
            ],
            [
                "25 4 8954954072064251\r\n17 18 16 17 17 20 18 16 17 19 20 17 16 19 20 17 16 18 17 16 17 16 17 16 19\r\n",
                "0"
            ],
            [
                "25 18 7134671351808397\r\n17 17 18 18 21 20 21 20 19 17 21 18 16 17 18 18 17 20 18 20 18 16 18 21 21\r\n",
                "160"
            ],
            [
                "25 2 376618217984000\r\n17 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 16 1000000000 2345 34521 6587 4564536 234134 12344 23561 2341 2345 324523 123123 4567 8976 345 2134\r\n",
                "1"
            ],
            [
                "25 25 2000000023\r\n1000000000 1000000000 1 1 2 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 2 1 2 1 1\r\n",
                "9422602240"
            ],
            [
                "25 13 2000000023\r\n1000000000 1000000000 1 1 2 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 2 1 2 2 1\r\n",
                "10195317702"
            ],
            [
                "25 19 2000000023\r\n1000000000 1000000000 1 1 2 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 2 1 2 2 1\r\n",
                "10238328832"
            ],
            [
                "25 25 2000005023\r\n1000000000 1000000000 5000 1 2 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 2 1 2 2 1\r\n",
                "3105865728"
            ],
            [
                "24 21 732472010010838\r\n16 4 10 14 4 1 14 8 2 17 8 11 2 7 13 7 7 3 14 10 7 17 17 10\r\n",
                "19440"
            ],
            [
                "23 1 43165708951941\r\n8 6 9 17 1 14 1 12 13 5 15 18 16 8 9 4 8 13 16 7 11 13 1\r\n",
                "0"
            ],
            [
                "23 14 376709893904263\r\n14 6 11 4 16 10 13 2 10 6 10 11 6 14 17 7 2 17 17 13 8 1 2\r\n",
                "16956"
            ],
            [
                "25 23 355687987299309\r\n14 15 11 2 6 15 14 9 1 4 7 18 2 17 3 3 2 11 6 18 13 14 2 11 12\r\n",
                "96"
            ],
            [
                "25 6 355781798669775\r\n14 2 13 17 12 18 10 11 18 2 6 18 1 5 9 3 2 3 14 1 1 18 12 11 10\r\n",
                "0"
            ],
            [
                "24 23 6779165946558798\r\n481199252 6 12 2 5 4 6 15 3 12 14 18 8 6 13 4 17 12 3 2 13 14 16 8\r\n",
                "6264"
            ],
            [
                "24 22 93579450246\r\n54748096 75475634 6 12 18 1 12 13 11 7 10 17 9 9 10 9 6 14 14 15 5 5 15 13\r\n",
                "2352"
            ],
            [
                "24 21 711557276608128\r\n923264237 374288891 535590429 18 17 17 8 14 15 3 4 11 15 2 7 13 8 12 13 3 5 14 10 14\r\n",
                "348"
            ],
            [
                "24 20 6402470099308437\r\n496813081 673102149 561219907 730593611 4 2 15 11 10 12 3 13 16 1 10 8 18 14 6 6 14 6 9 11\r\n",
                "600"
            ],
            [
                "24 19 22239162909709\r\n365329221 412106895 291882089 564718673 358502890 3 7 13 18 8 7 12 3 8 7 12 2 8 4 12 6 9 15 16\r\n",
                "108"
            ],
            [
                "24 18 6402551633230723\r\n643910770 5887448 757703054 544067926 902981667 712695184 3 14 4 11 3 14 4 11 4 7 8 10 7 11 6 18 14 13\r\n",
                "648"
            ],
            [
                "24 17 6758151602395830\r\n72235422 449924898 783332532 378192988 592684636 147499872 343857831 12 17 7 14 12 2 14 1 11 11 12 10 18 16 5 5 18\r\n",
                "192"
            ],
            [
                "24 16 376613867481065\r\n940751563 43705451 513994713 652509537 432130709 317463343 687041819 58265855 7 3 14 10 11 17 16 16 17 10 13 2 3 5 18 5\r\n",
                "64"
            ],
            [
                "24 15 376715306932970\r\n514300407 782710197 539624191 631858791 976609486 752268030 30225807 279200011 467188665 12 18 5 4 2 13 10 1 13 16 1 13 14 17 6\r\n",
                "24"
            ],
            [
                "23 13 357006388025624\r\n598196518 640274071 983359971 71550121 96204862 799843967 446173607 796619138 402690754 223219513 9 17 13 13 17 15 5 2 15 8 2 7 8\r\n",
                "64"
            ],
            [
                "23 12 357087149917608\r\n26521171 379278816 8989449 50899375 935650934 529615950 494390299 427618702 979962232 602512657 429731081 1 10 2 14 9 3 18 17 15 16 12 7\r\n",
                "4"
            ],
            [
                "23 11 18015396922\r\n895037311 678092074 34618927 179991732 480129711 404612126 132541583 648552857 967299118 276773097 341033928 482750975 1 1 11 14 13 2 16 13 7 7 2\r\n",
                "32"
            ],
            [
                "23 10 5498434429\r\n468586155 417096820 205472596 159340986 464799976 839416813 475725571 869487013 249603301 246000832 807626376 125583769 129772276 8 8 18 15 4 9 16 7 7 11\r\n",
                "2"
            ],
            [
                "23 9 7822306195\r\n747167704 715910077 936134778 138690239 714311457 9380284 523942263 795453872 826874779 625293976 864153416 63383860 9374518 851872013 9 13 8 3 8 4 17 16 7\r\n",
                "3"
            ],
            [
                "23 8 6129434724\r\n615683844 454914823 961764255 972815301 258790234 444184972 162093547 16388028 814211665 299554415 625713159 1183950 34200951 73842336 394092460 17 14 1 10 11 4 7 6\r\n",
                "2"
            ],
            [
                "23 7 6584075104\r\n189232688 48695377 692426437 952164554 243460498 173956955 210310239 237322183 96515847 678847559 682240199 498792552 208770488 736004147 176573082 279397774 12 3 17 9 4 17 1\r\n",
                "6"
            ],
            [
                "23 6 6423305153580378\r\n912524637 347508634 863280107 226481104 787939275 48953130 553494227 458256339 673787326 353107999 298575751 436592642 233596921 957974470 254020999 707869688 64999512 1 16 12 14 2 18\r\n",
                "4"
            ],
            [
                "23 5 6403689500951790\r\n486073481 86513380 593942288 60606166 627385348 778725113 896678215 384223198 661124212 882144246 60135494 374392733 408166459 179944793 331468916 401182818 69503967 798728037 15 18 6 11 5\r\n",
                "1"
            ],
            [
                "23 4 355697995919632\r\n764655030 680293934 914539062 744988123 317088317 653721289 239862203 605157354 943428394 261437390 821695238 312192823 432992892 547139308 408916833 829654733 223751525 672158759 193787527 17 9 17 1\r\n",
                "4"
            ],
            [
                "25 5 355697433057426\r\n586588704 509061481 552472140 16115810 148658854 66743034 628305150 677780684 519361360 208050516 401554301 954478790 346543678 387546138 832279893 641889899 80960260 717802881 588066499 661699500 14 17 5 5 12\r\n",
                "1"
            ],
            [
                "22 1 15078298178\r\n160137548 807874739 723325809 995465063 693137631 646771913 971489138 603747543 801665542 882310956 163114045 892278880 371370111 459773357 909727810 630170326 940240523 886200899 882106547 953987440 703402350 8\r\n",
                "1"
            ],
            [
                "22 0 11671182837\r\n733686393 546879484 748955287 974814317 532583704 671511192 314673126 824681699 789002429 261604100 219641085 389887482 250972352 976710976 987175727 58642240 534679569 759631621 26403492 101051189 178325936 789669437\r\n",
                "1"
            ],
            [
                "23 0 10202579405\r\n162011045 845692742 774584765 103906675 222286673 251540072 657857114 45615854 71306611 790640347 835976636 327687572 570766082 48938195 769656348 341889962 393959831 928029640 320443541 248114937 798473713 159552755 533648295\r\n",
                "1"
            ],
            [
                "24 0 12493321628\r\n30527185 439473295 505246946 83255928 766765450 981312055 706073806 971582714 648578089 464900787 597536380 265487663 450368323 565875814 847104265 475394581 693431581 241651850 464740486 100211390 418621491 969627560 755522678 50031311\r\n",
                "1"
            ],
            [
                "25 0 12982465295\r\n604076030 178478041 676100616 622413694 606211522 711084038 344225090 192516869 635914975 139161226 359096124 908320457 770162052 933070329 69776374 758642303 552711844 820115276 609037430 392499330 598577781 484735069 272364358 72345168 670829299\r\n",
                "1"
            ],
            [
                "24 23 20929016909621\r\n481199252 6 12 2 5 4 6 15 3 12 14 18 8 6 13 4 17 12 3 2 13 14 16 8\r\n",
                "1007724"
            ],
            [
                "24 21 355689301156580\r\n923264237 374288891 535590429 18 17 17 8 14 15 3 4 11 15 2 7 13 8 12 13 3 5 14 10 14\r\n",
                "38360"
            ],
            [
                "24 16 20926395674529\r\n940751563 43705451 513994713 652509537 432130709 317463343 687041819 58265855 7 3 14 10 11 17 16 16 17 10 13 2 3 5 18 5\r\n",
                "4000"
            ],
            [
                "23 13 711377554159955\r\n598196518 640274071 983359971 71550121 96204862 799843967 446173607 796619138 402690754 223219513 9 17 13 13 17 15 5 2 15 8 2 7 8\r\n",
                "24"
            ],
            [
                "23 8 90819114674\r\n615683844 454914823 961764255 972815301 258790234 444184972 162093547 16388028 814211665 299554415 625713159 1183950 34200951 73842336 394092460 17 14 1 10 11 4 7 6\r\n",
                "1"
            ],
            [
                "25 5 7183838143\r\n586588704 509061481 552472140 16115810 148658854 66743034 628305150 677780684 519361360 208050516 401554301 954478790 346543678 387546138 832279893 641889899 80960260 717802881 588066499 661699500 14 17 5 5 12\r\n",
                "2"
            ],
            [
                "22 0 7002300855\r\n733686393 546879484 748955287 974814317 532583704 671511192 314673126 824681699 789002429 261604100 219641085 389887482 250972352 976710976 987175727 58642240 534679569 759631621 26403492 101051189 178325936 789669437\r\n",
                "1"
            ],
            [
                "25 0 8812325752\r\n604076030 178478041 676100616 622413694 606211522 711084038 344225090 192516869 635914975 139161226 359096124 908320457 770162052 933070329 69776374 758642303 552711844 820115276 609037430 392499330 598577781 484735069 272364358 72345168 670829299\r\n",
                "1"
            ],
            [
                "23 12 1307674408320\r\n818219322 490480030 946157371 335075927 504332527 696433549 421447064 242605730 513711473 879700707 875141086 8 18 5 8 18 2 2 2 11 15 10 1\r\n",
                "2"
            ],
            [
                "23 9 356999252684127\r\n672509980 76127167 93413008 709188915 563436455 432103889 115272158 698233775 382556143 771342465 178361701 711213646 803513458 87049574 16 18 5 17 5 15 9 10 18\r\n",
                "1"
            ],
            [
                "22 7 94086626507\r\n400086390 24218459 946613393 146658464 240900479 960251651 888572685 326830726 485573749 506482600 828508367 964019704 563712967 891568106 732815759 7 7 14 1 2 1 18\r\n",
                "16"
            ],
            [
                "23 19 694110791\r\n694105695 469829284 490636148 769880615 1 12 7 9 18 15 15 7 7 6 18 2 5 1 2 15 15 15 17\r\n",
                "24564"
            ],
            [
                "23 15 19\r\n40331947 578270895 19785190 374648773 533884491 64268719 268359611 970419752 12 16 17 3 1 4 9 2 11 10 7 15 1 3 7\r\n",
                "331"
            ],
            [
                "23 2 5065472115\r\n428801639 184568779 477337858 18989778 249804431 579004904 679880522 901530462 200642926 941909941 377757672 300378484 103633484 503801915 910270476 13399319 214483686 671551510 986061470 346894110 521433581 12 5\r\n",
                "1"
            ],
            [
                "23 2 4048109324\r\n770994128 412395956 564263966 104420757 877068479 285202875 550663793 644680192 709693551 190709580 978965731 122048808 648617624 375329937 297799155 929741838 337809699 382782724 945661847 136720969 898777264 4 10\r\n",
                "1"
            ],
            [
                "22 11 355777681121374\r\n352861197 501423986 564719989 916003293 908603727 959086385 17789414 583680997 826780019 112458769 227300308 12 17 14 6 3 12 10 2 11 8 12\r\n",
                "6"
            ],
            [
                "23 5 5657256853\r\n61927663 677005715 711975626 730307769 817964551 549532534 856838700 189052146 695624689 4100527 530520923 59586998 333673225 125072914 526575822 99222914 877574527 650143337 5 11 3 4 6\r\n",
                "1"
            ],
            [
                "22 16 22231735758643\r\n447311584 102302533 183282606 937122147 163131823 371482325 4 16 16 9 10 15 6 16 4 10 14 8 12 10 2 2\r\n",
                "3573"
            ],
            [
                "23 17 6759458873943562\r\n14702469 303954345 330082221 499652598 895733207 843334564 15 5 12 4 12 14 4 18 17 18 4 3 12 6 2 2 5\r\n",
                "128"
            ],
            [
                "22 19 6402375527188783\r\n669424209 895126102 256910425 17 17 8 11 17 1 18 14 7 4 1 15 5 8 15 10 10 10 13\r\n",
                "1886"
            ],
            [
                "22 8 6960722973\r\n425715868 3567713 786059466 876430447 879051763 886218511 170876867 706123870 247133492 299058498 853334800 185990027 641160884 174815828 6 1 18 2 5 7 14 5\r\n",
                "8"
            ],
            [
                "25 20 1308180371599\r\n731464501 285497487 892432116 218274129 458569375 3 14 17 11 16 7 15 16 3 1 5 11 16 11 15 13 7 5 10 10\r\n",
                "0"
            ],
            [
                "25 17 1311878711325\r\n757093979 264846740 436910893 243013408 801753363 254065895 579134035 609847689 15 10 9 4 13 7 18 3 14 5 2 15 8 12 7 15 17\r\n",
                "0"
            ],
            [
                "25 2 3288144341\r\n782723456 393939098 126613862 677818096 144937351 475000050 861438217 284108128 274856175 88383185 912041882 3941587 489034386 211074902 308950662 308611657 417645457 784954245 947958718 464312042 578753998 973835975 805832248 17 18\r\n",
                "0"
            ],
            [
                "25 4 5095166378\r\n953577126 373288351 966059935 552814271 193154043 400966910 143742399 663401272 36415918 26183275 936868315 520879206 566482303 639546816 313455116 182042379 711685505 932017994 422882304 979419551 800628381 18 2 4 5\r\n",
                "0"
            ],
            [
                "25 9 1399657417\r\n684239308 207413413 510538712 577553550 831305327 326933769 426046582 192437520 652751470 963983365 111437852 593106425 348962924 332859946 467702674 495664590 4 12 4 6 2 1 18 9 12\r\n",
                "0"
            ],
            [
                "3 1 24\r\n4 10 14\r\n",
                "2"
            ],
            [
                "25 25 3000005022\r\n1000000000 1000000000 5000 1000000000 2 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 2 1 2 2 1\r\n",
                "1104076800"
            ],
            [
                "25 25 1000005024\r\n1000000000 1 5000 1 2 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 2 1 2 2 1\r\n",
                "8662843392"
            ],
            [
                "25 25 12\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n",
                "21300428800"
            ],
            [
                "25 13 64182542054562\r\n10 13 10 11 14 15 16 16 16 13 11 12 13 16 15 15 13 16 13 12 14 11 11 14 14\r\n",
                "2400"
            ],
            [
                "25 25 6758073589000599\r\n7 6 13 15 3 2 4 18 1 17 13 17 9 5 16 17 12 18 3 9 17 8 1 7 9\r\n",
                "128"
            ],
            [
                "25 23 6780291602197838\r\n6 13 18 8 4 7 15 2 17 1 16 8 4 16 10 18 17 9 14 1 14 2 8 11 15\r\n",
                "2336"
            ],
            [
                "25 2 12680562939\r\n715049313 915998492 578565942 855855826 497510114 582399573 930430334 286893113 391355789 331145449 93832233 202504960 728884607 204451031 664271485 292928862 572940745 227069487 402758132 446406368 779727087 595211160 904571581 16 18\r\n",
                "0"
            ],
            [
                "25 2 11195364025\r\n98718117 970465012 358887575 342461819 363429300 22954887 226633382 276685273 929524398 919300070 611367092 828471311 346387103 140272916 158548966 957310154 619598695 481800204 62782071 980986351 636091193 761224761 26106419 18 17\r\n",
                "0"
            ],
            [
                "25 21 355687471641600\r\n757093979 436910893 801753363 43545600 3 4 5 6 7 8 9 10 11 12 13 13 14 14 15 15 15 16 16 17 17\r\n",
                "4"
            ],
            [
                "25 0 12\r\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n",
                "5200300"
            ],
            [
                "1 1 1\r\n1\r\n",
                "2"
            ],
            [
                "25 25 10000000000000000\r\n2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 1 2 3 4 5 6 7 8 9 10\r\n",
                "0"
            ],
            [
                "25 25 1307674368024\r\n15 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\r\n",
                "16777216"
            ],
            [
                "25 25 10000000000000000\r\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\r\n",
                "0"
            ],
            [
                "25 25 6780385530509849\r\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 32768 65536 131072 262144 524288 1048576 2097152\r\n",
                "4"
            ],
            [
                "25 25 12345678912345\r\n850721285 30306609 347099405 96957258 314543014 652545309 470894833 754515549 609681909 430315134 826092337 795319741 19167845 135991499 395492127 459806108 925737587 385950327 672837854 485396408 132630282 743562669 239478998 748888777 156720060\r\n",
                "0"
            ]
        ]
    }
]