[
    {
        "name": "Xenia and Dominoes",
        "description": "Xenia likes puzzles very much. She is especially fond of the puzzles that\nconsist of domino pieces. Look at the picture that shows one of such puzzles.\nA puzzle is a 3 \u00d7 n table with forbidden cells (black squares) containing\ndominoes (colored rectangles on the picture). A puzzle is called correct if it\nmeets the following conditions: each domino occupies exactly two non-forbidden\ncells of the table; no two dominoes occupy the same table cell; exactly one\nnon-forbidden cell of the table is unoccupied by any domino (it is marked by a\ncircle in the picture). To solve the puzzle, you need multiple steps to\ntransport an empty cell from the starting position to some specified position.\nA move is transporting a domino to the empty cell, provided that the puzzle\nstays correct. The horizontal dominoes can be moved only horizontally, and\nvertical dominoes can be moved only vertically. You can't rotate dominoes. The\npicture shows a probable move. Xenia has a 3 \u00d7 n table with forbidden cells\nand a cell marked with a circle. Also, Xenia has very many identical dominoes.\nNow Xenia is wondering, how many distinct correct puzzles she can make if she\nputs dominoes on the existing table. Also, Xenia wants the circle-marked cell\nto be empty in the resulting puzzle. The puzzle must contain at least one\nmove. Help Xenia, count the described number of puzzles. As the described\nnumber can be rather large, print the remainder after dividing it by\n1000000007 (10^9 + 7). Input The first line contains integer n (3 \u2264 n \u2264 10^4)\n\u2014 the puzzle's size. Each of the following three lines contains n characters \u2014\nthe description of the table. The j-th character of the i-th line equals \"X\"\nif the corresponding cell is forbidden; it equals \".\", if the corresponding\ncell is non-forbidden and \"O\", if the corresponding cell is marked with a\ncircle. It is guaranteed that exactly one cell in the table is marked with a\ncircle. It is guaranteed that all cells of a given table having at least one\ncommon point with the marked cell is non-forbidden. Output Print a single\nnumber \u2014 the answer to the problem modulo 1000000007 (10^9 + 7). Examples\nInput 5 ....X .O... ...X. Output 1 Input 5 ..... .O... ..... Output 2 Input 3\n... ... ..O Output 4 Note Two puzzles are considered distinct if there is a\npair of cells that contain one domino in one puzzle and do not contain it in\nthe other one.\n\n",
        "cf_contest_id": 342,
        "cf_index": "D",
        "cf_rating": 2100,
        "difficulty": 0,
        "cf_tags": [
            "bitmasks",
            "dfs and similar",
            "dp"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "5\r\n....X\r\n.O...\r\n...X.\r\n",
                "1\r\n"
            ],
            [
                "5\r\n.....\r\n.O...\r\n.....\r\n",
                "2\r\n"
            ],
            [
                "3\r\n...\r\n...\r\n..O\r\n",
                "4\r\n"
            ]
        ],
        "private_cases": []
    }
]