[
    {
        "name": "Cat Party (Hard Edition)",
        "description": "This problem is same as the previous one, but has larger constraints. Shiro's\njust moved to the new house. She wants to invite all friends of her to the\nhouse so they can play monopoly. However, her house is too small, so she can\nonly invite one friend at a time. For each of the \n    n\n days since the day\nShiro moved to the new house, there will be exactly one cat coming to the\nShiro's house. The cat coming in the \n    i\n-th day has a ribbon with color\n\n    u_i\n. Shiro wants to know the largest number \n    x\n, such that if we\nconsider the streak of the first \n    x\n days, it is possible to remove\nexactly one day from this streak so that every ribbon color that has appeared\namong the remaining \n    x - 1\n will have the same number of occurrences. For\nexample, consider the following sequence of \n    u_i\n: \n    [2, 2, 1, 1, 5, 4,\n    4, 5]\n. Then \n    x = 7\n makes a streak, since if we remove the leftmost\n\n    u_i = 5\n, each ribbon color will appear exactly twice in the prefix of\n\n    x - 1\n days. Note that \n    x = 8\n doesn't form a streak, since you must\nremove exactly one day. Since Shiro is just a cat, she is not very good at\ncounting and needs your help finding the longest streak. Input The first line\ncontains a single integer \n    n\n (\n    1 \n    \u2264 n \n    \u2264 10^5\n) \u2014 the total\nnumber of days. The second line contains \n    n\n integers \n    u_1, u_2,\n    \n    \u2026, u_n\n (\n    1 \n    \u2264 u_i \n    \u2264 10^5\n) \u2014 the colors of the ribbons\nthe cats wear. Output Print a single integer \n    x\n \u2014 the largest possible\nstreak of days. Examples Input 13 1 1 1 2 2 2 3 3 3 4 4 4 5 Output 13 Input 5\n10 100 20 200 1 Output 5 Input 1 100000 Output 1 Input 7 3 2 1 1 4 5 1 Output\n6 Input 6 1 1 1 2 2 2 Output 5 Note In the first example, we can choose the\nlongest streak of \n    13\n days, since upon removing the last day out of the\nstreak, all of the remaining colors \n    1\n, \n    2\n, \n    3\n, and \n    4\n\nwill have the same number of occurrences of \n    3\n. Note that the streak can\nalso be \n    10\n days (by removing the \n    10\n-th day from this streak) but\nwe are interested in the longest streak. In the fourth example, if we take the\nstreak of the first \n    6\n days, we can remove the third day from this streak\nthen all of the remaining colors \n    1\n, \n    2\n, \n    3\n, \n    4\n and\n\n    5\n will occur exactly once.\n\n",
        "cf_contest_id": 1163,
        "cf_index": "B2",
        "cf_rating": 1600,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "implementation"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "13\r\n1 1 1 2 2 2 3 3 3 4 4 4 5\r\n",
                "13\r\n"
            ],
            [
                "5\r\n10 100 20 200 1\r\n",
                "5\r\n"
            ],
            [
                "1\r\n100000\r\n",
                "1\r\n"
            ],
            [
                "7\r\n3 2 1 1 4 5 1\r\n",
                "6\r\n"
            ],
            [
                "6\r\n1 1 1 2 2 2\r\n",
                "5\r\n"
            ]
        ],
        "private_cases": [
            [
                "10\r\n30518 96518 74071 59971 50121 4862 43967 73607 19138 90754\r\n",
                "10\r\n"
            ],
            [
                "10\r\n4131 4373 75721 60904 4027 25878 13621 3245 60722 8295\r\n",
                "10\r\n"
            ],
            [
                "10\r\n30518 30518 30518 30518 30518 30518 30518 30518 30518 30518\r\n",
                "10\r\n"
            ],
            [
                "10\r\n63649 14562 779 31060 84730 3390 1402 70955 27426 79066\r\n",
                "10\r\n"
            ],
            [
                "10\r\n8 8 1 1 1 2 7 7 8 4\r\n",
                "5\r\n"
            ],
            [
                "10\r\n4 10 4 4 5 10 10 4 10 10\r\n",
                "9\r\n"
            ],
            [
                "10\r\n1 4 5 2 5 2 3 3 4 1\r\n",
                "9\r\n"
            ],
            [
                "6\r\n6 1 2 1 6 2\r\n",
                "5\r\n"
            ]
        ]
    }
]