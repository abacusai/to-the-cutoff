[
    {
        "name": "Ehab and the Expected GCD Problem",
        "description": "Let's define a function \n    f(p)\n on a permutation \n    p\n as follows. Let\n\n    g_i\n be the greatest common divisor (GCD) of elements \n    p_1\n,\n\n    p_2\n, ..., \n    p_i\n (in other words, it is the GCD of the prefix of\nlength \n    i\n). Then \n    f(p)\n is the number of distinct elements among\n\n    g_1\n, \n    g_2\n, ..., \n    g_n\n. Let \n    f_max(n)\n be the maximum\nvalue of \n    f(p)\n among all permutations \n    p\n of integers \n    1\n,\n\n    2\n, ..., \n    n\n. Given an integers \n    n\n, count the number of\npermutations \n    p\n of integers \n    1\n, \n    2\n, ..., \n    n\n, such that\n\n    f(p)\n is equal to \n    f_max(n)\n. Since the answer may be large, print\nthe remainder of its division by \n    1000\n     000\n     007 = 10^9 + 7\n. Input\nThe only line contains the integer \n    n\n (\n    2 \n    \u2264 n \n    \u2264 10^6\n) \u2014 the\nlength of the permutations. Output The only line should contain your answer\nmodulo \n    10^9+7\n. Examples Input 2 Output 1 Input 3 Output 4 Input 6 Output\n120 Note Consider the second example: these are the permutations of length\n\n    3\n: \n    [1,2,3]\n, \n    f(p)=1\n. \n    [1,3,2]\n, \n    f(p)=1\n.\n\n    [2,1,3]\n, \n    f(p)=2\n. \n    [2,3,1]\n, \n    f(p)=2\n. \n    [3,1,2]\n,\n\n    f(p)=2\n. \n    [3,2,1]\n, \n    f(p)=2\n. The maximum value \n    f_max(3) =\n    2\n, and there are \n    4\n permutations \n    p\n such that \n    f(p)=2\n.\n\n",
        "cf_contest_id": 1174,
        "cf_index": "E",
        "cf_rating": 2500,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "dp",
            "math",
            "number theory"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2\r\n",
                "1\r\n"
            ],
            [
                "3\r\n",
                "4\r\n"
            ],
            [
                "6\r\n",
                "120\r\n"
            ]
        ],
        "private_cases": [
            [
                "10\r\n",
                "15120\r\n"
            ],
            [
                "64\r\n",
                "676169815\r\n"
            ],
            [
                "1227\r\n",
                "9412302\r\n"
            ],
            [
                "49152\r\n",
                "468540828\r\n"
            ],
            [
                "1000000\r\n",
                "943169120\r\n"
            ],
            [
                "524288\r\n",
                "948408574\r\n"
            ],
            [
                "786431\r\n",
                "973886300\r\n"
            ],
            [
                "999999\r\n",
                "88378773\r\n"
            ],
            [
                "217292\r\n",
                "936105571\r\n"
            ],
            [
                "16339\r\n",
                "166382218\r\n"
            ],
            [
                "4\r\n",
                "2\r\n"
            ],
            [
                "5\r\n",
                "6\r\n"
            ],
            [
                "7\r\n",
                "600\r\n"
            ],
            [
                "8\r\n",
                "240\r\n"
            ],
            [
                "9\r\n",
                "1440\r\n"
            ],
            [
                "50\r\n",
                "938830187\r\n"
            ],
            [
                "87\r\n",
                "247668980\r\n"
            ],
            [
                "71\r\n",
                "744016814\r\n"
            ],
            [
                "73\r\n",
                "405863164\r\n"
            ],
            [
                "89\r\n",
                "222320695\r\n"
            ],
            [
                "40\r\n",
                "193507326\r\n"
            ],
            [
                "42\r\n",
                "270627256\r\n"
            ],
            [
                "847\r\n",
                "206774372\r\n"
            ],
            [
                "676\r\n",
                "491267527\r\n"
            ],
            [
                "639\r\n",
                "32577133\r\n"
            ],
            [
                "957\r\n",
                "885557037\r\n"
            ],
            [
                "156\r\n",
                "980176938\r\n"
            ],
            [
                "479\r\n",
                "784626857\r\n"
            ],
            [
                "586\r\n",
                "77973950\r\n"
            ],
            [
                "683\r\n",
                "951224867\r\n"
            ],
            [
                "3541\r\n",
                "358246424\r\n"
            ],
            [
                "6264\r\n",
                "136451422\r\n"
            ],
            [
                "4140\r\n",
                "371936240\r\n"
            ],
            [
                "8969\r\n",
                "651607899\r\n"
            ],
            [
                "3080\r\n",
                "806160386\r\n"
            ],
            [
                "7127\r\n",
                "515942917\r\n"
            ],
            [
                "3116\r\n",
                "390594722\r\n"
            ],
            [
                "86214\r\n",
                "17417160\r\n"
            ],
            [
                "28211\r\n",
                "5179894\r\n"
            ],
            [
                "62544\r\n",
                "554785078\r\n"
            ],
            [
                "96262\r\n",
                "882337958\r\n"
            ],
            [
                "21504\r\n",
                "299254647\r\n"
            ],
            [
                "603070\r\n",
                "15758000\r\n"
            ],
            [
                "261873\r\n",
                "965169285\r\n"
            ],
            [
                "582911\r\n",
                "825030283\r\n"
            ],
            [
                "789700\r\n",
                "501403228\r\n"
            ],
            [
                "838757\r\n",
                "220750034\r\n"
            ],
            [
                "546330\r\n",
                "784174655\r\n"
            ],
            [
                "774942\r\n",
                "979976656\r\n"
            ],
            [
                "629462\r\n",
                "20530480\r\n"
            ],
            [
                "131156\r\n",
                "751299482\r\n"
            ],
            [
                "874465\r\n",
                "417880003\r\n"
            ],
            [
                "200945\r\n",
                "712409910\r\n"
            ],
            [
                "919645\r\n",
                "465123203\r\n"
            ],
            [
                "215283\r\n",
                "197619154\r\n"
            ],
            [
                "955654\r\n",
                "416395816\r\n"
            ],
            [
                "437675\r\n",
                "305205122\r\n"
            ],
            [
                "175863\r\n",
                "442215433\r\n"
            ],
            [
                "126395\r\n",
                "374976337\r\n"
            ],
            [
                "406138\r\n",
                "648609649\r\n"
            ],
            [
                "425221\r\n",
                "973943578\r\n"
            ],
            [
                "460829\r\n",
                "66014534\r\n"
            ],
            [
                "211425\r\n",
                "501705216\r\n"
            ],
            [
                "662327\r\n",
                "118190038\r\n"
            ],
            [
                "798412\r\n",
                "47586814\r\n"
            ],
            [
                "163259\r\n",
                "581955590\r\n"
            ],
            [
                "786432\r\n",
                "755978297\r\n"
            ]
        ]
    }
]