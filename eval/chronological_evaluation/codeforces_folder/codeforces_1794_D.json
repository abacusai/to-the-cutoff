[
    {
        "name": "Counting Factorizations",
        "description": "The prime factorization of a positive integer \n    m\n is the unique way to\nwrite it as \n    m=p_1^e_1\n    \u00b7 p_2^e_2\n    \u00b7\n    \u2026\n    \u00b7 p_k^e_k\n, where \n    p_1, p_2, \n    \u2026, p_k\n are prime numbers,\n\n    p_1 < p_2 < \n    \u2026 < p_k\n and \n    e_1, e_2, \n    \u2026, e_k\n are\npositive integers. For each positive integer \n    m\n, \n    f(m)\n is defined as\nthe multiset of all numbers in its prime factorization, that is\n\n    f(m)=\n    \n    p_1,e_1,p_2,e_2,\n    \u2026,p_k,e_k\n. For example,\n\n    f(24)=\n    \n    2,3,3,1\n, \n    f(5)=\n    \n    1,5\n and\n\n    f(1)=\n. You are given a list consisting of \n    2n\n integers\n\n    a_1, a_2, \n    \u2026, a_2n\n. Count how many positive integers \n    m\n\nsatisfy that \n    f(m)=\n    \n    a_1, a_2, \n    \u2026, a_2n\n. Since this value\nmay be large, print it modulo \n    998\n     244\n     353\n. Input The first line\ncontains one integer \n    n\n (\n    1\n    \u2264 n \n    \u2264 2022\n). The second line\ncontains \n    2n\n integers \n    a_1, a_2, \n    \u2026, a_2n\n (\n    1\n    \u2264\n    a_i\n    \u2264 10^6\n) \u2014 the given list. Output Print one integer, the number of\npositive integers \n    m\n satisfying \n    f(m)=\n    \n    a_1, a_2, \n    \u2026,\n    a_2n\n modulo \n    998\n     244\n     353\n. Examples Input 2 1 3 2 3 Output\n2 Input 2 2 2 3 5 Output 5 Input 1 1 4 Output 0 Note In the first sample, the\ntwo values of \n    m\n such that \n    f(m)=\n    \n    1,2,3,3\n are \n    m=24\n\nand \n    m=54\n. Their prime factorizations are \n    24=2^3\n    \u00b7 3^1\n and\n\n    54=2^1\n    \u00b7 3^3\n. In the second sample, the five values of \n    m\n such\nthat \n    f(m)=\n    \n    2,2,3,5\n are \n    200, 225, 288, 500\n and \n    972\n.\nIn the third sample, there is no value of \n    m\n such that\n\n    f(m)=\n    \n    1,4\n. Neither \n    1^4\n nor \n    4^1\n are prime\nfactorizations because \n    1\n and \n    4\n are not primes.\n\n",
        "cf_contest_id": 1794,
        "cf_index": "D",
        "cf_rating": 1900,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "divide and conquer",
            "dp",
            "math",
            "number theory"
        ],
        "time_limit_seconds": 4.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2\r\n1 3 2 3\r\n",
                "2"
            ],
            [
                "2\r\n2 2 3 5\r\n",
                "5"
            ],
            [
                "1\r\n1 4\r\n",
                "0"
            ]
        ],
        "private_cases": [
            [
                "1\r\n10 5\r\n",
                "1"
            ],
            [
                "10\r\n38 89 56 56 5 2 37 64 31 99 2 77 97 6 61 48 83 79 86 73\r\n",
                "1814400"
            ],
            [
                "1\r\n1 1\r\n",
                "0"
            ],
            [
                "1\r\n1 2\r\n",
                "1"
            ],
            [
                "1\r\n2 2\r\n",
                "1"
            ],
            [
                "1\r\n3 2\r\n",
                "2"
            ]
        ]
    }
]