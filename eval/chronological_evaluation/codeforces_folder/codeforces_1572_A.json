[
    {
        "name": "Book",
        "description": "You are given a book with \n    n\n chapters. Each chapter has a specified list\nof other chapters that need to be understood in order to understand this\nchapter. To understand a chapter, you must read it after you understand every\nchapter on its required list. Currently you don't understand any of the\nchapters. You are going to read the book from the beginning till the end\nrepeatedly until you understand the whole book. Note that if you read a\nchapter at a moment when you don't understand some of the required chapters,\nyou don't understand this chapter. Determine how many times you will read the\nbook to understand every chapter, or determine that you will never understand\nevery chapter no matter how many times you read the book. Input Each test\ncontains multiple test cases. The first line contains the number of test cases\n\n    t\n (\n    1 \n    \u2264 t \n    \u2264 2\n    \u00b710^4\n). The first line of each test case\ncontains a single integer \n    n\n (\n    1 \n    \u2264 n \n    \u2264 2\n    \u00b710^5\n) \u2014\nnumber of chapters. Then \n    n\n lines follow. The \n    i\n-th line begins with\nan integer \n    k_i\n (\n    0 \n    \u2264 k_i \n    \u2264 n-1\n) \u2014 number of chapters\nrequired to understand the \n    i\n-th chapter. Then \n    k_i\n integers\n\n    a_i,1, a_i,2, \n    \u2026, a_i, k_i\n (\n    1 \n    \u2264 a_i, j\n    \u2264 n,\n    a_i, j\n     i, a_i, j\n     a_i, l\n for \n    j \n     l\n) follow \u2014 the\nchapters required to understand the \n    i\n-th chapter. It is guaranteed that\nthe sum of \n    n\n and sum of \n    k_i\n over all testcases do not exceed\n\n    2\n    \u00b710^5\n. Output For each test case, if the entire book can be\nunderstood, print how many times you will read it, otherwise print \n    -1\n.\nExample Input 5 4 1 2 0 2 1 4 1 2 5 1 5 1 1 1 2 1 3 1 4 5 0 0 2 1 2 1 2 2 2 1\n4 2 2 3 0 0 2 3 2 5 1 2 1 3 1 4 1 5 0 Output 2 -1 1 2 5 Note In the first\nexample, we will understand chapters \n    2, 4\n in the first reading\nand chapters \n    1, 3\n in the second reading of the book. In the\nsecond example, every chapter requires the understanding of some other\nchapter, so it is impossible to understand the book. In the third example,\nevery chapter requires only chapters that appear earlier in the book, so we\ncan understand everything in one go. In the fourth example, we will understand\nchapters \n    2, 3, 4\n in the first reading and chapter \n    1\n in\nthe second reading of the book. In the fifth example, we will understand one\nchapter in every reading from \n    5\n to \n    1\n.\n\n",
        "cf_contest_id": 1572,
        "cf_index": "A",
        "cf_rating": 1800,
        "difficulty": 0,
        "cf_tags": [
            "binary search",
            "brute force",
            "data structures",
            "dp",
            "graphs",
            "implementation",
            "sortings"
        ],
        "time_limit_seconds": 1.5,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "5\r\n4\r\n1 2\r\n0\r\n2 1 4\r\n1 2\r\n5\r\n1 5\r\n1 1\r\n1 2\r\n1 3\r\n1 4\r\n5\r\n0\r\n0\r\n2 1 2\r\n1 2\r\n2 2 1\r\n4\r\n2 2 3\r\n0\r\n0\r\n2 3 2\r\n5\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n0\r\n",
                "2\r\n-1\r\n1\r\n2\r\n5\r\n"
            ]
        ],
        "private_cases": []
    }
]