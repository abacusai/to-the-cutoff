[
    {
        "name": "Air Reform",
        "description": "Berland is a large country with developed airlines. In total, there are\n\n    n\n cities in the country that are historically served by the Berlaflot\nairline. The airline operates bi-directional flights between \n    m\n pairs of\ncities, \n    i\n-th of them connects cities with numbers \n    a_i\n and\n\n    b_i\n and has a price \n    c_i\n for a flight in both directions. It is\nknown that Berlaflot flights can be used to get from any city to any other\n(possibly with transfers), and the cost of any route that consists of several\nconsequent flights is equal to the cost of the most expensive of them. More\nformally, the cost of the route from a city \n    t_1\n to a city \n    t_k\n with\n\n    (k-2)\n transfers using cities \n    t_2,\n     t_3,\n     t_4,\n     \n    \u2026,\n    t_k - 1\n is equal to the maximum cost of flights from \n    t_1\n to\n\n    t_2\n, from \n    t_2\n to \n    t_3\n, from \n    t_3\n to \n    t_4\n and so on\nuntil the flight from \n    t_k - 1\n to \n    t_k\n. Of course, all these\nflights must be operated by Berlaflot. A new airline, S8 Airlines, has\nrecently started operating in Berland. This airline provides bi-directional\nflights between all pairs of cities that are not connected by Berlaflot direct\nflights. Thus, between each pair of cities there is a flight of either\nBerlaflot or S8 Airlines. The cost of S8 Airlines flights is calculated as\nfollows: for each pair of cities \n    x\n and \n    y\n that is connected by a S8\nAirlines flight, the cost of this flight is equal to the minimum cost of the\nroute between the cities \n    x\n and \n    y\n at Berlaflot according to the\npricing described earlier. It is known that with the help of S8 Airlines\nflights you can get from any city to any other with possible transfers, and,\nsimilarly to Berlaflot, the cost of a route between any two cities that\nconsists of several S8 Airlines flights is equal to the cost of the most\nexpensive flight. Due to the increased competition with S8 Airlines, Berlaflot\ndecided to introduce an air reform and change the costs of its flights.\nNamely, for the \n    i\n-th of its flight between the cities \n    a_i\n and\n\n    b_i\n, Berlaflot wants to make the cost of this flight equal to the\nminimum cost of the route between the cities \n    a_i\n and \n    b_i\n at S8\nAirlines. Help Berlaflot managers calculate new flight costs. Input Each test\nconsists of multiple test cases. The first line contains one integer \n    t\n\n(\n    1 \n    \u2264 t \n    \u2264 10\n     000\n) \u2014 the amount of test cases. The first line\nof each test case contains two integers \n    n\n and \n    m\n (\n    4 \n    \u2264 n\n    \n    \u2264 200\n     000\n, \n    n - 1 \n    \u2264 m \n    \u2264 200\n     000\n, \n    m \n    \u2264\n    (n - 1) (n - 2)/2\n) \u2014 the amount of cities in Berland and the\namount of Berlaflot flights. The next \n    m\n lines contain the description of\nBerlaflot flights. The \n    i\n-th line contains three integers \n    a_i\n,\n\n    b_i\n and \n    c_i\n (\n    1 \n    \u2264 a_i, b_i \n    \u2264 n\n, \n    1 \n    \u2264 c_i \n    \u2264\n    10^9\n) \u2014 the numbers of cities that are connected with \n    i\n-th Berlaflot\nflight and the price of \n    i\n-th Berlaflot flight. It is guaranteed that no\nflight connects a city with itself, no two flights connect the same pair of\ncities. It is guaranteed that by using Berlaflot flights it is possible to get\nfrom any city to any other and by using S8 Airlines flights it is possible to\nget from any city to any other. Let \n    N\n be the sum of \n    n\n over all\ntest cases and \n    M\n be the sum of \n    m\n over all test cases. It is\nguaranteed that \n    N, M \n    \u2264 200\n     000\n. Output For each test case you\nshould print \n    m\n integers in a single line, \n    i\n-th of them should be\nthe price of \n    i\n-th Berlaflot flight after the air reform. Example Input 3\n4 3 1 2 1 2 3 2 4 3 3 5 5 1 2 1 1 3 1 2 4 1 4 5 2 5 1 3 6 6 1 2 3 2 3 1 3 6 5\n3 4 2 4 5 4 2 4 2 Output 3 3 3 1 1 1 2 2 4 4 5 3 4 4 Note In the first test\ncase S8 Airlines will provide flights between these pairs of cities: \n    (1,\n    3)\n, \n    (1, 4)\n and \n    (2, 4)\n. The cost of a flight between cities\n\n    1\n and \n    3\n will be equal to \n    2\n, since the minimum cost of the\nBerlaflot route is \n    2\n \u2014 the route consists of a flight between cities\n\n    1\n and \n    2\n costing \n    1\n and a flight between cities \n    2\n and\n\n    3\n costing \n    2\n, the maximum cost is \n    2\n. The cost of a flight\nbetween cities \n    1\n and \n    4\n will be \n    3\n, since the minimum cost of\nthe Berlaflot route is \n    3\n \u2014 the route consists of a flight between cities\n\n    1\n and \n    2\n costing \n    1\n, a flight between cities \n    2\n and\n\n    3\n costing \n    2\n and a flight between cities \n    3\n and \n    4\n\ncosting \n    3\n, the maximum cost is \n    3\n. The cost of a flight between\ncities \n    2\n and \n    4\n will be \n    3\n, since the minimum cost of the\nBerlaflot route is \n    3\n \u2014 the route consists of a flight between cities\n\n    2\n and \n    3\n costing \n    2\n and a flight between cities \n    3\n and\n\n    4\n costing \n    3\n, the maximum cost is \n    3\n. After the air reform,\nthe cost of the Berlaflot flight between cities \n    1\n and \n    2\n will be\n\n    3\n, since the minimum cost of the S8 Airlines route between these cities\nis \n    3\n \u2014 the route consists of a flight between cities \n    1\n and \n    4\n\ncosting \n    3\n and a flight between cities \n    2\n and \n    4\n costing\n\n    3\n, the maximum cost is \n    3\n. The cost of the Berlaflot flight between\ncities \n    2\n and \n    3\n will be \n    3\n, since the minimum cost of the S8\nAirlines route between these cities is \n    3\n \u2014 the route consists of a\nflight between cities \n    2\n and \n    4\n costing \n    3\n, a flight between\ncities \n    1\n and \n    4\n costing \n    3\n and a flight between \n    1\n and\n\n    3\n costing \n    2\n, the maximum cost is \n    3\n. The cost of the\nBerlaflot flight between cities \n    3\n and \n    4\n will be \n    3\n, since the\nminimum cost of the S8 Airlines route between these cities is \n    3\n \u2014 the\nroute consists of a flight between cities \n    1\n and \n    3\n costing \n    2\n\nand a flight between cities \n    1\n and \n    4\n costing \n    3\n, the maximum\ncost is \n    3\n. In the second test case S8 Airlines will have the following\nflights: between cities \n    1\n and \n    4\n costing \n    1\n, between cities\n\n    2\n and \n    3\n costing \n    1\n, between cities \n    2\n and \n    5\n\ncosting \n    2\n, between cities \n    3\n and \n    4\n costing \n    1\n and\nbetween cities \n    3\n and \n    5\n costing \n    2\n.\n\n",
        "cf_contest_id": 1648,
        "cf_index": "E",
        "cf_rating": 3200,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "dfs and similar",
            "divide and conquer",
            "dsu",
            "graphs",
            "implementation",
            "trees"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "3\r\n4 3\r\n1 2 1\r\n2 3 2\r\n4 3 3\r\n5 5\r\n1 2 1\r\n1 3 1\r\n2 4 1\r\n4 5 2\r\n5 1 3\r\n6 6\r\n1 2 3\r\n2 3 1\r\n3 6 5\r\n3 4 2\r\n4 5 4\r\n2 4 2\r\n",
                "3 3 3 \r\n1 1 1 2 2 \r\n4 4 5 3 4 4 \r\n"
            ]
        ],
        "private_cases": []
    }
]