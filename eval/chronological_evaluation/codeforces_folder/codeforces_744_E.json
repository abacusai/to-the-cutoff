[
    {
        "name": "Hongcow Masters the Cyclic Shift",
        "description": "Hongcow's teacher heard that Hongcow had learned about the cyclic shift, and\ndecided to set the following problem for him. You are given a list of n\nstrings s1, s2, ..., sn contained in the list A. A list X of strings is called\nstable if the following condition holds. First, a message is defined as a\nconcatenation of some elements of the list X. You can use an arbitrary element\nas many times as you want, and you may concatenate these elements in any\narbitrary order. Let SX denote the set of of all messages you can construct\nfrom the list. Of course, this set has infinite size if your list is nonempty.\nCall a single message good if the following conditions hold: Suppose the\nmessage is the concatenation of k strings w1, w2, ..., wk, where each wi is an\nelement of X. Consider the |w1| + |w2| + ... + |wk| cyclic shifts of the\nstring. Let m be the number of these cyclic shifts of the string that are\nelements of SX. A message is good if and only if m is exactly equal to k. The\nlist X is called stable if and only if every element of SX is good. Let f(L)\nbe 1 if L is a stable list, and 0 otherwise. Find the sum of f(L) where L is a\nnonempty contiguous sublist of A (there are contiguous sublists in total).\nInput The first line of input will contain a single integer n (1 \u2264 n \u2264 30),\ndenoting the number of strings in the list. The next n lines will each contain\na string si (). Output Print a single integer, the number of nonempty\ncontiguous sublists that are stable. Examples Input 4 a ab b bba Output 7\nInput 5 hh ee ll ll oo Output 0 Input 6 aab ab bba b ab c Output 13 Note For\nthe first sample, there are 10 sublists to consider. Sublists [\"a\", \"ab\",\n\"b\"], [\"ab\", \"b\", \"bba\"], and [\"a\", \"ab\", \"b\", \"bba\"] are not stable. The\nother seven sublists are stable. For example, X = [\"a\", \"ab\", \"b\"] is not\nstable, since the message \"ab\" + \"ab\" = \"abab\" has four cyclic shifts [\"abab\",\n\"baba\", \"abab\", \"baba\"], which are all elements of SX.\n\n",
        "cf_contest_id": 744,
        "cf_index": "E",
        "cf_rating": 3200,
        "difficulty": 0,
        "cf_tags": [
            "strings",
            "two pointers"
        ],
        "time_limit_seconds": 5.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "4\r\na\r\nab\r\nb\r\nbba\r\n",
                "7\r\n"
            ],
            [
                "5\r\nhh\r\nee\r\nll\r\nll\r\noo\r\n",
                "0\r\n"
            ],
            [
                "6\r\naab\r\nab\r\nbba\r\nb\r\nab\r\nc\r\n",
                "13\r\n"
            ]
        ],
        "private_cases": [
            [
                "30\r\nto\r\nno\r\nfh\r\nfa\r\ngk\r\ngj\r\nmu\r\njh\r\naht\r\nfo\r\ngz\r\nvz\r\nwo\r\nxi\r\ncb\r\njy\r\nhe\r\nhq\r\nbc\r\nby\r\ncp\r\neb\r\nms\r\nvr\r\niz\r\nlc\r\naj\r\npy\r\nou\r\ncr\r\n",
                "285\r\n"
            ],
            [
                "30\r\nfr\r\ntv\r\nenj\r\nxj\r\nqj\r\nhd\r\ngl\r\nyh\r\nls\r\ndk\r\nvv\r\nap\r\nhb\r\npy\r\nqv\r\nee\r\nzv\r\nqn\r\nru\r\nfk\r\nuu\r\nemr\r\nep\r\nxl\r\nvm\r\nwu\r\nlf\r\npr\r\nnw\r\nbee\r\n",
                "120\r\n"
            ],
            [
                "30\r\nrr\r\nzc\r\ncs\r\nnu\r\nsyr\r\ngm\r\nug\r\noe\r\noq\r\neg\r\nju\r\nfc\r\nsr\r\nip\r\nemc\r\nms\r\njr\r\nno\r\nmc\r\nxp\r\nxx\r\nxc\r\nrq\r\nce\r\nqc\r\nsp\r\nly\r\nfra\r\nqug\r\nuh\r\n",
                "235\r\n"
            ],
            [
                "30\r\nesg\r\njx\r\nyf\r\nre\r\nga\r\nev\r\ngd\r\nfz\r\nsp\r\nca\r\nzq\r\nip\r\nbe\r\nai\r\nuf\r\nxrg\r\nay\r\nle\r\ncs\r\njg\r\nzz\r\nil\r\ndq\r\njy\r\nkt\r\nnk\r\nnp\r\nwsr\r\nnm\r\nkkz\r\n",
                "255\r\n"
            ],
            [
                "30\r\nqv\r\nkpk\r\ndp\r\nnb\r\nohe\r\ndk\r\nyvi\r\nnr\r\npmc\r\nua\r\nus\r\nwe\r\nxtq\r\nui\r\nfu\r\nia\r\ngp\r\nol\r\nzl\r\nqs\r\nni\r\nsd\r\nsm\r\nva\r\nqn\r\nkw\r\nrx\r\nnu\r\nsig\r\nwa\r\n",
                "465\r\n"
            ],
            [
                "30\r\new\r\now\r\nxi\r\nlky\r\nwo\r\nbm\r\nhw\r\nlp\r\namn\r\nrs\r\nli\r\nrw\r\nhz\r\nri\r\nqf\r\nhn\r\nfo\r\ngj\r\nmzx\r\nln\r\ngk\r\nge\r\nqbj\r\nwor\r\nlb\r\nij\r\nfmd\r\nwq\r\nsq\r\nqu\r\n",
                "413\r\n"
            ],
            [
                "30\r\nqz\r\nud\r\nwo\r\nbh\r\nre\r\nva\r\nnv\r\nzc\r\nhc\r\npa\r\nms\r\nrx\r\nhf\r\ngb\r\ngj\r\nln\r\ncj\r\ngf\r\nep\r\nsp\r\nmz\r\nsin\r\nbo\r\nuz\r\niw\r\noxu\r\nqq\r\nut\r\nlx\r\nbf\r\n",
                "357\r\n"
            ],
            [
                "30\r\nca\r\nak\r\nut\r\nsc\r\nxme\r\nyg\r\nho\r\nsh\r\ngm\r\nyh\r\ngg\r\ndu\r\nqk\r\nua\r\nxb\r\niu\r\nbm\r\nod\r\neu\r\nrg\r\noo\r\nky\r\nyb\r\nyg\r\nas\r\nar\r\niq\r\nqk\r\nbf\r\nhl\r\n",
                "145\r\n"
            ],
            [
                "30\r\nod\r\net\r\nuy\r\njz\r\ndt\r\nsx\r\net\r\ngk\r\ntlk\r\nxc\r\nvdk\r\nhm\r\nyn\r\nrw\r\nvi\r\nai\r\nal\r\nad\r\nmu\r\nsi\r\nss\r\njj\r\nnq\r\nls\r\nmv\r\nlh\r\nsa\r\nbu\r\nyo\r\nvm\r\n",
                "243\r\n"
            ],
            [
                "30\r\nmi\r\nduz\r\nff\r\naz\r\nwl\r\ntt\r\nxk\r\nvd\r\nyf\r\nij\r\nlp\r\nom\r\njus\r\nnn\r\nrf\r\nue\r\nea\r\nug\r\nab\r\nlw\r\nba\r\nrg\r\nlw\r\nnp\r\nls\r\nmd\r\nmak\r\ntp\r\nwj\r\nck\r\n",
                "120\r\n"
            ],
            [
                "30\r\nbc\r\nbabca\r\nccba\r\nabaa\r\nbccbc\r\ncbb\r\nca\r\nbb\r\nbccb\r\ncbba\r\nbbcb\r\ncabcc\r\nbbacb\r\nbaaa\r\nacac\r\nbab\r\nccc\r\nca\r\nbabbb\r\naca\r\nacaba\r\naacc\r\nbbbb\r\ncbaaa\r\naa\r\nccabb\r\ncb\r\nab\r\nba\r\naa\r\n",
                "73\r\n"
            ],
            [
                "2\r\naccabbaccbaaaaabbbcccbbbacabbbabcccbbcaacaacbabccbcbcacabcaccabbccbcaaaababcbaccbbababbbacabcbcbcaabacabaacbcbcaababcbabbabaabacababbcacaaabbcacbabbbbbcbbaccbbabbcaaabbbaccbcbbaaacbbccabababbbbbcaaccacbacccbabcaabacbccbbbccccccaaccaccbcbcbcabbbcbcabacbcacbbbcaaccccbbbabbaaccbaabababbc\r\nbcbbbcbccabaaccaabcacccabcabaaabbcabcaabcacacacaaaacacaaaabcaabccababbccbacaabbabcbcccacabccaaababacacabacabcbcccbaccabbcbcbbcbcbabcabcaccccaccaababaaababcacacaabbbaabacaccaccccbccaacbabacbbaaaabcbbabbabaaccbcacccba\r\n",
                "3\r\n"
            ],
            [
                "30\r\na\r\nbcaac\r\ncca\r\nbabcc\r\ncbca\r\naa\r\ncac\r\ncb\r\nbb\r\nbbcb\r\nbc\r\nbcbb\r\nbabcc\r\nbab\r\ncc\r\ncabac\r\nacbc\r\nacb\r\nbbbcc\r\nbcbc\r\nabcb\r\nbba\r\nbbaa\r\ncbaaa\r\nb\r\ncaa\r\nbca\r\nbb\r\nabc\r\ncbac\r\n",
                "69\r\n"
            ],
            [
                "30\r\nccccb\r\ncbabc\r\nbcbbbca\r\naabbb\r\nbbbbacbaa\r\nccbabcbccac\r\nababbb\r\nabaabcbca\r\nbcbbbcc\r\nbaacbababbca\r\nacaaaaaaaa\r\naccacbcc\r\nccbacabbb\r\nccabcabcbba\r\ncaacbbcbcabc\r\nbcbcbbcbcaab\r\ncbcaabbabb\r\nbabaaacacb\r\nabaaaaca\r\naaaaaccaacca\r\naccbabcb\r\nbaccab\r\naaccbaab\r\nacbbaaaba\r\ncba\r\naabcbb\r\nabbbbacabcc\r\nccba\r\ncbcca\r\nabacbacbcaba\r\n",
                "465\r\n"
            ],
            [
                "30\r\nkg\r\nk\r\nggkg\r\nk\r\ngggkgg\r\ngkg\r\ngk\r\nkgg\r\nkg\r\nggk\r\ngkg\r\nggggk\r\nggkgg\r\ngkggg\r\nkgg\r\ngkg\r\ngkg\r\ngkg\r\ngkg\r\ngk\r\ngkgg\r\ngkggg\r\ngkggg\r\nkg\r\nggggk\r\nggggk\r\nk\r\ngkg\r\nggggk\r\ngkg\r\n",
                "82\r\n"
            ],
            [
                "7\r\nbc\r\ndd\r\ncc\r\nda\r\nbb\r\nbb\r\naa\r\n",
                "2\r\n"
            ],
            [
                "7\r\ncaa\r\ndd\r\ncd\r\ndc\r\naa\r\ndb\r\ncb\r\n",
                "6\r\n"
            ],
            [
                "7\r\ncc\r\nad\r\nbca\r\nbba\r\nbd\r\nccc\r\ndd\r\n",
                "10\r\n"
            ],
            [
                "7\r\ndd\r\nda\r\ndd\r\ndab\r\ndd\r\ndd\r\ncc\r\n",
                "2\r\n"
            ],
            [
                "7\r\nab\r\nba\r\nbda\r\nda\r\nca\r\nba\r\naa\r\n",
                "16\r\n"
            ],
            [
                "7\r\nbd\r\naa\r\ndd\r\ndc\r\nbc\r\nbd\r\nbc\r\n",
                "11\r\n"
            ],
            [
                "7\r\nca\r\nda\r\nbd\r\nda\r\ncb\r\ndb\r\nba\r\n",
                "22\r\n"
            ],
            [
                "7\r\ncc\r\nbb\r\ndd\r\ndd\r\ncaa\r\ncc\r\ncc\r\n",
                "1\r\n"
            ],
            [
                "7\r\nda\r\nab\r\nad\r\ndc\r\ndab\r\nad\r\nda\r\n",
                "18\r\n"
            ],
            [
                "7\r\nbbd\r\ncd\r\nca\r\nba\r\naa\r\ncc\r\ndb\r\n",
                "11\r\n"
            ],
            [
                "1\r\nlj\r\n",
                "1\r\n"
            ],
            [
                "2\r\nma\r\ndlm\r\n",
                "3\r\n"
            ],
            [
                "3\r\nlu\r\nka\r\nqnh\r\n",
                "6\r\n"
            ],
            [
                "4\r\nlo\r\nrn\r\nag\r\nxg\r\n",
                "10\r\n"
            ],
            [
                "5\r\nmh\r\nvcu\r\nbl\r\nze\r\nmh\r\n",
                "15\r\n"
            ],
            [
                "6\r\nlb\r\ncqg\r\nuo\r\nqj\r\nna\r\nxw\r\n",
                "21\r\n"
            ],
            [
                "7\r\nnv\r\nif\r\neno\r\nim\r\nou\r\nda\r\nqwa\r\n",
                "28\r\n"
            ],
            [
                "8\r\nmp\r\nns\r\npg\r\nlzp\r\noo\r\njg\r\npi\r\nan\r\n",
                "16\r\n"
            ],
            [
                "9\r\nli\r\nuh\r\nyz\r\nnr\r\nhp\r\nnq\r\nao\r\nic\r\nnmn\r\n",
                "45\r\n"
            ],
            [
                "10\r\ncv\r\ngj\r\nwl\r\ngk\r\nzz\r\nct\r\noq\r\npn\r\nhb\r\nbe\r\n",
                "25\r\n"
            ],
            [
                "11\r\nfc\r\nso\r\nhj\r\nsn\r\nys\r\nwl\r\nxt\r\npw\r\nrx\r\nyj\r\nxoq\r\n",
                "66\r\n"
            ],
            [
                "12\r\nkj\r\nfu\r\nvf\r\ncq\r\nwn\r\npg\r\nfw\r\npf\r\nev\r\nuo\r\nle\r\nrhf\r\n",
                "78\r\n"
            ],
            [
                "13\r\npq\r\nry\r\ngb\r\not\r\nwf\r\njbq\r\nzh\r\noek\r\njl\r\nsk\r\nvr\r\ndc\r\nfgg\r\n",
                "91\r\n"
            ],
            [
                "14\r\nsx\r\nef\r\ntx\r\naw\r\nvy\r\ncu\r\ntbs\r\nyd\r\nrg\r\nyc\r\nfx\r\ntb\r\nql\r\nny\r\n",
                "105\r\n"
            ],
            [
                "15\r\nxe\r\nqj\r\nft\r\nnz\r\ntt\r\nvoi\r\ngg\r\nhc\r\npf\r\ndm\r\nsyc\r\nzpe\r\nqva\r\nxq\r\nne\r\n",
                "47\r\n"
            ],
            [
                "16\r\ncl\r\ndq\r\nsp\r\nxc\r\nul\r\npjf\r\njt\r\nqb\r\nld\r\niw\r\ngc\r\ngx\r\nzx\r\njl\r\nzq\r\nwf\r\n",
                "136\r\n"
            ],
            [
                "17\r\nfs\r\npu\r\ngl\r\njd\r\nse\r\ngc\r\nql\r\nvza\r\njc\r\nng\r\nvd\r\nbv\r\nqd\r\nhq\r\nefh\r\ndd\r\nxlw\r\n",
                "121\r\n"
            ],
            [
                "18\r\nkzu\r\nbx\r\nhs\r\ngv\r\nxq\r\nwx\r\nos\r\njz\r\nhz\r\nsq\r\njf\r\ntt\r\nhlh\r\nwo\r\nuz\r\nbh\r\nwq\r\npd\r\n",
                "87\r\n"
            ],
            [
                "19\r\nng\r\nof\r\ned\r\nhj\r\nrr\r\ntr\r\nfr\r\nws\r\nfg\r\nay\r\npw\r\nan\r\nby\r\nxd\r\nmo\r\nge\r\nmq\r\nhd\r\nsu\r\n",
                "115\r\n"
            ],
            [
                "20\r\njm\r\nkbp\r\nut\r\npe\r\ngw\r\noh\r\net\r\nmd\r\nyj\r\noh\r\ncu\r\nsc\r\ngr\r\nai\r\nov\r\ngu\r\nkod\r\nsp\r\ndd\r\nxd\r\n",
                "172\r\n"
            ],
            [
                "21\r\nmt\r\nxh\r\ndqa\r\nsj\r\nzc\r\nict\r\ngy\r\ncy\r\nho\r\nrt\r\nwu\r\ncn\r\nxe\r\npo\r\njr\r\nss\r\nnl\r\nhx\r\nxg\r\nzw\r\nxs\r\n",
                "135\r\n"
            ],
            [
                "22\r\nra\r\njm\r\nrmi\r\nvo\r\nrj\r\ndz\r\njsw\r\nbx\r\nef\r\ndn\r\nxa\r\naf\r\ndi\r\ntu\r\nyi\r\nqz\r\nmq\r\ntd\r\nqh\r\ndqw\r\ngu\r\ndr\r\n",
                "253\r\n"
            ],
            [
                "23\r\nwh\r\nws\r\nci\r\nry\r\npmo\r\nwv\r\nmf\r\noa\r\nqd\r\ndn\r\ntb\r\nzy\r\nfj\r\nua\r\nbnx\r\nqe\r\nlv\r\ngk\r\njk\r\nfj\r\nht\r\nqa\r\ndc\r\n",
                "276\r\n"
            ],
            [
                "24\r\nzr\r\nixm\r\ney\r\nzx\r\nfu\r\nqq\r\npt\r\nxa\r\noa\r\nix\r\ngc\r\nsw\r\nwp\r\ntg\r\ngc\r\nho\r\ndh\r\nct\r\ngd\r\ncjd\r\nljp\r\nwc\r\nis\r\nqv\r\n",
                "130\r\n"
            ],
            [
                "25\r\ney\r\nxd\r\nba\r\npcc\r\nxb\r\nln\r\nre\r\ngzq\r\nzm\r\nht\r\nes\r\nun\r\nxy\r\nkn\r\nrew\r\nqe\r\nhe\r\nyq\r\nod\r\nwm\r\nwm\r\nsg\r\noto\r\nug\r\nvg\r\n",
                "317\r\n"
            ],
            [
                "26\r\njf\r\njh\r\now\r\naf\r\nms\r\nhe\r\nlu\r\ncp\r\nul\r\nps\r\nij\r\nte\r\nsf\r\njo\r\nmo\r\nfu\r\ngn\r\nmi\r\npd\r\nyd\r\nrq\r\nzp\r\nhr\r\nop\r\nwj\r\nmq\r\n",
                "225\r\n"
            ],
            [
                "27\r\nmm\r\nwo\r\ncs\r\nmi\r\nll\r\nbz\r\ntx\r\nez\r\ngjv\r\nxb\r\nxjc\r\nqb\r\njj\r\nvy\r\nuk\r\nkc\r\neu\r\nim\r\nls\r\nrl\r\nzz\r\nxl\r\nsa\r\nsi\r\nou\r\ner\r\nvl\r\n",
                "83\r\n"
            ],
            [
                "28\r\nrt\r\nis\r\nno\r\nyl\r\nld\r\nut\r\nzcr\r\niy\r\nht\r\ncl\r\nkl\r\nro\r\nnp\r\nkc\r\nyl\r\nhh\r\nwbz\r\nvr\r\nev\r\nvf\r\nep\r\ngjx\r\nez\r\nxtb\r\nzas\r\nxz\r\nej\r\nae\r\n",
                "198\r\n"
            ],
            [
                "29\r\nwa\r\nvz\r\nak\r\nkov\r\nwz\r\nmz\r\nee\r\nrx\r\ndqn\r\nvt\r\nnn\r\nmoa\r\nrj\r\njz\r\nrf\r\nnz\r\nem\r\nzz\r\nyo\r\nyn\r\ncc\r\nfc\r\nka\r\nms\r\nqr\r\nid\r\ncp\r\nuk\r\ntf\r\n",
                "87\r\n"
            ],
            [
                "30\r\nqg\r\nrt\r\nob\r\nlv\r\nkn\r\nsk\r\nwp\r\nfl\r\ndv\r\nly\r\njga\r\nqw\r\nmv\r\nhoy\r\nkc\r\nzl\r\nvml\r\nff\r\nnq\r\npt\r\naj\r\nqf\r\nll\r\nin\r\nqn\r\ndo\r\nhj\r\ncx\r\ngv\r\nks\r\n",
                "191\r\n"
            ]
        ]
    }
]