[
    {
        "name": "Chiori and Doll Picking (hard version)",
        "description": "This is the hard version of the problem. The only difference between easy and\nhard versions is the constraint of \n    m\n. You can make hacks only if both\nversions are solved. Chiori loves dolls and now she is going to decorate her\nbedroom! As a doll collector, Chiori has got \n    n\n dolls. The \n    i\n-th\ndoll has a non-negative integer value \n    a_i\n (\n    a_i < 2^m\n, \n    m\n is\ngiven). Chiori wants to pick some (maybe zero) dolls for the decoration, so\nthere are \n    2^n\n different picking ways. Let \n    x\n be the bitwise-xor-sum\nof values of dolls Chiori picks (in case Chiori picks no dolls \n    x = 0\n).\nThe value of this picking way is equal to the number of \n    1\n-bits in the\nbinary representation of \n    x\n. More formally, it is also equal to the\nnumber of indices \n    0 \n    \u2264 i < m\n, such that \n    \u230a\n    x/2^i\n    \n    \u230b\n is odd. Tell her the number of picking\nways with value \n    i\n for each integer \n    i\n from \n    0\n to \n    m\n. Due\nto the answers can be very huge, print them by modulo \n    998\n     244\n     353\n.\nInput The first line contains two integers \n    n\n and \n    m\n (\n    1 \n    \u2264 n\n    \n    \u2264 2 \n    \u00b7 10^5\n, \n    0 \n    \u2264 m \n    \u2264 53\n) \u2014 the number of dolls and\nthe maximum value of the picking way. The second line contains \n    n\n\nintegers \n    a_1, a_2, \n    \u2026, a_n\n (\n    0 \n    \u2264 a_i < 2^m\n) \u2014 the values\nof dolls. Output Print \n    m+1\n integers \n    p_0, p_1, \n    \u2026, p_m\n \u2014\n\n    p_i\n is equal to the number of picking ways with value \n    i\n by modulo\n\n    998\n     244\n     353\n. Examples Input 4 4 3 5 8 14 Output 2 2 6 6 0 Input 6\n7 11 45 14 9 19 81 Output 1 2 11 20 15 10 5 0\n\n",
        "cf_contest_id": 1336,
        "cf_index": "E2",
        "cf_rating": 3500,
        "difficulty": 0,
        "cf_tags": [
            "bitmasks",
            "brute force",
            "combinatorics",
            "math"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "4 4\r\n3 5 8 14\r\n",
                "2 2 6 6 0 "
            ],
            [
                "6 7\r\n11 45 14 9 19 81\r\n",
                "1 2 11 20 15 10 5 0 "
            ]
        ],
        "private_cases": [
            [
                "1 0\r\n0\r\n",
                "2 "
            ],
            [
                "30 35\r\n11712212162 13887261936 9226451478 5810578422 4558800999 2160186631 25345435752 20420262166 16723017889 4041013095 17986671533 30276157972 27290831854 10571984774 24307466845 32173907391 15769943440 28953863917 1549581104 13064028174 1138889079 12556425529 26841655665 18139754266 5735510830 3178397383 7757108363 15850451442 11041191850 17872176930\r\n",
                "4 0 16 208 1672 9908 50904 210400 734032 2209780 5738368 13028432 26080504 46141348 72492200 101511648 126865608 141776868 141823824 126878576 101475192 72509020 46144296 26068512 13036528 5737756 2208288 736112 208904 50764 10328 1568 244 12 0 0 "
            ],
            [
                "1 1\r\n1\r\n",
                "1 1 "
            ],
            [
                "1 35\r\n0\r\n",
                "2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
            ],
            [
                "1 35\r\n11451423333\r\n",
                "1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
            ],
            [
                "10 50\r\n0 1099654150664549 718441033675586 42055009250718 42055009250718 71016353755127 1099654150664549 718441033675586 1099654150664549 718441033675586\r\n",
                "64 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 128 0 128 128 64 64 64 128 64 64 64 64 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
            ],
            [
                "6 53\r\n5882245486591721 1379345413004084 0 6786274192514637 5283233483727156 8049954074513604\r\n",
                "2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 0 2 4 6 6 10 8 4 10 4 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
            ],
            [
                "48 48\r\n68719476736 8 67108864 128 4194304 1 134217728 4294967296 4398046511104 4096 8388608 34359738368 1024 2199023255552 137438953472 1099511627776 16384 17179869184 256 140737488355328 2 524288 4 16777216 8192 512 16 8796093022208 70368744177664 8589934592 32 64 35184372088832 2097152 33554432 17592186044416 262144 536870912 32768 1073741824 268435456 2147483648 131072 65536 2048 274877906944 549755813888 1048576\r\n",
                "1 48 1128 17296 194580 1712304 12271512 73629072 377348994 678862287 551249778 633824602 789674111 267089167 168600741 182512809 813164573 884739909 691848438 146687094 112871851 483243919 819945799 145660540 318103788 145660540 819945799 483243919 112871851 146687094 691848438 884739909 813164573 182512809 168600741 267089167 789674111 633824602 551249778 678862287 377348994 73629072 12271512 1712304 194580 17296 1128 48 1 "
            ],
            [
                "48 48\r\n1 1048575 262143 8796093022207 68719476735 32767 4294967295 70368744177663 511 16383 15 1099511627775 63 4398046511103 1023 17179869183 33554431 134217727 4095 524287 536870911 8388607 2097151 3 549755813887 268435455 16777215 2199023255551 8589934591 127 255 8191 1073741823 17592186044415 140737488355327 34359738367 274877906943 7 31 131071 67108863 2147483647 137438953471 4194303 35184372088831 2047 65535 281474976710655\r\n",
                "1 48 1128 17296 194580 1712304 12271512 73629072 377348994 678862287 551249778 633824602 789674111 267089167 168600741 182512809 813164573 884739909 691848438 146687094 112871851 483243919 819945799 145660540 318103788 145660540 819945799 483243919 112871851 146687094 691848438 884739909 813164573 182512809 168600741 267089167 789674111 633824602 551249778 678862287 377348994 73629072 12271512 1712304 194580 17296 1128 48 1 "
            ],
            [
                "48 49\r\n3 513 4097 4194305 65537 33 1024 1073741824 17592186044416 8193 8388609 32769 70368744177664 16 35184372088832 2097153 549755813889 2147483649 536870912 131072 65 34359738369 8589934593 524288 16777217 8796093022208 33554432 274877906944 262145 4398046511104 2049 17179869185 281474976710656 4 68719476736 140737488355328 128 257 268435456 8 1048576 137438953473 67108865 4294967297 2199023255553 1099511627777 134217729 16384\r\n",
                "1 22 582 9262 105946 952974 6992238 42952998 225485568 28972761 115953414 592567220 212551104 528323119 218066912 175623237 996454565 349846053 290095777 418997738 627537297 298768485 653231823 980704406 230294942 233469386 983146286 649957895 297347285 630266001 419537794 288248217 349814076 997467170 175490313 217622996 528440159 212703256 592507160 115914298 28994167 225492498 42947586 6991578 953910 105930 9162 594 27 0 "
            ],
            [
                "48 49\r\n1 134217727 3 15 7 2147483647 16383 2047 4398046511103 511 255 8589934591 2097151 137438953471 16777215 17592186044415 63 68719476735 33554431 31 281474976710655 67108863 1048575 32767 1073741823 1023 8191 1099511627775 17179869183 536870911 34359738367 70368744177663 127 8796093022207 262143 524287 4194303 2199023255551 268435455 4294967295 140737488355327 549755813887 274877906943 131071 4095 8388607 35184372088831 65535\r\n",
                "1 48 1128 17296 194580 1712304 12271512 73629072 377348994 678862287 551249778 633824602 789674111 267089167 168600741 182512809 813164573 884739909 691848438 146687094 112871851 483243919 819945799 145660540 318103788 145660540 819945799 483243919 112871851 146687094 691848438 884739909 813164573 182512809 168600741 267089167 789674111 633824602 551249778 678862287 377348994 73629072 12271512 1712304 194580 17296 1128 48 1 0 "
            ],
            [
                "54 53\r\n8192 2147483648 134217728 8589934592 64 131072 137438953472 67108864 16384 536870912 256 4096 1099511627776 549755813888 32768 2 1048576 8 4194304 4294967296 262144 268435456 8388608 140737488355328 1073741824 4398046511104 512 2199023255552 2048 281474976710656 16777216 70368744177664 1 1125899906842624 1024 562949953421312 524288 16 17179869184 8796093022208 2097152 68719476736 32 2251799813685248 33554432 17592186044416 274877906944 128 4503599627370496 35184372088832 4 65536 2 34359738368\r\n",
                "2 106 2756 46852 585650 5739370 45914960 308286160 774401067 877272276 66669473 714364464 503786918 744198135 415004352 679713574 366514297 210505027 421010054 407770601 793034457 390558987 386586826 304042167 629613797 890071101 574597973 574597973 890071101 629613797 304042167 386586826 390558987 793034457 407770601 421010054 210505027 366514297 679713574 415004352 744198135 503786918 714364464 66669473 877272276 774401067 308286160 45914960 5739370 585650 46852 2756 106 2 "
            ],
            [
                "1 52\r\n551145141919810\r\n",
                "1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
            ]
        ]
    }
]