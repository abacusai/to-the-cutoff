[
    {
        "name": "Balance Addicts",
        "description": "Given an integer sequence \n    a_1, a_2, \n    \u2026, a_n\n of length \n    n\n, your\ntask is to compute the number, modulo \n    998244353\n, of ways to partition it\ninto several non-empty continuous subsequences such that the sums of elements\nin the subsequences form a balanced sequence. A sequence \n    s_1, s_2, \n    \u2026,\n    s_k\n of length \n    k\n is said to be balanced, if \n    s_i = s_k-i+1\n\nfor every \n    1 \n    \u2264 i \n    \u2264 k\n. For example, \n    [1, 2, 3, 2, 1]\n and\n\n    [1,3,3,1]\n are balanced, but \n    [1,5,15]\n is not. Formally, every\npartition can be described by a sequence of indexes \n    i_1, i_2, \n    \u2026,\n    i_k\n of length \n    k\n with \n    1 = i_1 < i_2 < \n    \u2026 < i_k \n    \u2264 n\n\nsuch that \n    k\n is the number of non-empty continuous subsequences in the\npartition; For every \n    1 \n    \u2264 j \n    \u2264 k\n, the \n    j\n-th continuous\nsubsequence starts with \n    a_i_j\n, and ends exactly before\n\n    a_i_j+1\n, where \n    i_k+1 = n + 1\n. That is, the \n    j\n-th\nsubsequence is \n    a_i_j, a_i_j+1, \n    \u2026, a_i_j+1-1\n. There are\n\n    2^n-1\n different partitions in total. Let \n    s_1, s_2, \n    \u2026, s_k\n\ndenote the sums of elements in the subsequences with respect to the partition\n\n    i_1, i_2, \n    \u2026, i_k\n. Formally, for every \n    1 \n    \u2264 j \n    \u2264 k\n,\n\n    \n\n    s_j = \n    \u2211_i=i_j^i_j+1-1 a_i = a_i_j + a_i_j+1 + \n    \u2026\n    + a_i_j+1-1.\n\n    \n For example, the partition\n\n    [1\n     |\n     2,3\n     |\n     4,5,6]\n of sequence \n    [1,2,3,4,5,6]\n is\ndescribed by the sequence \n    [1,2,4]\n of indexes, and the sums of elements\nin the subsequences with respect to the partition is \n    [1,5,15]\n. Two\npartitions \n    i_1, i_2, \n    \u2026, i_k\n and \n    i'_1, i'_2, \n    \u2026, i'_k'\n\n(described by sequences of indexes) are considered to be different, if at\nleast one of the following holds. \n    k \n    \u2260 k'\n, \n    i_j \n    \u2260 i'_j\n for\nsome \n    1 \n    \u2264 j \n    \u2264\n    min\n    \n    \n     k, k'\n. Input\nEach test contains multiple test cases. The first line contains an integer\n\n    t\n (\n    1 \n    \u2264 t \n    \u2264 10^5\n) \u2014 the number of test cases. The\nfollowing lines contain the description of each test case. The first line of\neach test case contains an integer \n    n\n (\n    1 \n    \u2264 n \n    \u2264 10^5\n),\nindicating the length of the sequence \n    a\n. The second line of each test\ncase contains \n    n\n integers \n    a_1, a_2, \n    \u2026, a_n\n (\n    0 \n    \u2264 a_i\n    \n    \u2264 10^9\n), indicating the elements of the sequence \n    a\n. It is\nguaranteed that the sum of \n    n\n over all test cases does not exceed\n\n    10^5\n. Output For each test case, output the number of partitions with\nrespect to which the sum of elements in each subsequence is balanced, modulo\n\n    998244353\n. Example Input 6 1 1000000000 2 1 1 4 0 0 1 0 5 1 2 3 2 1 5 1\n3 5 7 9 32 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nOutput 1 2 3 4 2 150994942 Note For the first test case, there is only one way\nto partition a sequence of length \n    1\n, which is itself and is, of course,\nbalanced. For the second test case, there are \n    2\n ways to partition it:\nThe sequence \n    [1, 1]\n itself, then \n    s = [2]\n is balanced; Partition\ninto two subsequences \n    [1\n     |\n     1]\n, then \n    s = [1, 1]\n is balanced.\nFor the third test case, there are \n    3\n ways to partition it: The sequence\n\n    [0, 0, 1, 0]\n itself, then \n    s = [1]\n is balanced; \n    [0 \n     |\n      0,\n    1 \n     |\n      0]\n, then \n    s = [0, 1, 0]\n is balanced; \n    [0, 0 \n     |\n      1\n    \n     |\n      0]\n, then \n    s = [0, 1, 0]\n is balanced. For the fourth test\ncase, there are \n    4\n ways to partition it: The sequence \n    [1, 2, 3, 2,\n    1]\n itself, then \n    s = [9]\n is balanced; \n    [1, 2 \n     |\n      3 \n     |\n     \n    2, 1]\n, then \n    s = [3, 3, 3]\n is balanced; \n    [1 \n     |\n      2, 3, 2\n    \n     |\n      1]\n, then \n    s = [1, 7, 1]\n is balanced; \n    [1 \n     |\n      2\n    \n     |\n      3 \n     |\n      2 \n     |\n      1]\n, then \n    s = [1, 2, 3, 2, 1]\n is\nbalanced. For the fifth test case, there are \n    2\n ways to partition it: The\nsequence \n    [1, 3, 5, 7, 9]\n itself, then \n    s = [25]\n is balanced; \n    [1,\n    3, 5 \n     |\n      7 \n     |\n      9]\n, then \n    s = [9, 7, 9]\n is balanced. For\nthe sixth test case, every possible partition should be counted. So the answer\nis \n    2^32-1\n    \u2261 150994942 \n    998244353\n.\n\n",
        "cf_contest_id": 1738,
        "cf_index": "E",
        "cf_rating": 2300,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "dp",
            "math",
            "two pointers"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "6\r\n1\r\n1000000000\r\n2\r\n1 1\r\n4\r\n0 0 1 0\r\n5\r\n1 2 3 2 1\r\n5\r\n1 3 5 7 9\r\n32\r\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\r\n",
                "1\r\n2\r\n3\r\n4\r\n2\r\n150994942\r\n"
            ]
        ],
        "private_cases": []
    }
]