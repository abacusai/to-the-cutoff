[
    {
        "name": "An unavoidable detour for home",
        "description": "Those unwilling to return home from a long journey, will be affected by the\noddity of the snail and lose their way. Mayoi, the oddity's carrier, wouldn't\nlike this to happen, but there's nothing to do with this before a cure is\nfigured out. For now, she would only like to know the enormous number of\npossibilities to be faced with if someone gets lost. There are n towns in the\nregion, numbered from 1 to n. The town numbered 1 is called the capital. The\ntraffic network is formed by bidirectional roads connecting pairs of towns. No\ntwo roads connect the same pair of towns, and no road connects a town with\nitself. The time needed to travel through each of the roads is the same. Lost\ntravelers will not be able to find out how the towns are connected, but the\nresidents can help them by providing the following facts: Starting from each\ntown other than the capital, the shortest path (i.e. the path passing through\nthe minimum number of roads) to the capital exists, and is unique; Let li be\nthe number of roads on the shortest path from town i to the capital, then li \u2265\nli - 1 holds for all 2 \u2264 i \u2264 n; For town i, the number of roads connected to\nit is denoted by di, which equals either 2 or 3. You are to count the number\nof different ways in which the towns are connected, and give the answer modulo\n10^9 + 7. Two ways of connecting towns are considered different if a pair (u,\nv) (1 \u2264 u, v \u2264 n) exists such there is a road between towns u and v in one of\nthem but not in the other. Input The first line of input contains a positive\ninteger n (3 \u2264 n \u2264 50) \u2014 the number of towns. The second line contains n\nspace-separated integers d1, d2, ..., dn (2 \u2264 di \u2264 3) \u2014 the number of roads\nconnected to towns 1, 2, ..., n, respectively. It is guaranteed that the sum\nof di over all i is even. Output Output one integer \u2014 the total number of\ndifferent possible ways in which the towns are connected, modulo 10^9 + 7.\nExamples Input 4 3 2 3 2 Output 1 Input 5 2 3 3 2 2 Output 2 Input 5 2 2 2 2 2\nOutput 2 Input 20 2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 3 3 2 Output 82944 Note In\nthe first example, the following structure is the only one to satisfy the\nconstraints, the distances from towns 2, 3, 4 to the capital are all 1. In the\nsecond example, the following two structures satisfy the constraints.\n\n",
        "cf_contest_id": 814,
        "cf_index": "E",
        "cf_rating": 2600,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "dp",
            "graphs",
            "shortest paths"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "4\r\n3 2 3 2\r\n",
                "1\r\n"
            ],
            [
                "5\r\n2 3 3 2 2\r\n",
                "2\r\n"
            ],
            [
                "5\r\n2 2 2 2 2\r\n",
                "2\r\n"
            ],
            [
                "20\r\n2 2 2 2 3 2 3 2 2 2 2 2 2 2 2 2 2 3 3 2\r\n",
                "82944\r\n"
            ]
        ],
        "private_cases": [
            [
                "10\r\n2 3 3 2 2 3 2 3 3 3\r\n",
                "174\r\n"
            ],
            [
                "10\r\n3 2 2 2 2 3 3 3 2 2\r\n",
                "90\r\n"
            ],
            [
                "30\r\n3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\r\n",
                "253834198\r\n"
            ],
            [
                "50\r\n3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\r\n",
                "897520452\r\n"
            ],
            [
                "49\r\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\r\n",
                "8388608\r\n"
            ],
            [
                "50\r\n3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 2 3 2 2 2 2 3 2 2 3 3 2 2 2 2 2 3 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2\r\n",
                "625963067\r\n"
            ],
            [
                "50\r\n2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3\r\n",
                "605928958\r\n"
            ],
            [
                "50\r\n2 2 2 2 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 3 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 2 2 2\r\n",
                "572404299\r\n"
            ],
            [
                "50\r\n3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3\r\n",
                "820793400\r\n"
            ],
            [
                "3\r\n2 2 2\r\n",
                "1\r\n"
            ],
            [
                "3\r\n2 3 3\r\n",
                "0\r\n"
            ],
            [
                "3\r\n3 3 2\r\n",
                "0\r\n"
            ],
            [
                "8\r\n3 2 3 2 3 2 3 2\r\n",
                "24\r\n"
            ],
            [
                "8\r\n3 3 2 3 2 3 2 2\r\n",
                "2\r\n"
            ],
            [
                "15\r\n3 3 3 3 3 2 3 2 3 2 3 2 3 2 3\r\n",
                "2948400\r\n"
            ],
            [
                "50\r\n2 2 3 2 2 3 3 3 3 2 2 2 3 3 2 3 2 3 2 3 2 3 3 3 2 3 3 3 3 3 2 2 2 2 2 2 2 3 3 2 3 2 2 3 3 2 2 2 2 3\r\n",
                "703208053\r\n"
            ],
            [
                "50\r\n2 3 2 2 3 3 2 2 2 3 2 3 3 3 3 3 2 3 3 2 3 2 3 2 2 3 2 2 2 3 2 3 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3\r\n",
                "434156356\r\n"
            ],
            [
                "50\r\n2 3 2 2 2 2 3 2 2 3 2 3 3 2 2 2 2 3 3 3 2 2 2 3 3 2 3 3 3 3 2 2 3 2 2 2 3 3 3 3 3 3 2 3 3 3 3 3 2 2\r\n",
                "540587735\r\n"
            ],
            [
                "50\r\n3 3 3 3 3 3 3 3 2 3 3 2 3 2 3 2 3 2 2 2 2 2 3 2 2 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2\r\n",
                "11747611\r\n"
            ],
            [
                "50\r\n3 3 3 3 3 3 3 3 3 3 2 3 2 2 3 3 3 2 3 2 2 2 2 2 3 2 2 3 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\r\n",
                "684567833\r\n"
            ],
            [
                "50\r\n2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 2 2 3 3 3 3 2 3 3 3 3 3 3 3 3 2 2 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3\r\n",
                "807598887\r\n"
            ],
            [
                "50\r\n2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 3 3 3 2 3 3 3 3 3 2 2 3 3 3 3 3 3 3 2 3 3 3 3 2 3 3 2 3 2 3 3 3 3\r\n",
                "803634890\r\n"
            ],
            [
                "50\r\n2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\r\n",
                "872305797\r\n"
            ],
            [
                "50\r\n2 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2\r\n",
                "786639413\r\n"
            ],
            [
                "50\r\n3 2 2 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 2 3 3 3 3 2 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 2 3 3\r\n",
                "879153557\r\n"
            ],
            [
                "50\r\n3 3 3 3 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 3 2 2 3 3 3 3 3 3 2 3 3\r\n",
                "238531584\r\n"
            ],
            [
                "3\r\n3 2 3\r\n",
                "0\r\n"
            ],
            [
                "4\r\n3 3 2 2\r\n",
                "1\r\n"
            ],
            [
                "5\r\n3 3 2 3 3\r\n",
                "0\r\n"
            ],
            [
                "6\r\n3 3 2 2 2 2\r\n",
                "5\r\n"
            ],
            [
                "7\r\n3 2 3 3 2 3 2\r\n",
                "12\r\n"
            ],
            [
                "8\r\n3 2 3 2 3 2 3 2\r\n",
                "24\r\n"
            ],
            [
                "9\r\n3 2 2 3 2 3 2 3 2\r\n",
                "15\r\n"
            ],
            [
                "10\r\n2 2 3 2 2 3 3 2 2 3\r\n",
                "72\r\n"
            ],
            [
                "47\r\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\r\n",
                "4194304\r\n"
            ],
            [
                "49\r\n3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\r\n",
                "63101281\r\n"
            ]
        ]
    }
]