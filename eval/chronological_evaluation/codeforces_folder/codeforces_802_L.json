[
    {
        "name": "Send the Fool Further! (hard)",
        "description": "Heidi is terrified by your estimate and she found it unrealistic that her\nfriends would collaborate to drive her into debt. She expects that, actually,\neach person will just pick a random friend to send Heidi to. (This randomness\nassumption implies, however, that she can now visit the same friend an\narbitrary number of times...) Moreover, if a person only has one friend in\ncommon with Heidi (i.e., if that person is in a leaf of the tree), then that\nperson will not send Heidi back (so that Heidi's travel will end at some\npoint). Heidi also found unrealistic the assumption that she can make all the\ntravels in one day. Therefore now she assumes that every time she travels a\nroute between two friends, she needs to buy a new ticket. She wants to know:\nhow much should she expect to spend on the trips? For what it's worth, Heidi\nknows that Jenny has at least two friends. Input The first line contains the\nnumber of friends n (3 \u2264 n \u2264 10^5). The next n - 1 lines each contain three\nspace-separated integers u, v and c (0 \u2264 u, v \u2264 n - 1, 1 \u2264 c \u2264 10^4) meaning\nthat u and v are friends and the cost for traveling between u and v is c (paid\nevery time!). It is again guaranteed that the social network of the input\nforms a tree. Output Assume that the expected cost of the trips is written as\nan irreducible fraction a / b (that is, a and b are coprime). Then Heidi, the\nweird cow that she is, asks you to output . (Output a single integer between 0\nand 10^9 + 6.) Examples Input 3 0 1 10 0 2 20 Output 15 Input 4 0 1 3 0 2 9 0\n3 27 Output 13 Input 7 0 1 3 0 5 7 1 2 2 1 3 1 1 4 5 5 6 8 Output 400000019\nInput 11 1 0 6646 2 0 8816 3 2 9375 4 2 5950 5 1 8702 6 2 2657 7 2 885 8 7\n2660 9 2 5369 10 6 3798 Output 153869806 Input 6 0 1 8 0 2 24 1 3 40 1 4 16 4\n5 8 Output 39 Note In the first example, with probability 1 / 2 Heidi will go\nto 1 from 0, and with probability 1 / 2 she will go to 2. In the first case\nthe cost would be 10, and in the second it would be 20. After reaching 1 or 2\nshe will stop, as 1 and 2 are leaves of the social tree. Hence, the expected\ncost she has to pay is 10\u00b71 / 2 + 20\u00b71 / 2 = 15. In the third example, the\nexpected cost is 81 / 5. You should output 400000019. In her travels, Heidi\nhas learned an intriguing fact about the structure of her social network. She\ntells you the following: The mysterious determinant that you might be\nwondering about is such that it does not cause strange errors in your\nreasonable solution... Did we mention that Heidi is a weird cow?\n\n",
        "cf_contest_id": 802,
        "cf_index": "L",
        "cf_rating": 2400,
        "difficulty": 0,
        "cf_tags": [
            "dfs and similar",
            "dp",
            "math",
            "trees"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3\r\n0 1 10\r\n0 2 20\r\n",
                "15"
            ],
            [
                "4\r\n0 1 3\r\n0 2 9\r\n0 3 27\r\n",
                "13"
            ],
            [
                "7\r\n0 1 3\r\n0 5 7\r\n1 2 2\r\n1 3 1\r\n1 4 5\r\n5 6 8\r\n",
                "400000019"
            ],
            [
                "11\r\n1 0 6646\r\n2 0 8816\r\n3 2 9375\r\n4 2 5950\r\n5 1 8702\r\n6 2 2657\r\n7 2 885\r\n8 7 2660\r\n9 2 5369\r\n10 6 3798\r\n",
                "153869806"
            ],
            [
                "100\r\n1 0 4115\r\n2 0 5932\r\n3 2 528\r\n4 0 4633\r\n5 2 2948\r\n6 3 6757\r\n7 6 5932\r\n8 5 5590\r\n9 3 5157\r\n10 7 1218\r\n11 2 1394\r\n12 0 7927\r\n13 9 7737\r\n14 2 3094\r\n15 14 4567\r\n16 10 6083\r\n17 1 9320\r\n18 6 8935\r\n19 9 6303\r\n20 5 7006\r\n21 18 1668\r\n22 6 2234\r\n23 0 5617\r\n24 0 7550\r\n25 15 949\r\n26 23 1923\r\n27 18 1569\r\n28 7 1558\r\n29 1 4381\r\n30 10 5288\r\n31 11 1764\r\n32 0 9037\r\n33 20 5395\r\n34 0 8606\r\n35 7 974\r\n36 22 7031\r\n37 1 1516\r\n38 3 1113\r\n39 6 8310\r\n40 17 6185\r\n41 2 5516\r\n42 11 7951\r\n43 36 3744\r\n44 11 2808\r\n45 31 808\r\n46 7 2053...",
                "80577145"
            ]
        ],
        "private_cases": [
            [
                "6\r\n0 1 8\r\n0 2 24\r\n1 3 40\r\n1 4 16\r\n4 5 8\r\n",
                "39"
            ]
        ]
    }
]