[
    {
        "name": "The Tree Has Fallen!",
        "description": "Recently, a tree has fallen on Bob's head from the sky. The tree has \n    n\n\nnodes. Each node \n    u\n of the tree has an integer number \n    a_u\n written\non it. But the tree has no fixed root, as it has fallen from the sky. Bob is\ncurrently studying the tree. To add some twist, Alice proposes a game. First,\nBob chooses some node \n    r\n to be the root of the tree. After that, Alice\nchooses a node \n    v\n and tells him. Bob then can pick one or more nodes from\nthe subtree of \n    v\n. His score will be the bitwise XOR of all the values\nwritten on the nodes picked by him. Bob has to find the maximum score he can\nachieve for the given \n    r\n and \n    v\n. As Bob is not a good problem-\nsolver, he asks you to help him find the answer. Can you help him? You need to\nfind the answers for several combinations of \n    r\n and \n    v\n for the same\ntree. Recall that a tree is a connected undirected graph without cycles. The\nsubtree of a node \n    u\n is the set of all nodes \n    y\n such that the simple\npath from \n    y\n to the root passes through \n    u\n. Note that \n    u\n is in\nthe subtree of \n    u\n. Input Each test contains multiple test cases. The\nfirst line contains the number of test cases \n    t\n (\n    1 \n    \u2264 t \n    \u2264\n    10^5\n). The description of the test cases follows. The first line contains\nan integer \n    n\n (\n    2\n    \u2264 n\n    \u2264 2 \n    \u00b7 10^5\n) \u2014 the number of\nnodes of the tree. The next line contains \n    n\n space-separated integers\n\n    a_1, a_2, \n    \u2026, a_n\n (\n    1\n    \u2264 a_i\n    \u2264 10^9\n) \u2014 the values\nwritten on the nodes. Each of the next \n    n-1\n lines contain two integers\n\n    u\n and \n    v\n (\n    1\n    \u2264 u, v\n    \u2264 n\n; \n    u\n    \u2260 v\n), denoting\nthere is an undirected edge between node \n    u\n and node \n    v\n. It is\nguaranteed that the given edges form a tree. The next line contains an integer\n\n    q\n (\n    1\n    \u2264 q\n    \u2264 2 \n    \u00b7 10^5\n) \u2014 the number of queries. Each\nof the next \n    q\n lines contains two integers \n    r\n and \n    v\n\n(\n    1\n    \u2264 r, v\n    \u2264 n\n) \u2014 the root node Bob defines, and the node Alice\nchooses. It is guaranteed that the sum of \n    n\n and the sum of \n    q\n over\nall test cases don't exceed \n    2 \n    \u00b7 10^5\n. Output For each test case,\nin each query, print a line containing an integer denoting the maximum score\nBob can achieve. Example Input 3 6 12 12 8 25 6 1 1 5 1 2 2 6 2 3 2 4 3 4 2 3\n5 1 2 2 3 8 1 2 4 2 2 2 1 1 2 1 1 3 3 8 7 1 2 2 3 2 2 2 2 1 Output 15 6 29 11\n3 8 11 15 3 Note In each of the below figures, the green-colored node is the\nnode picked by Bob, and the red-colored node is the node picked by Alice. The\nvalues of the nodes are placed in the blue boxes beside the nodes. Consider\nthe first example. In the first query, if we put the root node \n    4\n at the\ntop of the tree, the tree looks like the below figure: Tree with root node\n\n    4\n in the first query. The nodes in the subtree of the node \n    2\n are\n\n    [2,1,5,6,3]\n. Among them, Bob can pick node \n    3\n, node \n    5\n, and\nnode \n    6\n. His score will be \n    a_3 \n    \u2295 a_5 \n    \u2295 a_6 = 8 \n    \u2295\n    6 \n    \u2295 1 = 15\n. He can't achieve any score more than this.In the second\nquery, if the root node \n    3\n is placed at the top of the tree, the tree\nlooks like the below figure: Tree with root node \n    3\n in the second query.\nThe only node in the subtree of the node \n    5\n is \n    5\n. Bob can only pick\nthe node \n    5\n. His score will be \n    a_5 = 6\n.In the third query, if the\nroot node \n    1\n is placed at the top of the tree, the tree looks like this:\nTree with root node \n    1\n in the third query. The nodes in the subtree of\nthe node \n    2\n are \n    [2,3,6,4]\n. Among them, Bob can pick node \n    2\n,\nnode \n    3\n, and node \n    4\n. His score will be \n    a_2 \n    \u2295 a_3 \n    \u2295\n    a_4 = 12 \n    \u2295 8 \n    \u2295 25 = 29\n. He is not able to score higher than\nthat.\n\n",
        "cf_contest_id": 1778,
        "cf_index": "E",
        "cf_rating": 2500,
        "difficulty": 0,
        "cf_tags": [
            "bitmasks",
            "dfs and similar",
            "math",
            "trees"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "3\r\n6\r\n12 12 8 25 6 1\r\n1 5\r\n1 2\r\n2 6\r\n2 3\r\n2 4\r\n3\r\n4 2\r\n3 5\r\n1 2\r\n2\r\n3 8\r\n1 2\r\n4\r\n2 2\r\n2 1\r\n1 2\r\n1 1\r\n3\r\n3 8 7\r\n1 2\r\n2 3\r\n2\r\n2 2\r\n2 1\r\n",
                "15\r\n6\r\n29\r\n11\r\n3\r\n8\r\n11\r\n15\r\n3\r\n"
            ]
        ],
        "private_cases": []
    }
]