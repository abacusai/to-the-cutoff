[
    {
        "name": "GCD Counting",
        "description": "You are given a tree consisting of \n    n\n vertices. A number is written on\neach vertex; the number on vertex \n    i\n is equal to \n    a_i\n. Let's denote\nthe function \n    g(x, y)\n as the greatest common divisor of the numbers\nwritten on the vertices belonging to the simple path from vertex \n    x\n to\nvertex \n    y\n (including these two vertices). For every integer from \n    1\n\nto \n    2 \n    \u00b7 10^5\n you have to count the number of pairs \n    (x, y)\n\n\n    (1 \n    \u2264 x \n    \u2264 y \n    \u2264 n)\n such that \n    g(x, y)\n is equal to this\nnumber. Input The first line contains one integer \n    n\n \u2014 the number of\nvertices \n    (1 \n    \u2264 n \n    \u2264 2 \n    \u00b7 10^5)\n. The second line contains\n\n    n\n integers \n    a_1\n, \n    a_2\n, ..., \n    a_n\n \n    (1 \n    \u2264 a_i \n    \u2264 2\n    \n    \u00b7 10^5)\n \u2014 the numbers written on vertices. Then \n    n - 1\n lines\nfollow, each containing two integers \n    x\n and \n    y\n \n    (1 \n    \u2264 x, y\n    \n    \u2264 n, x \n     y)\n denoting an edge connecting vertex \n    x\n with vertex\n\n    y\n. It is guaranteed that these edges form a tree. Output For every\ninteger \n    i\n from \n    1\n to \n    2 \n    \u00b7 10^5\n do the following: if\nthere is no pair \n    (x, y)\n such that \n    x \n    \u2264 y\n and \n    g(x, y) = i\n,\ndon't output anything. Otherwise output two integers: \n    i\n and the number\nof aforementioned pairs. You have to consider the values of \n    i\n in\nascending order. See the examples for better understanding. Examples Input 3 1\n2 3 1 2 2 3 Output 1 4 2 1 3 1 Input 6 1 2 4 8 16 32 1 6 6 3 3 4 4 2 6 5\nOutput 1 6 2 5 4 6 8 1 16 2 32 1 Input 4 9 16 144 6 1 3 2 3 4 3 Output 1 1 2 1\n3 1 6 2 9 2 16 2 144 1\n\n",
        "cf_contest_id": 990,
        "cf_index": "G",
        "cf_rating": 2400,
        "difficulty": 0,
        "cf_tags": [
            "divide and conquer",
            "dp",
            "dsu",
            "number theory",
            "trees"
        ],
        "time_limit_seconds": 4.5,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3\r\n1 2 3\r\n1 2\r\n2 3\r\n",
                "1 4\r\n2 1\r\n3 1\r\n"
            ],
            [
                "6\r\n1 2 4 8 16 32\r\n1 6\r\n6 3\r\n3 4\r\n4 2\r\n6 5\r\n",
                "1 6\r\n2 5\r\n4 6\r\n8 1\r\n16 2\r\n32 1\r\n"
            ],
            [
                "4\r\n9 16 144 6\r\n1 3\r\n2 3\r\n4 3\r\n",
                "1 1\r\n2 1\r\n3 1\r\n6 2\r\n9 2\r\n16 2\r\n144 1\r\n"
            ]
        ],
        "private_cases": [
            [
                "3\r\n1 2 4\r\n1 2\r\n2 3\r\n",
                "1 3\r\n2 2\r\n4 1\r\n"
            ],
            [
                "1\r\n13\r\n",
                "13 1\r\n"
            ]
        ]
    }
]