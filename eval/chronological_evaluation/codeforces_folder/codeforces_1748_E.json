[
    {
        "name": "Yet Another Array Counting Problem",
        "description": "The position of the leftmost maximum on the segment \n    [l; r]\n of array \n    x\n    = [x_1, x_2, \n    \u2026, x_n]\n is the smallest integer \n    i\n such that \n    l\n    \n    \u2264 i \n    \u2264 r\n and \n    x_i = \n    max(x_l, x_l+1, \n    \u2026, x_r)\n. You\nare given an array \n    a = [a_1, a_2, \n    \u2026, a_n]\n of length \n    n\n. Find\nthe number of integer arrays \n    b = [b_1, b_2, \n    \u2026, b_n]\n of length\n\n    n\n that satisfy the following conditions: \n    1 \n    \u2264 b_i \n    \u2264 m\n for\nall \n    1 \n    \u2264 i \n    \u2264 n\n; for all pairs of integers \n    1 \n    \u2264 l \n    \u2264 r\n    \n    \u2264 n\n, the position of the leftmost maximum on the segment \n    [l; r]\n\nof the array \n    b\n is equal to the position of the leftmost maximum on the\nsegment \n    [l; r]\n of the array \n    a\n. Since the answer might be very\nlarge, print its remainder modulo \n    10^9+7\n. Input Each test contains\nmultiple test cases. The first line contains a single integer \n    t\n (\n    1\n    \n    \u2264 t \n    \u2264 10^3\n) \u2014 the number of test cases. The first line of each test\ncase contains two integers \n    n\n and \n    m\n (\n    2 \n    \u2264 n,m \n    \u2264 2 \n    \u00b7\n    10^5\n, \n    n \n    \u00b7 m \n    \u2264 10^6\n). The second line of each test case\ncontains \n    n\n integers \n    a_1,a_2,\n    \u2026,a_n\n (\n    1 \n    \u2264 a_i \n    \u2264\n    m\n) \u2014 the array \n    a\n. It is guaranteed that the sum of \n    n \n    \u00b7 m\n\nover all test cases doesn't exceed \n    10^6\n. Output For each test case print\none integer \u2014 the number of arrays \n    b\n that satisfy the conditions from\nthe statement, modulo \n    10^9+7\n. Example Input 4 3 3 1 3 2 4 2 2 2 2 2 6 9\n6 9 6 9 6 9 9 100 10 40 20 20 100 60 80 60 60 Output 8 5 11880 351025663 Note\nIn the first test case, the following \n    8\n arrays satisfy the conditions\nfrom the statement: \n    [1,2,1]\n; \n    [1,2,2]\n; \n    [1,3,1]\n;\n\n    [1,3,2]\n; \n    [1,3,3]\n; \n    [2,3,1]\n; \n    [2,3,2]\n; \n    [2,3,3]\n. In\nthe second test case, the following \n    5\n arrays satisfy the conditions from\nthe statement: \n    [1,1,1,1]\n; \n    [2,1,1,1]\n; \n    [2,2,1,1]\n;\n\n    [2,2,2,1]\n; \n    [2,2,2,2]\n.\n\n",
        "cf_contest_id": 1748,
        "cf_index": "E",
        "cf_rating": 2300,
        "difficulty": 0,
        "cf_tags": [
            "binary search",
            "data structures",
            "divide and conquer",
            "dp",
            "flows",
            "math",
            "trees"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "4\r\n3 3\r\n1 3 2\r\n4 2\r\n2 2 2 2\r\n6 9\r\n6 9 6 9 6 9\r\n9 100\r\n10 40 20 20 100 60 80 60 60\r\n",
                "8\r\n5\r\n11880\r\n351025663\r\n"
            ]
        ],
        "private_cases": [
            [
                "1\r\n5 200000\r\n5730 185073 98348 56663 67515\r\n",
                "194013276\r\n"
            ]
        ]
    }
]