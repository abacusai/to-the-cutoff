[
    {
        "name": "Johnny and Megan's Necklace",
        "description": "Johnny's younger sister Megan had a birthday recently. Her brother has bought\nher a box signed as \"Your beautiful necklace \u2014 do it yourself!\". It contains\nmany necklace parts and some magic glue. The necklace part is a chain\nconnecting two pearls. Color of each pearl can be defined by a non-negative\ninteger. The magic glue allows Megan to merge two pearls (possibly from the\nsame necklace part) into one. The beauty of a connection of pearls in colors\n\n    u\n and \n    v\n is defined as follows: let \n    2^k\n be the greatest power\nof two dividing \n    u \n    \u2295 v\n \u2014 exclusive or of \n    u\n and \n    v\n. Then\nthe beauty equals \n    k\n. If \n    u = v\n, you may assume that beauty is equal\nto \n    20\n. Each pearl can be combined with another at most once. Merging two\nparts of a necklace connects them. Using the glue multiple times, Megan can\nfinally build the necklace, which is a cycle made from connected necklace\nparts (so every pearl in the necklace is combined with precisely one other\npearl in it). The beauty of such a necklace is the minimum beauty of a single\nconnection in it. The girl wants to use all available necklace parts to build\nexactly one necklace consisting of all of them with the largest possible\nbeauty. Help her! Input The first line contains \n    n\n \n    (1 \n    \u2264 n \n    \u2264\n    5 \n    \u00b7 10^5)\n \u2014 the number of necklace parts in the box. Each of the next\n\n    n\n lines contains two integers \n    a\n and \n    b\n \n    (0 \n    \u2264 a, b <\n    2^20)\n, which denote colors of pearls presented in the necklace parts.\nPearls in the \n    i\n-th line have indices \n    2i - 1\n and \n    2i\n\nrespectively. Output The first line should contain a single integer \n    b\n\ndenoting the maximum possible beauty of a necklace built from all given parts.\nThe following line should contain \n    2n\n distinct integers \n    p_i\n \n    (1\n    \n    \u2264 p_i \n    \u2264 2n)\n \u2014 the indices of initial pearls in the order in which\nthey appear on a cycle. Indices of pearls belonging to the same necklace part\nhave to appear at neighboring positions in this permutation (so\n\n    1\n     4\n     3\n     2\n is not a valid output, whereas \n    2\n     1\n     4\n     3\n\nand \n    4\n     3\n     1\n     2\n are). If there are many possible answers, you can\nprint any. Examples Input 5 13 11 11 1 3 5 17 1 9 27 Output 3 8 7 9 10 5 6 1 2\n3 4 Input 5 13 11 11 1 3 5 17 1 7 29 Output 2 8 7 10 9 5 6 4 3 2 1 Input 1 1 1\nOutput 20 2 1 Note In the first example the following pairs of pearls are\ncombined: \n    (7, 9)\n, \n    (10, 5)\n, \n    (6, 1)\n, \n    (2, 3)\n and \n    (4,\n    8)\n. The beauties of connections equal correspondingly: \n    3\n, \n    3\n,\n\n    3\n, \n    20\n, \n    20\n. The following drawing shows this construction.\n\n",
        "cf_contest_id": 1361,
        "cf_index": "C",
        "cf_rating": 2500,
        "difficulty": 0,
        "cf_tags": [
            "binary search",
            "bitmasks",
            "constructive algorithms",
            "dfs and similar",
            "dsu",
            "graphs"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [
            [
                "5\r\n13 11\r\n11 1\r\n3 5\r\n17 1\r\n9 27\r\n",
                "3\r\n1 2 3 4 7 8 9 10 5 6 "
            ],
            [
                "5\r\n13 11\r\n11 1\r\n3 5\r\n17 1\r\n7 29\r\n",
                "2\r\n1 2 3 4 6 5 9 10 7 8 "
            ],
            [
                "1\r\n1 1\r\n",
                "20\r\n1 2 "
            ]
        ],
        "private_cases": [
            [
                "1\r\n1048575 1048575\r\n",
                "20\r\n1 2 "
            ],
            [
                "1\r\n666 666\r\n",
                "20\r\n1 2 "
            ],
            [
                "8\r\n15 10\r\n13 12\r\n4 6\r\n9 2\r\n0 14\r\n3 8\r\n5 7\r\n1 11\r\n",
                "3\r\n1 2 8 7 15 16 11 12 9 10 6 5 4 3 13 14 "
            ],
            [
                "5\r\n5 1\r\n5 0\r\n5 10\r\n6 6\r\n10 2\r\n",
                "1\r\n1 2 3 4 7 8 9 10 6 5 "
            ],
            [
                "1\r\n0 0\r\n",
                "20\r\n1 2 "
            ],
            [
                "2\r\n0 1\r\n0 1\r\n",
                "20\r\n1 2 4 3 "
            ],
            [
                "12\r\n9 11\r\n7 5\r\n8 11\r\n0 0\r\n3 4\r\n6 5\r\n2 10\r\n9 3\r\n8 2\r\n1 6\r\n7 10\r\n4 1\r\n",
                "3\r\n1 2 6 5 7 8 17 18 13 14 22 21 3 4 12 11 20 19 15 16 9 10 23 24 "
            ],
            [
                "2\r\n1048575 1048575\r\n0 0\r\n",
                "0\r\n1 2 3 4 "
            ],
            [
                "1\r\n775980 534206\r\n",
                "1\r\n1 2 "
            ],
            [
                "2\r\n2 1\r\n3 0\r\n",
                "1\r\n1 2 3 4 "
            ],
            [
                "2\r\n1 0\r\n0 1\r\n",
                "20\r\n1 2 3 4 "
            ],
            [
                "2\r\n841989 888224\r\n280745 44844\r\n",
                "2\r\n1 2 4 3 "
            ],
            [
                "4\r\n414010 587862\r\n136402 993125\r\n722703 520328\r\n169143 753063\r\n",
                "1\r\n1 2 3 4 7 8 5 6 "
            ],
            [
                "3\r\n25816 662097\r\n479395 49450\r\n116086 995812\r\n",
                "1\r\n1 2 3 4 5 6 "
            ],
            [
                "3\r\n686198 736331\r\n822385 154350\r\n558044 422722\r\n",
                "1\r\n1 2 3 4 5 6 "
            ],
            [
                "3\r\n298004 810565\r\n116799 259248\r\n1000002 898206\r\n",
                "1\r\n1 2 3 4 5 6 "
            ],
            [
                "3\r\n958386 884799\r\n459789 364148\r\n393386 325116\r\n",
                "1\r\n1 2 3 4 5 6 "
            ],
            [
                "4\r\n0 1\r\n3 7\r\n4 6\r\n5 2\r\n",
                "1\r\n1 2 3 4 7 8 5 6 "
            ],
            [
                "4\r\n3 2\r\n0 3\r\n0 1\r\n1 2\r\n",
                "20\r\n1 2 8 7 6 5 3 4 "
            ],
            [
                "6\r\n941117 166254\r\n252669 878206\r\n27948 145313\r\n1030220 425613\r\n371571 57937\r\n516099 506589\r\n",
                "4\r\n1 2 4 3 8 7 5 6 10 9 11 12 "
            ],
            [
                "16\r\n326316 577948\r\n107088 839097\r\n334500 641738\r\n299832 279203\r\n758385 145524\r\n149681 703997\r\n297457 313074\r\n142329 276711\r\n361478 859088\r\n643594 56677\r\n63882 768722\r\n427858 156135\r\n364863 406776\r\n453251 140205\r\n136015 9986\r\n906499 572891\r\n",
                "2\r\n1 2 3 4 9 10 5 6 14 13 11 12 15 16 8 7 18 17 19 20 28 27 24 23 21 22 30 29 31 32 25 26 "
            ],
            [
                "5\r\n986696 652181\r\n450081 943998\r\n776458 68644\r\n687068 263107\r\n154051 377776\r\n",
                "2\r\n1 2 3 4 5 6 7 8 9 10 "
            ],
            [
                "5\r\n598504 726417\r\n793073 322\r\n169842 544128\r\n129772 615755\r\n380687 158420\r\n",
                "2\r\n1 2 3 4 5 6 7 8 9 10 "
            ],
            [
                "5\r\n210308 800649\r\n87485 105218\r\n611802 1019612\r\n162788 773907\r\n961563 519556\r\n",
                "2\r\n1 2 3 4 5 6 7 8 9 10 "
            ],
            [
                "5\r\n870692 874885\r\n430477 210118\r\n5182 446524\r\n615842 167159\r\n447683 833406\r\n",
                "2\r\n1 2 3 4 7 8 9 10 5 6 "
            ],
            [
                "8\r\n4 7\r\n11 9\r\n0 6\r\n2 13\r\n12 10\r\n14 15\r\n5 1\r\n3 8\r\n",
                "3\r\n1 2 12 11 6 5 16 15 3 4 14 13 8 7 10 9 "
            ],
            [
                "8\r\n1 3\r\n7 5\r\n6 1\r\n4 7\r\n2 2\r\n6 0\r\n0 3\r\n4 5\r\n",
                "2\r\n1 2 3 4 6 5 9 10 11 12 7 8 14 13 15 16 "
            ],
            [
                "14\r\n142650 865488\r\n958610 104024\r\n906151 1043570\r\n639127 271290\r\n467539 705730\r\n58323 403922\r\n161214 707043\r\n306094 338635\r\n655165 229543\r\n1033605 1022055\r\n493793 519296\r\n815425 217552\r\n146476 604999\r\n1036180 540311\r\n",
                "3\r\n1 2 22 21 23 24 4 3 6 5 18 17 19 20 26 25 27 28 7 8 10 9 14 13 15 16 11 12 "
            ],
            [
                "10\r\n811208 914457\r\n569233 427370\r\n598058 25392\r\n18 52075\r\n967355 500156\r\n354940 694285\r\n585093 28094\r\n1010630 710698\r\n961725 340935\r\n276023 118421\r\n",
                "3\r\n1 2 3 4 7 8 9 10 11 12 17 18 19 20 13 14 15 16 5 6 "
            ],
            [
                "10\r\n423016 988689\r\n912225 532274\r\n1040010 500880\r\n798808 977275\r\n169651 971724\r\n173932 226789\r\n64061 355840\r\n856009 14630\r\n1044534 87879\r\n364847 833721\r\n",
                "3\r\n1 2 15 16 17 18 19 20 3 4 5 6 7 8 9 10 11 12 13 14 "
            ],
            [
                "12\r\n34824 14345\r\n206641 637170\r\n433394 976360\r\n976089 896283\r\n98627 482409\r\n537810 231452\r\n816540 277949\r\n682765 75634\r\n791875 820750\r\n557766 382147\r\n180717 515303\r\n1027359 800525\r\n",
                "3\r\n1 2 7 8 17 18 19 20 9 10 3 4 11 12 13 14 21 22 23 24 15 16 5 6 "
            ],
            [
                "10\r\n695208 88585\r\n549633 742074\r\n875354 403272\r\n404810 980459\r\n570059 1019044\r\n900764 945941\r\n684405 546770\r\n54238 940870\r\n361590 697247\r\n252871 826054\r\n",
                "2\r\n1 2 3 4 5 6 10 9 8 7 15 16 17 18 19 20 14 13 12 11 "
            ],
            [
                "16\r\n30 23\r\n20 0\r\n4 1\r\n25 18\r\n13 12\r\n28 10\r\n22 7\r\n26 27\r\n8 29\r\n21 6\r\n11 31\r\n17 3\r\n24 19\r\n15 14\r\n5 2\r\n16 9\r\n",
                "4\r\n1 2 14 13 20 19 29 30 8 7 32 31 4 3 5 6 23 24 26 25 17 18 9 10 11 12 15 16 21 22 27 28 "
            ],
            [
                "16\r\n13 5\r\n12 14\r\n10 1\r\n12 2\r\n7 1\r\n0 11\r\n6 9\r\n10 6\r\n7 11\r\n13 14\r\n4 15\r\n3 0\r\n15 3\r\n5 8\r\n9 4\r\n8 2\r\n",
                "3\r\n1 2 19 20 4 3 7 8 5 6 10 9 17 18 12 11 24 23 26 25 22 21 30 29 14 13 16 15 32 31 28 27 "
            ],
            [
                "30\r\n915241 488226\r\n838105 455106\r\n532568 833666\r\n535016 673090\r\n672814 764456\r\n77182 590456\r\n1010909 1020265\r\n381453 719129\r\n736970 246445\r\n140554 153853\r\n506977 244760\r\n688481 869656\r\n568892 341802\r\n253052 513514\r\n598144 666098\r\n887536 103026\r\n611125 184120\r\n624325 409000\r\n463823 560314\r\n4607 172682\r\n1020547 643858\r\n311427 312626\r\n452388 238076\r\n1007940 790076\r\n540086 583485\r\n37526 655261\r\n1002283 848378\r\n66955 368906\r\n681367 11407\r\n346263 370655\r\n",
                "4\r\n1 2 6 5 10 9 11 12 22 21 23 24 34 33 35 36 7 8 30 29 31 32 42 41 43 44 4 3 14 13 18 17 26 25 46 45 47 48 27 28 38 37 58 57 59 60 39 40 54 53 55 56 19 20 50 49 51 52 15 16 "
            ],
            [
                "18\r\n966960 862049\r\n1010561 265106\r\n97234 110368\r\n1017090 296243\r\n201443 818292\r\n590212 197125\r\n58069 800774\r\n571670 523367\r\n76679 309944\r\n228488 939305\r\n790873 418826\r\n66138 982802\r\n897065 876811\r\n700347 582620\r\n470860 763133\r\n431453 217694\r\n1006862 686879\r\n238319 307593\r\n",
                "4\r\n1 2 3 4 7 8 9 10 11 12 13 14 15 16 17 18 19 20 25 26 27 28 29 30 31 32 33 34 35 36 21 22 23 24 5 6 "
            ],
            [
                "21\r\n1041184 156465\r\n66897 707058\r\n572722 157520\r\n260017 86099\r\n300611 923796\r\n690132 1008565\r\n1016469 276833\r\n924163 16646\r\n220246 761639\r\n721287 94104\r\n769480 885011\r\n425377 224729\r\n866985 258442\r\n495706 802507\r\n892763 720417\r\n287609 994924\r\n93228 907101\r\n811485 384478\r\n741438 601993\r\n829964 818447\r\n917935 697084\r\n",
                "4\r\n1 2 7 8 15 16 17 18 19 20 21 22 9 10 11 12 13 14 23 24 31 32 39 40 41 42 33 34 35 36 37 38 25 26 27 28 29 30 3 4 5 6 "
            ],
            [
                "18\r\n66848 499457\r\n171793 100450\r\n1048210 204688\r\n597569 561971\r\n378339 787220\r\n495620 491541\r\n228101 558502\r\n363830 164759\r\n165495 297480\r\n748088 302633\r\n507769 916538\r\n774426 901163\r\n668379 114604\r\n904684 154305\r\n228172 78749\r\n336077 461342\r\n15614 284143\r\n820175 877116\r\n",
                "4\r\n1 2 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 29 30 31 32 33 34 35 36 27 28 3 4 5 6 "
            ],
            [
                "21\r\n141088 842449\r\n276689 542402\r\n475106 251856\r\n309345 271347\r\n433827 796692\r\n557988 714389\r\n336917 580593\r\n658294 500854\r\n726694 768839\r\n728583 359112\r\n275544 935334\r\n464454 171017\r\n811385 1048506\r\n452202 363115\r\n298955 909238\r\n964026 924268\r\n85244 613389\r\n433021 115518\r\n206910 923242\r\n560670 468879\r\n809439 510190\r\n",
                "3\r\n1 2 3 4 5 6 20 19 18 17 15 16 23 24 7 8 9 10 11 12 13 14 25 26 27 28 29 30 36 35 34 33 32 31 38 37 39 40 41 42 22 21 "
            ],
            [
                "32\r\n14 12\r\n7 5\r\n29 23\r\n8 10\r\n42 40\r\n46 32\r\n43 21\r\n35 36\r\n20 3\r\n33 9\r\n11 15\r\n50 1\r\n34 16\r\n26 37\r\n19 47\r\n39 63\r\n53 4\r\n61 51\r\n38 6\r\n24 48\r\n45 56\r\n28 54\r\n13 55\r\n30 2\r\n60 22\r\n0 25\r\n44 27\r\n58 62\r\n57 41\r\n31 17\r\n52 59\r\n49 18\r\n",
                "4\r\n1 2 43 44 37 38 50 49 53 54 13 14 4 3 6 5 35 36 15 16 17 18 29 30 22 21 62 61 34 33 28 27 8 7 10 9 55 56 11 12 26 25 23 24 19 20 57 58 52 51 40 39 42 41 45 46 31 32 59 60 63 64 48 47 "
            ],
            [
                "32\r\n16 17\r\n31 30\r\n14 21\r\n24 8\r\n17 25\r\n12 25\r\n23 6\r\n19 31\r\n14 13\r\n26 4\r\n11 2\r\n0 6\r\n1 10\r\n19 30\r\n20 26\r\n28 5\r\n15 10\r\n16 9\r\n7 29\r\n27 1\r\n8 21\r\n4 11\r\n15 2\r\n9 22\r\n28 24\r\n12 3\r\n0 29\r\n22 18\r\n27 23\r\n3 20\r\n7 18\r\n5 13\r\n",
                "4\r\n1 2 9 10 12 11 31 32 6 5 4 3 16 15 27 28 17 18 38 37 13 14 24 23 35 36 47 48 55 56 22 21 39 40 25 26 19 20 29 30 34 33 45 46 62 61 58 57 44 43 60 59 52 51 49 50 7 8 41 42 63 64 54 53 "
            ],
            [
                "64\r\n99 38\r\n120 94\r\n29 101\r\n46 88\r\n62 17\r\n22 69\r\n121 33\r\n53 19\r\n71 103\r\n108 15\r\n24 106\r\n39 4\r\n26 92\r\n107 84\r\n14 63\r\n85 104\r\n20 124\r\n122 59\r\n49 47\r\n75 95\r\n73 30\r\n79 5\r\n61 118\r\n90 37\r\n25 43\r\n126 45\r\n12 41\r\n13 111\r\n91 50\r\n40 7\r\n116 89\r\n27 67\r\n36 105\r\n78 96\r\n80 60\r\n34 86\r\n58 97\r\n74 48\r\n55 0\r\n35 102\r\n72 42\r\n44 119\r\n83 70\r\n82 8\r\n76 28\r\n93 16\r\n51 110\r\n98 6\r\n10 123\r\n81 54\r\n68 87\r\n9 65\r\n113 64\r\n32 11\r\n100 117\r\n114 2\r\n112 21\r\n3 31\r\n57 115\r\n1 56\r\n125 66\r\n23 77\r\n18 109\r\n52 127\r\n",
                "5\r\n1 2 80 79 64 63 36 35 25 26 34 33 28 27 39 40 30 29 7 8 3 4 9 10 37 38 20 19 53 54 41 42 51 52 55 56 43 44 6 5 45 46 11 12 48 47 73 74 14 13 49 50 108 107 68 67 94 93 16 15 31 32 59 60 17 18 23 24 65 66 103 104 119 120 21 22 75 76 69 70 90 89 83 84 77 78 106 105 99 100 72 71 112 111 58 57 98 97 82 81 88 87 125 126 124 123 102 101 109 110 114 113 92 91 121 122 95 96 86 85 118 117 62 61 127 128 116 115 "
            ],
            [
                "64\r\n19 36\r\n17 40\r\n12 43\r\n13 50\r\n45 52\r\n41 21\r\n52 61\r\n2 27\r\n57 9\r\n42 6\r\n47 54\r\n21 25\r\n43 11\r\n44 39\r\n42 27\r\n1 5\r\n60 3\r\n18 28\r\n33 13\r\n38 59\r\n59 53\r\n58 22\r\n49 40\r\n26 37\r\n37 35\r\n30 5\r\n4 7\r\n19 26\r\n48 34\r\n55 46\r\n4 46\r\n9 28\r\n7 49\r\n44 14\r\n24 15\r\n62 56\r\n25 34\r\n14 15\r\n1 63\r\n63 55\r\n20 56\r\n16 10\r\n23 62\r\n39 60\r\n53 30\r\n23 22\r\n32 32\r\n41 0\r\n18 20\r\n57 38\r\n45 51\r\n29 29\r\n11 12\r\n6 31\r\n33 50\r\n31 16\r\n8 51\r\n58 61\r\n3 17\r\n36 48\r\n2 0\r\n35 8\r\n24 10\r\n54 47\r\n",
                "5\r\n1 2 53 54 28 27 5 6 25 26 105 106 67 68 60 59 80 79 78 77 31 32 48 47 43 44 22 21 70 69 72 71 51 52 49 50 34 33 36 35 8 7 9 10 13 14 103 104 116 115 56 55 102 101 38 37 109 110 97 98 81 82 125 126 19 20 39 40 16 15 58 57 83 84 29 30 41 42 12 11 18 17 24 23 89 90 86 85 91 92 127 128 76 75 62 61 119 120 112 111 108 107 100 99 73 74 121 122 93 94 96 95 63 64 88 87 65 66 3 4 46 45 118 117 123 124 113 114 "
            ]
        ]
    }
]