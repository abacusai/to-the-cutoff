[
    {
        "name": "Inversion Expectation",
        "description": "A permutation of size \n    n\n is an array of size \n    n\n such that each\ninteger from \n    1\n to \n    n\n occurs exactly once in this array. An\ninversion in a permutation \n    p\n is a pair of indices \n    (i, j)\n such that\n\n    i > j\n and \n    a_i < a_j\n. For example, a permutation \n    [4, 1, 3, 2]\n\ncontains \n    4\n inversions: \n    (2, 1)\n, \n    (3, 1)\n, \n    (4, 1)\n, \n    (4,\n    3)\n. You are given a permutation \n    p\n of size \n    n\n. However, the\nnumbers on some positions are replaced by \n    -1\n. Let the valid permutation\nbe such a replacement of \n    -1\n in this sequence back to numbers from\n\n    1\n to \n    n\n in such a way that the resulting sequence is a permutation\nof size \n    n\n. The given sequence was turned into a valid permutation\nrandomly with the equal probability of getting each valid permutation.\nCalculate the expected total number of inversions in the resulting valid\npermutation. It can be shown that it is in the form of \n    P/Q\n\nwhere \n    P\n and \n    Q\n are non-negative integers and \n    Q \n     0\n.\nReport the value of \n    P \n    \u00b7 Q^-1\n    998244353\n. Input The\nfirst line contains a single integer \n    n\n (\n    1 \n    \u2264 n \n    \u2264 2 \n    \u00b7\n    10^5\n) \u2014 the length of the sequence. The second line contains \n    n\n\nintegers \n    p_1, p_2, \n    \u2026, p_n\n (\n    -1 \n    \u2264 p_i \n    \u2264 n\n, \n    p_i\n    \n     0\n) \u2014 the initial sequence. It is guaranteed that all elements not\nequal to \n    -1\n are pairwise distinct. Output Print a single integer \u2014 the\nexpected total number of inversions in the resulting valid permutation. It can\nbe shown that it is in the form of \n    P/Q\n where \n    P\n and\n\n    Q\n are non-negative integers and \n    Q \n     0\n. Report the value of\n\n    P \n    \u00b7 Q^-1\n    998244353\n. Examples Input 3 3 -1 -1 Output\n499122179 Input 2 1 2 Output 0 Input 2 -1 -1 Output 499122177 Note In the\nfirst example two resulting valid permutations are possible: \n    [3, 1, 2]\n \u2014\n\n    2\n inversions; \n    [3, 2, 1]\n \u2014 \n    3\n inversions. The expected value\nis \n    2 \n    \u00b7 1 + 3 \n    \u00b7 1/2 = 2.5\n. In the second example no\n\n    -1\n are present, thus the only valid permutation is possible \u2014 the given\none. It has \n    0\n inversions. In the third example there are two resulting\nvalid permutations \u2014 one with \n    0\n inversions and one with \n    1\n\ninversion.\n\n",
        "cf_contest_id": 1096,
        "cf_index": "F",
        "cf_rating": 2300,
        "difficulty": 0,
        "cf_tags": [
            "dp",
            "math",
            "probabilities"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3\r\n3 -1 -1\r\n",
                "499122179\r\n"
            ],
            [
                "2\r\n1 2\r\n",
                "0\r\n"
            ],
            [
                "2\r\n-1 -1\r\n",
                "499122177\r\n"
            ]
        ],
        "private_cases": [
            [
                "5\r\n-1 -1 5 -1 1\r\n",
                "499122183\r\n"
            ],
            [
                "1\r\n1\r\n",
                "0\r\n"
            ],
            [
                "1\r\n-1\r\n",
                "0\r\n"
            ],
            [
                "4\r\n-1 -1 -1 -1\r\n",
                "3\r\n"
            ],
            [
                "4\r\n3 1 4 2\r\n",
                "3\r\n"
            ],
            [
                "69\r\n-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1\r\n",
                "1173\r\n"
            ]
        ]
    }
]