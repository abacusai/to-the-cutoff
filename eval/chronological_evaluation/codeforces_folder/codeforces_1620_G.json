[
    {
        "name": "Subsequences Galore",
        "description": "For a sequence of strings \n    [t_1, t_2, \n    \u2026, t_m]\n, let's define the\nfunction \n    f([t_1, t_2, \n    \u2026, t_m])\n as the number of different strings\n(including the empty string) that are subsequences of at least one string\n\n    t_i\n. \n    f([]) = 0\n (i. e. the number of such strings for an empty\nsequence is \n    0\n). You are given a sequence of strings \n    [s_1, s_2,\n    \n    \u2026, s_n]\n. Every string in this sequence consists of lowercase Latin\nletters and is sorted (i. e., each string begins with several (maybe zero)\ncharacters a, then several (maybe zero) characters b, ..., ends with several\n(maybe zero) characters z). For each of \n    2^n\n subsequences of \n    [s_1,\n    s_2, \n    \u2026, s_n]\n, calculate the value of the function \n    f\n modulo\n\n    998244353\n. Input The first line contains one integer \n    n\n (\n    1 \n    \u2264\n    n \n    \u2264 23\n) \u2014 the number of strings. Then \n    n\n lines follow. The\n\n    i\n-th line contains the string \n    s_i\n (\n    1 \n    \u2264 |s_i| \n    \u2264 2\n    \n    \u00b7 10^4\n), consisting of lowercase Latin letters. Each string \n    s_i\n\nis sorted. Output Since printing up to \n    2^23\n integers would be really\nslow, you should do the following: For each of the \n    2^n\n subsequences\n(which we denote as \n    [s_i_1, s_i_2, \n    \u2026, s_i_k]\n), calculate\n\n    f([s_i_1, s_i_2, \n    \u2026, s_i_k])\n, take it modulo \n    998244353\n,\nthen multiply it by \n    k \n    \u00b7 (i_1 + i_2 + \n    \u2026 + i_k)\n. Print the XOR\nof all \n    2^n\n integers you get. The indices \n    i_1, i_2, \n    \u2026, i_k\n in\nthe description of each subsequences are \n    1\n-indexed (i. e. are from\n\n    1\n to \n    n\n). Examples Input 3 a b c Output 92 Input 2 aa a Output 21\nInput 2 a a Output 10 Input 2 abcd aabb Output 124 Input 3 ddd\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\naaaaaaaabbbbbbbbbbbcccccccccccciiiiiiiiiiiiiiiiiiiiiiooooooooooqqqqqqqqqqqqqqqqqqvvvvvzzzzzzzzzzzz\nOutput 15706243380\n\n",
        "cf_contest_id": 1620,
        "cf_index": "G",
        "cf_rating": 2400,
        "difficulty": 0,
        "cf_tags": [
            "bitmasks",
            "combinatorics",
            "dp"
        ],
        "time_limit_seconds": 10.0,
        "memory_limit_bytes": 1024.0,
        "public_cases": [
            [
                "3\r\na\r\nb\r\nc\r\n",
                "92"
            ],
            [
                "2\r\naa\r\na\r\n",
                "21"
            ],
            [
                "2\r\na\r\na\r\n",
                "10"
            ],
            [
                "2\r\nabcd\r\naabb\r\n",
                "124"
            ],
            [
                "3\r\nddd\r\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\r\naaaaaaaabbbbbbbbbbbcccccccccccciiiiiiiiiiiiiiiiiiiiiiooooooooooqqqqqqqqqqqqqqqqqqvvvvvzzzzzzzzzzzz\r\n",
                "15706243380"
            ]
        ],
        "private_cases": [
            [
                "1\r\nv\r\n",
                "2"
            ],
            [
                "2\r\nffhjorstx\r\ndeghhptvx\r\n",
                "4944"
            ],
            [
                "3\r\niiwx\r\nceffgnpty\r\nbvz\r\n",
                "6604"
            ],
            [
                "4\r\ndfns\r\noty\r\nhkm\r\nblqsy\r\n",
                "3389"
            ],
            [
                "5\r\negkprtwz\r\nikmmsvv\r\nddkqtx\r\nd\r\ncu\r\n",
                "2647"
            ],
            [
                "6\r\nagjlpuy\r\naatux\r\ncjmnprrs\r\nceqqv\r\nbgii\r\ndglwz\r\n",
                "4942"
            ],
            [
                "7\r\nehtwx\r\nasz\r\nadgnnsy\r\nbdhiirrtu\r\nnnpvww\r\ngiilqswzz\r\ndhlqquwxz\r\n",
                "92058"
            ],
            [
                "8\r\ndfiinnqtuy\r\ndfjkmqtvwx\r\ncgsx\r\nentwxz\r\nachimnpqs\r\neffjmnopx\r\nilmt\r\nblorsuuwxx\r\n",
                "462000"
            ],
            [
                "9\r\ndjkmnopruw\r\nccdgrs\r\nfhnnnruvw\r\nzz\r\njkm\r\nw\r\nnnq\r\nbccimtu\r\nbo\r\n",
                "717012"
            ],
            [
                "10\r\no\r\nbhkqtwx\r\naadfhmnost\r\nklz\r\nls\r\nbccijquvw\r\nghhjklsv\r\njlmouuv\r\njx\r\nggttx\r\n",
                "486984"
            ],
            [
                "11\r\ncnp\r\nabgkkmnzz\r\nelnoy\r\ndgghiknprw\r\ngkooqvxyy\r\nefmmvwx\r\nmss\r\nakq\r\nefluy\r\nfgnnswx\r\ndlms\r\n",
                "1547476"
            ],
            [
                "12\r\nbefkkmnt\r\ngi\r\ncdosxy\r\nbcx\r\nacdhlnqsss\r\nfopyz\r\nadgkmn\r\naabccgmxx\r\naaffmmsvvx\r\ngimy\r\ncm\r\nz\r\n",
                "2052956"
            ],
            [
                "13\r\naahijklr\r\ncikty\r\nv\r\nacdkors\r\naghxy\r\ne\r\nbcjlosuuwz\r\naeejlqqqv\r\ncdeinrsy\r\njkmow\r\nggoprsxz\r\ne\r\nacilsuuvz\r\n",
                "3830984"
            ],
            [
                "14\r\nlmz\r\nabc\r\nchkw\r\nbeflmprrt\r\naaijkrrs\r\nacddeehhln\r\nacijkz\r\nfknsz\r\nadfgklpquz\r\nejklqtvw\r\nabegkllqty\r\nbqw\r\ndgiilqrvxy\r\nhhiiv\r\n",
                "7423524"
            ],
            [
                "15\r\nm\r\ncghjx\r\nbp\r\ndfhhkru\r\nbdfijkkqwy\r\nadeefmq\r\nq\r\nbqu\r\nbeefhklpwx\r\ncw\r\ncqrrtwwy\r\nbddffotyy\r\ngos\r\nbflowwyyz\r\ngjx\r\n",
                "1374160"
            ],
            [
                "16\r\ne\r\nqz\r\nchmv\r\nwx\r\naabbguw\r\nmpssz\r\nmnnp\r\nnprrruvv\r\nchhipstw\r\nax\r\nadhklostv\r\njq\r\nhlnqsstv\r\nf\r\najostu\r\nefhqsty\r\n",
                "3601600"
            ],
            [
                "17\r\nborw\r\nacr\r\njj\r\neemmnoww\r\nhjjo\r\naeflx\r\nejlsv\r\ndstuu\r\naaijnsst\r\ns\r\no\r\nadmpq\r\njktvvx\r\nefiknsuuz\r\nehjkkmnoqw\r\ndffhps\r\nbbegio\r\n",
                "2454176"
            ],
            [
                "18\r\njnoq\r\nbceekmor\r\ngoqvvv\r\njwx\r\ngns\r\nvx\r\naahvw\r\nadg\r\nabcefio\r\naiirsvvv\r\nemmnnpsy\r\ngp\r\nadddfppsvx\r\naghmmnoqr\r\nbcdfijotv\r\nabchrrw\r\nbfkuwxyz\r\nbcejll\r\n",
                "2361812"
            ],
            [
                "19\r\nbbbggiou\r\nstuyz\r\nuw\r\neggjlln\r\nccfijjs\r\nfggjnu\r\nbfw\r\neuw\r\nl\r\ngiwx\r\ng\r\ndffgiknqsv\r\naceux\r\nloqqsx\r\naabcdpssv\r\nhmsv\r\nbfghitwx\r\nruwxz\r\nbkowzz\r\n",
                "1821732"
            ],
            [
                "20\r\naellqsu\r\nccfjkoszz\r\ncdeggv\r\nnp\r\nv\r\naadgghi\r\nggp\r\nau\r\ndgllppqswx\r\ndefinrtuvw\r\nq\r\nfhmmt\r\ndjy\r\nfu\r\ngvy\r\nbijlnsuz\r\nr\r\ndkmt\r\neegoqxxyz\r\neflprsy\r\n",
                "7423800"
            ],
            [
                "21\r\nk\r\njkklq\r\ngkpuvxz\r\nbchnrtw\r\naefkww\r\nce\r\njy\r\nhmv\r\nbhmpqrxz\r\nbips\r\nprwx\r\nekmqv\r\nchlmxy\r\ndfy\r\nt\r\nabegiyy\r\nx\r\nep\r\nbbbcdikuux\r\nabcelntwyz\r\nu\r\n",
                "10174976"
            ],
            [
                "22\r\neghlppsvxz\r\nqq\r\nu\r\njsuvy\r\nlpsuxyzz\r\nn\r\nikov\r\nabdlmotuy\r\naakpqwy\r\nfimrsx\r\nqrux\r\na\r\nadhost\r\ndjnsxy\r\nbhu\r\nilx\r\ngghjnouwz\r\ndeilosu\r\nlqwzz\r\ndm\r\nafjoxyzz\r\nilmnqrruvx\r\n",
                "17313568"
            ],
            [
                "23\r\nlpvvwxxx\r\nbdefrx\r\nabeegnovvw\r\nhnoxx\r\ndhp\r\ninqstuyz\r\ncdfnssty\r\nbcky\r\nhksty\r\nefghkrr\r\nceehkmnoop\r\nf\r\nhhkmrstvvy\r\nbbbfgltyzz\r\nbgkrs\r\nadfhimprxz\r\nchrw\r\nmmortwww\r\nddiuyzz\r\nffjqt\r\ngppqryy\r\ncrtwyz\r\ndqy\r\n",
                "6657984"
            ],
            [
                "23\r\na\r\nb\r\nc\r\nd\r\ne\r\nf\r\ng\r\nh\r\ni\r\nj\r\nk\r\nl\r\nm\r\nn\r\no\r\np\r\nq\r\nr\r\ns\r\nt\r\nu\r\nv\r\nw\r\n",
                "174272"
            ]
        ]
    }
]