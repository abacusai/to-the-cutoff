[
    {
        "name": "Lucky Numbers (Hard Version)",
        "description": "This is the hard version of the problem. The only difference is in the\nconstraint on \n    q\n. You can make hacks only if all versions of the problem\nare solved. Zookeeper has been teaching his \n    q\n sheep how to write and how\nto add. The \n    i\n-th sheep has to write exactly \n    k\n non-negative\nintegers with the sum \n    n_i\n. Strangely, sheep have superstitions about\ndigits and believe that the digits \n    3\n, \n    6\n, and \n    9\n are lucky. To\nthem, the fortune of a number depends on the decimal representation of the\nnumber; the fortune of a number is equal to the sum of fortunes of its digits,\nand the fortune of a digit depends on its value and position and can be\ndescribed by the following table. For example, the number \n    319\n has\nfortune \n    F_2 + 3F_0\n. Each sheep wants to maximize the sum of fortune\namong all its \n    k\n written integers. Can you help them? Input The first\nline contains a single integer \n    k\n (\n    1 \n    \u2264 k \n    \u2264 999999\n): the\nnumber of numbers each sheep has to write. The next line contains six integers\n\n    F_0\n, \n    F_1\n, \n    F_2\n, \n    F_3\n, \n    F_4\n, \n    F_5\n (\n    1 \n    \u2264\n    F_i \n    \u2264 10^9\n): the fortune assigned to each digit. The next line\ncontains a single integer \n    q\n (\n    1 \n    \u2264 q \n    \u2264 100\n     000\n): the\nnumber of sheep. Each of the next \n    q\n lines contains a single integer\n\n    n_i\n (\n    1 \n    \u2264 n_i \n    \u2264 999999\n): the sum of numbers that\n\n    i\n-th sheep has to write. Output Print \n    q\n lines, where the\n\n    i\n-th line contains the maximum sum of fortune of all numbers of the\n\n    i\n-th sheep. Example Input 3 1 2 3 4 5 6 2 57 63 Output 11 8 Note In the\nfirst test case, \n    57 = 9 + 9 + 39\n. The three \n    9\n's contribute \n    1\n    \n    \u00b7 3\n and \n    3\n at the tens position contributes \n    2 \n    \u00b7 1\n.\nHence the sum of fortune is \n    11\n. In the second test case, \n    63 = 35 + 19\n    + 9\n. The sum of fortune is \n    8\n.\n\n",
        "cf_contest_id": 1428,
        "cf_index": "G2",
        "cf_rating": 3000,
        "difficulty": 0,
        "cf_tags": [
            "dp",
            "greedy"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3\r\n1 2 3 4 5 6\r\n2\r\n57\r\n63\r\n",
                "11\r\n8\r\n"
            ]
        ],
        "private_cases": []
    }
]