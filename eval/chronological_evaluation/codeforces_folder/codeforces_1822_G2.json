[
    {
        "name": "Magic Triples (Hard Version)",
        "description": "This is the hard version of the problem. The only difference is that in this\nversion, \n    a_i \n    \u2264 10^9\n. For a given sequence of \n    n\n integers\n\n    a\n, a triple \n    (i, j, k)\n is called magic if: \n    1 \n    \u2264 i, j, k \n    \u2264\n    n\n. \n    i\n, \n    j\n, \n    k\n are pairwise distinct. there exists a positive\ninteger \n    b\n such that \n    a_i \n    \u00b7 b = a_j\n and \n    a_j \n    \u00b7 b =\n    a_k\n. Kolya received a sequence of integers \n    a\n as a gift and now wants\nto count the number of magic triples for it. Help him with this task! Note\nthat there are no constraints on the order of integers \n    i\n, \n    j\n and\n\n    k\n. Input The first line contains a single integer \n    t\n (\n    1 \n    \u2264 t\n    \n    \u2264 10^4\n) \u2014 the number of test cases. The description of the test cases\nfollows. The first line of the test case contains a single integer \n    n\n\n(\n    3 \n    \u2264 n \n    \u2264 2 \n    \u00b7 10^5\n) \u2014 the length of the sequence. The\nsecond line of the test contains \n    n\n integers \n    a_1, a_2, a_3, \n    \u2026,\n    a_n\n (\n    1 \n    \u2264 a_i \n    \u2264 10^9\n) \u2014 the elements of the sequence \n    a\n.\nThe sum of \n    n\n over all test cases does not exceed \n    2 \n    \u00b7 10^5\n.\nOutput For each test case, output a single integer \u2014 the number of magic\ntriples for the sequence \n    a\n. Example Input 7 5 1 7 7 2 7 3 6 2 18 9 1 2 3\n4 5 6 7 8 9 4 1000 993 986 179 7 1 10 100 1000 10000 100000 1000000 8 1 1 2 2\n4 4 8 8 9 1 1 1 2 2 2 4 4 4 Output 6 1 3 0 9 16 45 Note In the first example,\nthere are \n    6\n magic triples for the sequence \n    a\n \u2014 \n    (2, 3, 5)\n,\n\n    (2, 5, 3)\n, \n    (3, 2, 5)\n, \n    (3, 5, 2)\n, \n    (5, 2, 3)\n, \n    (5, 3,\n    2)\n. In the second example, there is a single magic triple for the sequence\n\n    a\n \u2014 \n    (2, 1, 3)\n.\n\n",
        "cf_contest_id": 1822,
        "cf_index": "G2",
        "cf_rating": 2200,
        "difficulty": 0,
        "cf_tags": [
            "brute force",
            "data structures",
            "math",
            "number theory"
        ],
        "time_limit_seconds": 4.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "7\r\n5\r\n1 7 7 2 7\r\n3\r\n6 2 18\r\n9\r\n1 2 3 4 5 6 7 8 9\r\n4\r\n1000 993 986 179\r\n7\r\n1 10 100 1000 10000 100000 1000000\r\n8\r\n1 1 2 2 4 4 8 8\r\n9\r\n1 1 1 2 2 2 4 4 4\r\n",
                "6\r\n1\r\n3\r\n0\r\n9\r\n16\r\n45\r\n"
            ]
        ],
        "private_cases": [
            [
                "1\r\n3\r\n1 31621 999887641\r\n",
                "1\r\n"
            ],
            [
                "1\r\n3\r\n1 31622 999950884\r\n",
                "1\r\n"
            ]
        ]
    }
]