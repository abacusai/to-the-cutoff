[
    {
        "name": "Misha, Grisha and Underground",
        "description": "Misha and Grisha are funny boys, so they like to use new underground. The\nunderground has n stations connected with n - 1 routes so that each route\nconnects two stations, and it is possible to reach every station from any\nother. The boys decided to have fun and came up with a plan. Namely, in some\nday in the morning Misha will ride the underground from station s to station f\nby the shortest path, and will draw with aerosol an ugly text \"Misha was here\"\non every station he will pass through (including s and f). After that on the\nsame day at evening Grisha will ride from station t to station f by the\nshortest path and will count stations with Misha's text. After that at night\nthe underground workers will wash the texts out, because the underground\nshould be clean. The boys have already chosen three stations a, b and c for\neach of several following days, one of them should be station s on that day,\nanother should be station f, and the remaining should be station t. They\nbecame interested how they should choose these stations s, f, t so that the\nnumber Grisha will count is as large as possible. They asked you for help.\nInput The first line contains two integers n and q (2 \u2264 n \u2264 10^5, 1 \u2264 q \u2264\n10^5) \u2014 the number of stations and the number of days. The second line\ncontains n - 1 integers p2, p3, ..., pn (1 \u2264 pi \u2264 n). The integer pi means\nthat there is a route between stations pi and i. It is guaranteed that it's\npossible to reach every station from any other. The next q lines contains\nthree integers a, b and c each (1 \u2264 a, b, c \u2264 n) \u2014 the ids of stations chosen\nby boys for some day. Note that some of these ids could be same. Output Print\nq lines. In the i-th of these lines print the maximum possible number Grisha\ncan get counting when the stations s, t and f are chosen optimally from the\nthree stations on the i-th day. Examples Input 3 2 1 1 1 2 3 2 3 3 Output 2 3\nInput 4 1 1 2 3 1 2 3 Output 2 Note In the first example on the first day if s\n= 1, f = 2, t = 3, Misha would go on the route 1 2, and Grisha would go on the\nroute 3 1 2. He would see the text at the stations 1 and 2. On the second day,\nif s = 3, f = 2, t = 3, both boys would go on the route 3 1 2. Grisha would\nsee the text at 3 stations. In the second examle if s = 1, f = 3, t = 2, Misha\nwould go on the route 1 2 3, and Grisha would go on the route 2 3 and would\nsee the text at both stations.\n\n",
        "cf_contest_id": 832,
        "cf_index": "D",
        "cf_rating": 1900,
        "difficulty": 0,
        "cf_tags": [
            "dfs and similar",
            "graphs",
            "trees"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3 2\r\n1 1\r\n1 2 3\r\n2 3 3\r\n",
                "2\r\n3\r\n"
            ],
            [
                "4 1\r\n1 2 3\r\n1 2 3\r\n",
                "2\r\n"
            ]
        ],
        "private_cases": [
            [
                "2 4\r\n1\r\n1 1 1\r\n1 1 2\r\n1 2 2\r\n2 2 2\r\n",
                "1\r\n2\r\n2\r\n1\r\n"
            ],
            [
                "5 20\r\n4 1 1 4\r\n2 2 5\r\n3 2 5\r\n2 3 4\r\n4 2 5\r\n4 1 2\r\n5 3 1\r\n2 1 2\r\n4 3 2\r\n1 3 3\r\n4 2 5\r\n5 1 4\r\n4 5 4\r\n1 2 4\r\n3 3 1\r\n5 4 5\r\n1 1 1\r\n1 4 4\r\n5 3 2\r\n4 2 1\r\n3 1 4\r\n",
                "3\r\n3\r\n3\r\n2\r\n2\r\n3\r\n3\r\n3\r\n2\r\n2\r\n2\r\n2\r\n2\r\n2\r\n2\r\n1\r\n2\r\n3\r\n2\r\n2\r\n"
            ],
            [
                "5 20\r\n5 5 1 4\r\n1 4 3\r\n2 4 1\r\n1 5 5\r\n5 1 4\r\n5 1 5\r\n1 5 5\r\n5 4 4\r\n2 3 3\r\n4 4 1\r\n1 4 1\r\n4 5 4\r\n1 4 5\r\n4 1 5\r\n2 4 2\r\n4 3 3\r\n2 5 5\r\n1 5 4\r\n3 3 4\r\n5 5 1\r\n3 4 1\r\n",
                "3\r\n3\r\n3\r\n2\r\n3\r\n3\r\n2\r\n3\r\n2\r\n2\r\n2\r\n2\r\n2\r\n3\r\n3\r\n2\r\n2\r\n3\r\n3\r\n3\r\n"
            ]
        ]
    }
]