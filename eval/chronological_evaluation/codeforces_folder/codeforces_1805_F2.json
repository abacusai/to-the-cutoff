[
    {
        "name": "Survival of the Weakest (hard version)",
        "description": "This is the hard version of the problem. It differs from the easy one only in\nconstraints on \n    n\n. You can make hacks only if you lock both versions. Let\n\n    a_1, a_2, \n    \u2026, a_n\n be an array of non-negative integers. Let\n\n    F(a_1, a_2, \n    \u2026, a_n)\n be the sorted in the non-decreasing order\narray of \n    n - 1\n smallest numbers of the form \n    a_i + a_j\n, where \n    1\n    \n    \u2264 i < j \n    \u2264 n\n. In other words, \n    F(a_1, a_2, \n    \u2026, a_n)\n is\nthe sorted in the non-decreasing order array of \n    n - 1\n smallest sums of\nall possible pairs of elements of the array \n    a_1, a_2, \n    \u2026, a_n\n. For\nexample, \n    F(1, 2, 5, 7) = [1 + 2, 1 + 5, 2 + 5] = [3, 6, 7]\n. You are\ngiven an array of non-negative integers \n    a_1, a_2, \n    \u2026, a_n\n.\nDetermine the single element of the array \n    F(F(F\n    \u2026\n    F_n-1(a_1, a_2, \n    \u2026, a_n)\n    \u2026))\n. Since the answer can be quite\nlarge, output it modulo \n    10^9+7\n. Input The first line contains one\ninteger \n    n\n (\n    2 \n    \u2264 n \n    \u2264 2 \n    \u00b7 10^5\n) \u2014 the initial length of\nthe array. The second line contains \n    n\n integers \n    a_1, a_2, \n    \u2026,\n    a_n\n (\n    0 \n    \u2264 a_i \n    \u2264 10^9\n) \u2014 the array elements. Output Output a\nsingle number \u2014 the answer modulo \n    10^9 + 7\n. Examples Input 5 1 2 4 5 6\nOutput 34 Input 9 1 1 1 7 7 7 9 9 9 Output 256 Input 7 1 7 9 2 0 0 9 Output 20\nInput 3 1000000000 1000000000 777 Output 1540 Note In the first test, the\narray is transformed as follows: \n    [1, 2, 4, 5, 6] \n    \u2192 [3, 5, 6, 6] \n    \u2192\n    [8, 9, 9] \n    \u2192 [17, 17] \n    \u2192 [34]\n. The only element of the final array is\n\n    34\n. In the second test, \n    F(a_1, a_2, \n    \u2026, a_n)\n is \n    [2, 2, 2,\n    8, 8, 8, 8, 8]\n. This array is made up of \n    3\n numbers of the form \n    1 +\n    1\n and \n    5\n numbers of the form \n    1 + 7\n. In the fourth test, the\narray is transformed as follows: \n    [10^9, 10^9, 777] \n    \u2192 [10^9+777,\n    10^9+777] \n    \u2192 [2 \n    \u00b7 10^9 + 1554]\n. \n    2 \n    \u00b7 10^9 + 1554\n modulo\n\n    10^9+7\n equals \n    1540\n.\n\n",
        "cf_contest_id": 1805,
        "cf_index": "F2",
        "cf_rating": 3100,
        "difficulty": 0,
        "cf_tags": [
            "greedy",
            "math",
            "sortings",
            "two pointers"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "5\r\n1 2 4 5 6\r\n",
                "34\r\n"
            ],
            [
                "9\r\n1 1 1 7 7 7 9 9 9\r\n",
                "256\r\n"
            ],
            [
                "7\r\n1 7 9 2 0 0 9\r\n",
                "20\r\n"
            ],
            [
                "3\r\n1000000000 1000000000 777\r\n",
                "1540\r\n"
            ]
        ],
        "private_cases": [
            [
                "30\r\n999984742 999511719 999999971 500000000 999999047 999969483 999755860 996093750 999999986 999938965 999023438 999999524 999998093 937500000 999999762 999877930 999999999 999999997 750000000 999999941 999999881 999999993 875000000 999992371 992187500 999996186 968750000 984375000 998046875 1000000000\r\n",
                "828390975\r\n"
            ],
            [
                "41\r\n999999953 999978064 999529816 1000000000 784000001 400000001 999999779 999986838 953344001 999963439 983203841 999999632 993953383 999216359 640000001 999999972 999999998 999999999 997823218 999999983 999999921 999999994 999830734 999998977 870400001 999999868 996372030 999939065 999999386 922240001 999992103 999717890 999997157 999998295 999898441 998693931 999999997 989922305 999999990 999995262 972006401\r\n",
                "654457788\r\n"
            ],
            [
                "43\r\n999999489 999960556 999975663 999998658 999999926 965959483 999999994 992004390 765114888 999558875 999999998 995066709 999999999 999984984 944828984 383000001 999999996 999285048 996956159 999999685 999990736 619311001 999999172 999727826 998841244 999994284 987041150 999999990 999896387 999999955 999999972 998121951 910581822 999832069 978997001 855075886 1000000000 999999806 999999983 999996473 999936071 999999880 999997824\r\n",
                "478875065\r\n"
            ],
            [
                "44\r\n999999998 999999874 1000000000 999999922 999999993 999999952 996896429 999827101 999997727 999267468 999547295 999999999 999998595 999893149 994978041 999999464 999999132 999999669 999990368 999999982 909854848 991873852 944290297 382000001 999996322 998081994 999984414 999959191 999994048 999933966 999974780 999999999 999999796 999999989 618076001 854134059 763970969 999720229 999999996 998814672 999999971 965571403 986850893 978723128\r\n",
                "656998949\r\n"
            ],
            [
                "44\r\n978714037 999999874 999959146 999994040 999984395 999990356 999999952 999999668 999999795 999999971 999999922 999999131 999998593 999999999 999999998 999999999 999933896 944272445 999826935 999997724 909830778 999974751 999999989 1000000000 999893040 999719975 854102900 999999993 763933156 998813786 999999996 991869512 618035211 996894440 986844572 999999463 999999982 965558532 999266881 999996317 994975090 998080662 999546908 381967000\r\n",
                "729045204\r\n"
            ],
            [
                "44\r\n999893037 999933894 978713761 999999668 944271904 999999998 999999131 381966001 909830049 999999922 999999999 999990356 999999982 999959144 999999999 999996316 999266863 618033975 999546897 999719967 998813759 986844381 999999874 965558142 999999463 763932010 999984395 994975001 999999989 999999952 999994040 999974750 1000000000 998080621 996894380 999999971 854101956 999998593 999999795 999826930 999999996 999999993 991869380 999997724\r\n",
                "482567780\r\n"
            ],
            [
                "2\r\n7 1000000000\r\n",
                "0\r\n"
            ],
            [
                "3\r\n32371992 313502957 924602143\r\n",
                "302849077\r\n"
            ],
            [
                "2\r\n373642622 952441803\r\n",
                "326084418\r\n"
            ],
            [
                "2\r\n0 0\r\n",
                "0\r\n"
            ],
            [
                "44\r\n433494436 433494436 433494436 433494435 433494434 433494432 433494429 433494424 433494416 433494403 433494382 433494348 433494293 433494204 433494060 433493827 433493450 433492840 433491853 433490256 433487672 433483491 433476726 433465780 433448069 433419412 433373044 433298019 433176626 432980208 432662397 432148168 431316128 429969859 427791550 424266972 418564085 409336620 394406268 370248451 331160282 267914296 165580141 0\r\n",
                "278495828\r\n"
            ],
            [
                "45\r\n701408732 701408732 701408732 701408731 701408730 701408728 701408725 701408720 701408712 701408699 701408678 701408644 701408589 701408500 701408356 701408123 701407746 701407136 701406149 701404552 701401968 701397787 701391022 701380076 701362365 701333708 701287340 701212315 701090922 700894504 700576693 700062464 699230424 697884155 695705846 692181268 686478381 677250916 662320564 638162747 599074578 535828592 433494437 267914296 0\r\n",
                "453809703\r\n"
            ]
        ]
    }
]