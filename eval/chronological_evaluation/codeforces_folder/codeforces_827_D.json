[
    {
        "name": "Best Edge Weight",
        "description": "You are given a connected weighted graph with n vertices and m edges. The\ngraph doesn't contain loops nor multiple edges. Consider some edge with id i.\nLet's determine for this edge the maximum integer weight we can give to it so\nthat it is contained in all minimum spanning trees of the graph if we don't\nchange the other weights. You are to determine this maximum weight described\nabove for each edge. You should calculate the answer for each edge\nindependently, it means there can't be two edges with changed weights at the\nsame time. Input The first line contains two integers n and m (2 \u2264 n \u2264 2\u00b710^5,\nn - 1 \u2264 m \u2264 2\u00b710^5), where n and m are the number of vertices and the number\nof edges in the graph, respectively. Each of the next m lines contains three\nintegers u, v and c (1 \u2264 v, u \u2264 n, v \u2260 u, 1 \u2264 c \u2264 10^9) meaning that there is\nan edge between vertices u and v with weight c. Output Print the answer for\neach edge in the order the edges are given in the input. If an edge is\ncontained in every minimum spanning tree with any weight, print -1 as the\nanswer. Examples Input 4 4 1 2 2 2 3 2 3 4 2 4 1 3 Output 2 2 2 1 Input 4 3 1\n2 2 2 3 2 3 4 2 Output -1 -1 -1\n\n",
        "cf_contest_id": 827,
        "cf_index": "D",
        "cf_rating": 2700,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "dfs and similar",
            "graphs",
            "trees"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "4 4\r\n1 2 2\r\n2 3 2\r\n3 4 2\r\n4 1 3\r\n",
                "2 2 2 1 "
            ],
            [
                "4 3\r\n1 2 2\r\n2 3 2\r\n3 4 2\r\n",
                "-1 -1 -1 "
            ]
        ],
        "private_cases": [
            [
                "10 21\r\n5 6 88\r\n6 3 74\r\n1 5 7\r\n1 6 27\r\n8 1 50\r\n4 1 24\r\n10 6 37\r\n9 7 39\r\n5 7 63\r\n2 7 98\r\n3 4 28\r\n9 2 5\r\n2 4 96\r\n9 6 67\r\n9 10 47\r\n10 4 64\r\n2 5 70\r\n6 8 89\r\n3 5 54\r\n6 7 18\r\n1 7 26\r\n",
                "25 27 53 25 88 53 46 46 25 38 53 69 38 38 38 36 38 49 27 26 26 "
            ],
            [
                "20 20\r\n9 4 21\r\n5 7 22\r\n2 20 37\r\n1 6 19\r\n14 20 5\r\n8 9 43\r\n17 4 40\r\n12 10 26\r\n19 4 99\r\n11 4 55\r\n3 18 6\r\n7 8 43\r\n13 9 1\r\n20 4 69\r\n16 18 67\r\n18 13 90\r\n6 11 66\r\n15 5 76\r\n10 9 93\r\n5 18 14\r\n",
                "-1 89 -1 -1 -1 89 -1 -1 -1 -1 -1 89 89 -1 -1 42 -1 -1 -1 89 "
            ],
            [
                "20 40\r\n5 20 86\r\n6 2 33\r\n16 20 50\r\n8 2 92\r\n13 20 28\r\n5 16 33\r\n8 11 90\r\n10 12 26\r\n12 18 93\r\n4 2 76\r\n11 18 14\r\n13 15 3\r\n14 20 92\r\n5 8 37\r\n16 18 85\r\n18 8 47\r\n9 3 12\r\n15 20 30\r\n11 9 3\r\n19 12 94\r\n13 18 75\r\n14 4 87\r\n19 2 91\r\n8 7 20\r\n18 2 9\r\n17 3 19\r\n2 15 93\r\n3 2 26\r\n1 15 68\r\n13 7 20\r\n17 14 78\r\n4 13 45\r\n10 17 72\r\n1 19 16\r\n17 20 99\r\n7 19 4\r\n4 1 23\r\n16 9 71\r\n6 17 1\r\n13 2 3\r\n",
                "36 18 36 19 29 49 19 92 71 22 25 29 77 49 36 19 25 27 25 71 8 77 19 46 25 32 2 13 19 44 86 22 92 44 27 44 44 36 32 46 "
            ],
            [
                "20 40\r\n12 18 6\r\n20 2 3\r\n4 9 7\r\n13 17 3\r\n17 12 6\r\n7 8 2\r\n14 18 10\r\n7 20 5\r\n18 5 7\r\n14 11 1\r\n11 12 2\r\n16 2 9\r\n6 11 4\r\n14 10 2\r\n17 9 5\r\n9 20 7\r\n10 9 1\r\n4 7 3\r\n5 9 4\r\n10 16 10\r\n4 2 6\r\n19 17 5\r\n13 11 3\r\n16 8 1\r\n2 5 9\r\n14 4 6\r\n19 1 2\r\n13 14 8\r\n3 12 1\r\n1 18 1\r\n15 13 7\r\n8 14 4\r\n20 18 9\r\n17 2 8\r\n15 20 7\r\n2 10 2\r\n3 20 1\r\n18 8 10\r\n16 6 7\r\n6 1 2\r\n",
                "3 1 3 4 2 4 3 3 3 2 2 3 4 2 2 1 4 5 6 3 3 3 4 6 3 3 4 2 2 5 6 4 3 2 6 2 2 3 3 4 "
            ],
            [
                "2 1\r\n2 1 1\r\n",
                "-1 "
            ],
            [
                "3 2\r\n3 2 4\r\n1 2 2\r\n",
                "-1 -1 "
            ],
            [
                "4 6\r\n3 2 9\r\n2 4 15\r\n1 2 8\r\n1 3 5\r\n3 4 4\r\n1 4 14\r\n",
                "7 7 8 8 13 4 "
            ],
            [
                "5 4\r\n2 1 24\r\n5 1 6\r\n1 3 11\r\n4 1 13\r\n",
                "-1 -1 -1 -1 "
            ],
            [
                "6 11\r\n2 6 11\r\n4 3 29\r\n4 1 2\r\n4 6 18\r\n4 2 36\r\n1 3 11\r\n5 3 22\r\n2 5 22\r\n6 3 18\r\n1 5 29\r\n5 6 3\r\n",
                "21 10 17 17 17 17 17 10 17 17 21 "
            ],
            [
                "7 9\r\n1 7 31\r\n1 4 48\r\n7 3 23\r\n7 2 10\r\n3 5 27\r\n5 6 26\r\n5 4 18\r\n6 2 48\r\n4 6 29\r\n",
                "47 30 47 47 47 28 28 26 25 "
            ],
            [
                "8 10\r\n7 3 41\r\n6 8 1\r\n3 2 19\r\n3 4 51\r\n1 4 18\r\n5 7 10\r\n5 6 26\r\n2 6 52\r\n4 8 11\r\n2 5 64\r\n",
                "50 50 51 40 -1 50 50 40 50 40 "
            ],
            [
                "9 26\r\n7 3 62\r\n7 5 58\r\n8 3 40\r\n9 7 27\r\n5 2 42\r\n6 5 35\r\n2 6 58\r\n1 5 4\r\n3 4 42\r\n1 3 17\r\n7 2 27\r\n2 1 19\r\n4 9 59\r\n7 1 71\r\n2 8 11\r\n9 1 7\r\n8 4 65\r\n5 9 53\r\n3 5 59\r\n9 3 62\r\n4 7 3\r\n1 8 73\r\n2 4 52\r\n6 1 3\r\n4 1 67\r\n9 6 25\r\n",
                "26 26 18 26 18 3 18 34 26 39 26 26 26 26 39 24 26 6 16 16 41 18 26 24 26 6 "
            ],
            [
                "10 13\r\n4 2 86\r\n7 2 56\r\n6 7 74\r\n6 5 14\r\n3 2 12\r\n1 4 69\r\n10 6 13\r\n4 3 13\r\n5 10 96\r\n2 5 17\r\n4 7 28\r\n8 10 38\r\n9 8 24\r\n",
                "12 27 27 73 55 -1 95 55 13 73 55 -1 -1 "
            ],
            [
                "11 42\r\n5 3 86\r\n11 2 116\r\n9 2 68\r\n4 9 58\r\n8 6 88\r\n3 4 119\r\n11 7 20\r\n6 7 61\r\n6 2 47\r\n1 3 33\r\n6 5 66\r\n9 3 68\r\n10 7 64\r\n1 8 7\r\n6 10 72\r\n10 4 119\r\n9 6 14\r\n6 3 72\r\n10 9 55\r\n4 11 118\r\n9 8 43\r\n5 2 26\r\n11 6 76\r\n9 7 29\r\n2 1 74\r\n4 6 85\r\n4 5 110\r\n5 10 40\r\n3 11 11\r\n3 2 10\r\n9 5 6\r\n5 11 77\r\n10 1 98\r\n2 10 110\r\n3 7 114\r\n1 9 99\r\n5 7 111\r\n1 4 96\r\n4 8 91\r\n7 2 61\r\n3 10 102\r\n3 8 44\r\n",
                "25 10 25 84 32 57 28 25 25 42 13 25 39 42 39 57 46 25 39 57 32 28 25 25 32 57 57 54 28 28 28 25 39 39 19 32 25 57 57 19 39 32 "
            ],
            [
                "12 24\r\n11 10 131\r\n6 5 86\r\n3 11 128\r\n2 12 8\r\n10 4 44\r\n5 9 40\r\n1 11 64\r\n5 11 66\r\n2 10 31\r\n3 6 39\r\n8 5 121\r\n9 11 126\r\n6 12 134\r\n4 9 89\r\n3 1 137\r\n12 3 70\r\n9 12 81\r\n1 7 70\r\n12 1 86\r\n6 1 39\r\n7 4 47\r\n2 9 37\r\n10 1 103\r\n4 6 34\r\n",
                "63 43 63 69 65 65 65 63 65 69 -1 63 43 43 38 43 36 46 43 65 69 65 43 65 "
            ],
            [
                "13 14\r\n1 11 112\r\n2 12 149\r\n13 7 20\r\n7 8 11\r\n12 8 61\r\n3 5 127\r\n10 8 34\r\n9 5 105\r\n2 1 83\r\n5 6 127\r\n4 6 101\r\n11 6 164\r\n12 13 45\r\n8 11 84\r\n",
                "148 111 60 60 44 -1 -1 -1 148 -1 -1 -1 60 148 "
            ],
            [
                "14 55\r\n1 3 170\r\n14 13 18\r\n7 8 63\r\n10 1 41\r\n11 3 175\r\n4 13 55\r\n2 7 102\r\n6 12 61\r\n4 14 74\r\n10 11 44\r\n8 1 98\r\n12 10 77\r\n13 3 45\r\n9 4 115\r\n9 2 43\r\n5 11 93\r\n4 1 54\r\n8 9 120\r\n14 7 145\r\n13 8 154\r\n14 8 94\r\n6 7 151\r\n5 6 32\r\n3 7 122\r\n3 4 169\r\n14 9 101\r\n9 7 96\r\n13 12 20\r\n8 6 121\r\n13 11 143\r\n5 10 74\r\n3 2 14\r\n10 2 30\r\n10 4 81\r\n10 3 63\r\n10 14 105\r\n2 11 184\r\n8 2 5\r\n3 9 119\r\n2 1 106\r\n5 2 150\r\n8 5 143\r\n6 4 86\r\n2 14 1\r\n12 2 161\r\n7 13 51\r\n5 13 164\r\n1 6 107\r\n7 10 90\r\n9 1 152\r\n3 6 129\r\n11 14 52\r\n1 14 108\r\n12 14 142\r\n2 6 144\r\n",
                "40 44 50 54 43 53 50 73 53 51 40 29 17 53 95 60 54 42 50 17 4 60 73 50 53 42 50 73 60 43 60 44 51 53 29 29 43 62 42 40 60 60 60 44 19 62 60 60 50 42 60 43 40 19 60 "
            ],
            [
                "16 52\r\n15 16 50\r\n6 15 104\r\n11 6 9\r\n2 13 210\r\n16 9 206\r\n9 10 53\r\n16 8 166\r\n9 1 123\r\n12 16 14\r\n7 13 245\r\n1 2 40\r\n12 10 17\r\n14 7 75\r\n3 13 152\r\n12 14 61\r\n6 4 82\r\n15 7 138\r\n14 13 249\r\n4 15 63\r\n1 15 38\r\n8 2 66\r\n5 4 214\r\n3 5 39\r\n5 7 241\r\n14 15 104\r\n16 13 231\r\n12 3 70\r\n8 7 203\r\n5 10 147\r\n16 5 140\r\n10 6 125\r\n12 13 131\r\n7 11 46\r\n15 8 216\r\n3 10 78\r\n11 10 42\r\n13 10 121\r\n3 14 81\r\n1 10 183\r\n15 5 200\r\n2 16 183\r\n8 11 50\r\n13 15 185\r\n7 4 196\r\n4 2 107\r\n1 3 188\r\n4 11 156\r\n2 15 172\r\n2 12 234\r\n13 5 218\r\n9 15 245\r\n12 1 64\r\n",
                "63 49 81 120 52 122 49 52 63 120 65 65 60 120 74 62 49 120 81 63 49 69 139 69 60 120 77 49 69 69 41 120 74 49 69 65 130 69 49 69 49 65 120 62 62 69 62 39 49 120 52 49 "
            ],
            [
                "18 49\r\n6 12 250\r\n13 6 245\r\n1 7 10\r\n10 3 184\r\n8 17 2\r\n17 5 139\r\n4 17 256\r\n15 3 99\r\n2 7 57\r\n17 12 60\r\n4 10 199\r\n1 10 244\r\n10 11 137\r\n7 13 197\r\n10 14 212\r\n6 10 310\r\n10 17 311\r\n11 9 246\r\n2 15 167\r\n6 14 229\r\n6 1 96\r\n14 9 300\r\n4 1 254\r\n9 18 228\r\n14 13 286\r\n12 10 74\r\n5 11 154\r\n16 1 287\r\n1 18 308\r\n6 11 127\r\n12 13 60\r\n4 6 277\r\n15 7 85\r\n14 15 16\r\n3 12 312\r\n8 13 92\r\n1 11 100\r\n7 4 315\r\n2 13 152\r\n2 8 171\r\n10 9 300\r\n6 3 188\r\n8 18 265\r\n18 2 87\r\n18 11 48\r\n3 4 150\r\n10 16 245\r\n4 16 131\r\n3 1 25\r\n",
                "136 136 98 136 91 153 149 84 99 91 149 136 151 136 136 136 73 227 84 95 126 227 149 245 136 151 138 149 86 95 91 149 98 211 136 59 86 149 136 136 227 95 136 99 99 198 149 244 98 "
            ],
            [
                "19 50\r\n16 15 243\r\n1 7 118\r\n9 1 221\r\n7 12 206\r\n14 13 182\r\n15 17 278\r\n6 8 315\r\n8 16 146\r\n15 11 233\r\n13 18 16\r\n11 8 76\r\n7 2 211\r\n4 16 40\r\n1 6 260\r\n9 4 163\r\n6 16 306\r\n17 16 171\r\n10 5 331\r\n2 9 184\r\n12 6 36\r\n1 19 327\r\n10 7 85\r\n7 3 282\r\n14 7 166\r\n19 8 319\r\n1 15 202\r\n17 7 181\r\n14 6 205\r\n9 6 279\r\n10 19 156\r\n15 18 274\r\n1 11 226\r\n4 7 37\r\n16 19 117\r\n7 15 306\r\n18 19 116\r\n4 11 101\r\n5 6 41\r\n3 15 319\r\n15 5 333\r\n2 3 258\r\n16 12 162\r\n11 18 203\r\n10 15 217\r\n9 13 181\r\n17 8 117\r\n4 12 185\r\n1 18 60\r\n5 1 284\r\n4 10 116\r\n",
                "201 116 162 161 165 201 161 100 201 180 145 183 117 161 180 161 116 161 210 204 115 115 257 181 116 216 116 165 162 116 201 116 115 117 201 117 145 283 257 201 281 184 116 201 162 170 161 117 161 84 "
            ],
            [
                "6 8\r\n4 3 3\r\n3 5 2\r\n2 4 1\r\n6 1 2\r\n1 2 2\r\n5 6 2\r\n2 3 3\r\n2 5 2\r\n",
                "1 2 2 1 1 1 1 1 "
            ],
            [
                "6 10\r\n1 4 7\r\n4 2 4\r\n3 4 10\r\n2 6 5\r\n6 5 2\r\n5 2 9\r\n5 4 5\r\n1 2 5\r\n5 1 4\r\n1 3 3\r\n",
                "4 4 4 4 4 4 4 4 4 9 "
            ],
            [
                "7 8\r\n4 2 3\r\n2 6 2\r\n1 7 1\r\n6 5 1\r\n7 4 1\r\n5 1 1\r\n4 3 2\r\n3 2 3\r\n",
                "1 2 2 2 2 2 2 1 "
            ],
            [
                "7 10\r\n1 2 3\r\n3 4 8\r\n2 5 4\r\n4 1 5\r\n3 6 3\r\n7 3 5\r\n7 4 9\r\n3 1 9\r\n5 7 2\r\n6 4 7\r\n",
                "6 4 6 6 6 6 4 4 6 4 "
            ],
            [
                "8 8\r\n8 6 1\r\n2 7 1\r\n4 8 1\r\n3 1 3\r\n1 4 1\r\n7 3 2\r\n5 2 1\r\n6 5 2\r\n",
                "2 2 2 1 2 2 2 2 "
            ],
            [
                "8 10\r\n7 2 3\r\n1 4 3\r\n5 6 4\r\n4 7 3\r\n6 3 5\r\n2 5 2\r\n5 3 9\r\n3 8 3\r\n8 1 2\r\n5 8 8\r\n",
                "4 4 4 4 3 4 2 4 4 2 "
            ]
        ]
    }
]