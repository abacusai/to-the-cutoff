[
    {
        "name": "Mergesort Strikes Back",
        "description": "Chouti thought about his very first days in competitive programming. When he\nhad just learned to write merge sort, he thought that the merge sort is too\nslow, so he restricted the maximum depth of recursion and modified the merge\nsort to the following: Chouti found his idea dumb since obviously, this \"merge\nsort\" sometimes cannot sort the array correctly. However, Chouti is now\nstarting to think of how good this \"merge sort\" is. Particularly, Chouti wants\nto know for a random permutation \n    a\n of \n    1, 2, \n    \u2026, n\n the\nexpected number of inversions after calling MergeSort(a, 1, n, k). It can be\nproved that the expected number is rational. For the given prime \n    q\n,\nsuppose the answer can be denoted by \n    u/d\n where\n\n    gcd(u,d)=1\n, you need to output an integer \n    r\n satisfying \n    0 \n    \u2264\n    r<q\n and \n    rd \n    \u2261 u \n     q\n. It can be proved that such \n    r\n\nexists and is unique. Input The first and only line contains three integers\n\n    n, k, q\n (\n    1 \n    \u2264 n, k \n    \u2264 10^5, 10^8 \n    \u2264 q \n    \u2264 10^9\n,\n\n    q\n is a prime). Output The first and only line contains an integer\n\n    r\n. Examples Input 3 1 998244353 Output 499122178 Input 3 2 998244353\nOutput 665496236 Input 9 3 998244353 Output 449209967 Input 9 4 998244353\nOutput 665496237 Note In the first example, all possible permutations are\n\n    [1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]\n. With \n    k=1\n,\nMergeSort(a, 1, n, k) will only return the original permutation. Thus the\nanswer is \n    9/6=3/2\n, and you should output \n    499122178\n because\n\n    499122178 \n    \u00d7 2 \n    \u2261 3 \n    998244353\n. In the second\nexample, all possible permutations are\n\n    [1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]\n and the corresponding\noutputs of MergeSort(a, 1, n, k) are\n\n    [1,2,3],[1,2,3],[2,1,3],[1,2,3],[2,3,1],[1,3,2]\n respectively. Thus the\nanswer is \n    4/6=2/3\n, and you should output \n    665496236\n because\n\n    665496236 \n    \u00d7 3 \n    \u2261 2 \n    998244353\n.\n\n",
        "cf_contest_id": 1081,
        "cf_index": "G",
        "cf_rating": 3200,
        "difficulty": 0,
        "cf_tags": [
            "math",
            "probabilities"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3 1 998244353\r\n",
                "499122178"
            ],
            [
                "3 2 998244353\r\n",
                "665496236"
            ],
            [
                "9 3 998244353\r\n",
                "449209967"
            ],
            [
                "9 4 998244353\r\n",
                "665496237"
            ]
        ],
        "private_cases": [
            [
                "5000 2 444286949\r\n",
                "161627985"
            ],
            [
                "5000 3 947484677\r\n",
                "453430334"
            ],
            [
                "5000 4 961162523\r\n",
                "935148925"
            ],
            [
                "5000 5000 824957897\r\n",
                "0"
            ],
            [
                "100000 1 327496733\r\n",
                "207497869"
            ],
            [
                "100000 2 330782867\r\n",
                "20709968"
            ],
            [
                "100000 3 372547751\r\n",
                "341122978"
            ],
            [
                "100000 4 866430809\r\n",
                "315155497"
            ],
            [
                "100000 100000 658399519\r\n",
                "0"
            ],
            [
                "1 1 807831149\r\n",
                "0"
            ],
            [
                "1 100000 355399153\r\n",
                "0"
            ],
            [
                "65535 6 100000007\r\n",
                "19616415"
            ],
            [
                "65536 7 999999937\r\n",
                "195101941"
            ],
            [
                "1 2 932173633\r\n",
                "0"
            ],
            [
                "99999 1 501051697\r\n",
                "245192364"
            ],
            [
                "99999 2 594212063\r\n",
                "241186421"
            ],
            [
                "99999 3 538530137\r\n",
                "420705596"
            ],
            [
                "99999 4 721319531\r\n",
                "482453887"
            ],
            [
                "99999 5 950991961\r\n",
                "236965854"
            ],
            [
                "99999 6 769267349\r\n",
                "537638613"
            ],
            [
                "99999 7 612486629\r\n",
                "160702769"
            ],
            [
                "99999 8 616151843\r\n",
                "506564910"
            ],
            [
                "99999 9 543989543\r\n",
                "330542468"
            ],
            [
                "99999 10 201673531\r\n",
                "6497465"
            ],
            [
                "99999 11 739822453\r\n",
                "286705678"
            ],
            [
                "99999 12 608975467\r\n",
                "317105066"
            ],
            [
                "99999 13 838056061\r\n",
                "772746099"
            ],
            [
                "99999 14 746231791\r\n",
                "534083991"
            ],
            [
                "99999 15 385602223\r\n",
                "286320285"
            ],
            [
                "99999 16 424240459\r\n",
                "81192002"
            ],
            [
                "99999 17 222262553\r\n",
                "24806593"
            ],
            [
                "99999 18 278747437\r\n",
                "0"
            ],
            [
                "65535 1 969378797\r\n",
                "589003274"
            ],
            [
                "65535 2 332622313\r\n",
                "23332505"
            ],
            [
                "65535 3 200770211\r\n",
                "26568059"
            ],
            [
                "65535 4 585040979\r\n",
                "73478343"
            ],
            [
                "65535 5 492219967\r\n",
                "1097877"
            ],
            [
                "65535 6 563701807\r\n",
                "478190145"
            ],
            [
                "65535 7 775068599\r\n",
                "580904942"
            ],
            [
                "65535 8 629794369\r\n",
                "563763277"
            ],
            [
                "65535 9 939195329\r\n",
                "374972142"
            ],
            [
                "65535 10 764125471\r\n",
                "44493100"
            ],
            [
                "65535 11 390043253\r\n",
                "2137720"
            ],
            [
                "65535 12 196344479\r\n",
                "7405077"
            ],
            [
                "65535 13 543456539\r\n",
                "170536956"
            ],
            [
                "65535 14 379941571\r\n",
                "364848655"
            ],
            [
                "65535 15 148502831\r\n",
                "46429722"
            ],
            [
                "65535 16 589256509\r\n",
                "362272581"
            ],
            [
                "65535 17 131827369\r\n",
                "0"
            ],
            [
                "65536 1 262776883\r\n",
                "22617908"
            ],
            [
                "65536 2 547031129\r\n",
                "68232417"
            ],
            [
                "65536 3 759400619\r\n",
                "725177449"
            ],
            [
                "65536 4 530056207\r\n",
                "175616225"
            ],
            [
                "65536 5 347538067\r\n",
                "50947333"
            ],
            [
                "65536 6 526215803\r\n",
                "158448501"
            ],
            [
                "65536 7 474924587\r\n",
                "244871950"
            ],
            [
                "65536 8 624488609\r\n",
                "456424095"
            ],
            [
                "65536 9 512750233\r\n",
                "56371267"
            ],
            [
                "65536 10 802338989\r\n",
                "462855383"
            ],
            [
                "65536 11 506680939\r\n",
                "206613192"
            ],
            [
                "65536 12 883299773\r\n",
                "385022293"
            ],
            [
                "65536 13 543490043\r\n",
                "510005251"
            ],
            [
                "65536 14 292184353\r\n",
                "211044160"
            ],
            [
                "65536 15 568071787\r\n",
                "2593916"
            ],
            [
                "65536 16 307380313\r\n",
                "210721421"
            ],
            [
                "65536 17 355422121\r\n",
                "0"
            ],
            [
                "2 2 105534269\r\n",
                "0"
            ],
            [
                "2 3 738541207\r\n",
                "0"
            ],
            [
                "3 2 457143689\r\n",
                "304762460"
            ],
            [
                "3 3 537728333\r\n",
                "0"
            ],
            [
                "4 2 717931793\r\n",
                "59827651"
            ],
            [
                "4 3 691608353\r\n",
                "0"
            ],
            [
                "5 2 488196377\r\n",
                "455649955"
            ],
            [
                "5 3 698057369\r\n",
                "1"
            ],
            [
                "5 4 294228373\r\n",
                "0"
            ],
            [
                "6 2 126580711\r\n",
                "61180682"
            ],
            [
                "6 3 706327789\r\n",
                "529745844"
            ],
            [
                "6 4 142235399\r\n",
                "0"
            ],
            [
                "7 2 400166453\r\n",
                "37158321"
            ],
            [
                "7 3 957060541\r\n",
                "239265139"
            ],
            [
                "7 4 674998729\r\n",
                "0"
            ],
            [
                "8 2 401001541\r\n",
                "108365903"
            ],
            [
                "8 3 930233189\r\n",
                "465116600"
            ],
            [
                "8 4 617453693\r\n",
                "0"
            ],
            [
                "68102 2 409693891\r\n",
                "248567049"
            ],
            [
                "33727 15 177545087\r\n",
                "137396822"
            ],
            [
                "29670 1 798626077\r\n",
                "619382846"
            ],
            [
                "56907 7 653135281\r\n",
                "367828981"
            ],
            [
                "93014 3 464769397\r\n",
                "3096497"
            ],
            [
                "79173 7 329778431\r\n",
                "112881569"
            ],
            [
                "96560 6 621206447\r\n",
                "336730170"
            ],
            [
                "23880 14 515153497\r\n",
                "28372663"
            ],
            [
                "58791 1 627994511\r\n",
                "550083467"
            ],
            [
                "4862 11 340369703\r\n",
                "187513462"
            ],
            [
                "12657 1 328355033\r\n",
                "40046748"
            ],
            [
                "79602 9 341282581\r\n",
                "15283453"
            ],
            [
                "19679 2 978579983\r\n",
                "166411803"
            ],
            [
                "93976 8 747153793\r\n",
                "239386990"
            ],
            [
                "14823 8 622667251\r\n",
                "282687828"
            ],
            [
                "64554 13 711786883\r\n",
                "501856006"
            ],
            [
                "9569 7 974022443\r\n",
                "297115301"
            ],
            [
                "42288 6 367611719\r\n",
                "235655808"
            ],
            [
                "39062 3 557718113\r\n",
                "311741364"
            ],
            [
                "78790 14 947580449\r\n",
                "804769289"
            ],
            [
                "87440 14 373345151\r\n",
                "58174995"
            ],
            [
                "75727 16 485722667\r\n",
                "166058860"
            ],
            [
                "11045 4 779484089\r\n",
                "766560946"
            ],
            [
                "31581 2 803297119\r\n",
                "335334542"
            ],
            [
                "13694 5 579788161\r\n",
                "20837734"
            ],
            [
                "91299 13 883710911\r\n",
                "238048909"
            ],
            [
                "92275 9 505206379\r\n",
                "372045131"
            ],
            [
                "4558 9 768001957\r\n",
                "338635790"
            ],
            [
                "53812 4 967428361\r\n",
                "950881274"
            ],
            [
                "93705 8 728681249\r\n",
                "90464274"
            ],
            [
                "4866 5 828460181\r\n",
                "236115936"
            ],
            [
                "95449 16 477786341\r\n",
                "181225428"
            ],
            [
                "319 6 736338271\r\n",
                "133698563"
            ],
            [
                "59614 14 431666281\r\n",
                "382826545"
            ],
            [
                "67260 11 159230609\r\n",
                "38214063"
            ],
            [
                "74973 12 872697443\r\n",
                "741474461"
            ],
            [
                "65610 7 576223171\r\n",
                "475692890"
            ],
            [
                "9292 12 386116849\r\n",
                "339357599"
            ],
            [
                "58370 15 756534617\r\n",
                "174119749"
            ],
            [
                "20621 4 420701179\r\n",
                "289746143"
            ]
        ]
    }
]