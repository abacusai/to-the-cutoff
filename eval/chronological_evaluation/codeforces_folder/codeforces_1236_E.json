[
    {
        "name": "Alice and the Unfair Game",
        "description": "Alice is playing a game with her good friend, Marisa. There are \n    n\n boxes\narranged in a line, numbered with integers from \n    1\n to \n    n\n from left\nto right. Marisa will hide a doll in one of the boxes. Then Alice will have\n\n    m\n chances to guess where the doll is. If Alice will correctly guess the\nnumber of box, where doll is now, she will win the game, otherwise, her friend\nwill win the game. In order to win, Marisa will use some unfair tricks. After\neach time Alice guesses a box, she can move the doll to the neighboring box or\njust keep it at its place. Boxes \n    i\n and \n    i + 1\n are neighboring for\nall \n    1 \n    \u2264 i \n    \u2264 n - 1\n. She can also use this trick once before the\ngame starts. So, the game happens in this order: the game starts, Marisa makes\nthe trick, Alice makes the first guess, Marisa makes the trick, Alice makes\nthe second guess, Marisa makes the trick, \n    \u2026\n, Alice makes\n\n    m\n-th guess, Marisa makes the trick, the game ends. Alice has come up\nwith a sequence \n    a_1, a_2, \n    \u2026, a_m\n. In the \n    i\n-th guess, she\nwill ask if the doll is in the box \n    a_i\n. She wants to know the number of\nscenarios \n    (x, y)\n (for all \n    1 \n    \u2264 x, y \n    \u2264 n\n), such that\nMarisa can win the game if she will put the doll at the \n    x\n-th box at the\nbeginning and at the end of the game, the doll will be at the \n    y\n-th box.\nHelp her and calculate this number. Input The first line contains two integers\n\n    n\n and \n    m\n, separated by space (\n    1 \n    \u2264 n, m \n    \u2264 10^5\n) \u2014\nthe number of boxes and the number of guesses, which Alice will make. The next\nline contains \n    m\n integers \n    a_1, a_2, \n    \u2026, a_m\n, separated by\nspaces (\n    1 \n    \u2264 a_i \n    \u2264 n\n), the number \n    a_i\n means the number of\nthe box which Alice will guess in the \n    i\n-th guess. Output Print the\nnumber of scenarios in a single line, or the number of pairs of boxes \n    (x,\n    y)\n (\n    1 \n    \u2264 x, y \n    \u2264 n\n), such that if Marisa will put the doll\ninto the box with number \n    x\n, she can make tricks in such way, that at the\nend of the game the doll will be in the box with number \n    y\n and she will\nwin the game. Examples Input 3 3 2 2 2 Output 7 Input 5 2 3 1 Output 21 Note\nIn the first example, the possible scenarios are \n    (1, 1)\n, \n    (1, 2)\n,\n\n    (2, 1)\n, \n    (2, 2)\n, \n    (2, 3)\n, \n    (3, 2)\n, \n    (3, 3)\n. Let's\ntake \n    (2, 2)\n as an example. The boxes, in which the doll will be during\nthe game can be \n    2 \n    \u2192 3 \n    \u2192 3 \n    \u2192 3 \n    \u2192 2\n\n\n",
        "cf_contest_id": 1236,
        "cf_index": "E",
        "cf_rating": 2500,
        "difficulty": 0,
        "cf_tags": [
            "binary search",
            "data structures",
            "dp",
            "dsu"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "3 3\r\n2 2 2\r\n",
                "7"
            ],
            [
                "5 2\r\n3 1\r\n",
                "21"
            ]
        ],
        "private_cases": [
            [
                "9 10\r\n9 8 7 4 5 8 1 6 8 2\r\n",
                "81"
            ],
            [
                "10 10\r\n1 9 7 6 2 4 7 8 1 3\r\n",
                "100"
            ],
            [
                "1 1\r\n1\r\n",
                "0\r\n"
            ],
            [
                "2 1\r\n2\r\n",
                "4"
            ],
            [
                "3 1\r\n2\r\n",
                "7"
            ],
            [
                "4 1\r\n1\r\n",
                "14"
            ],
            [
                "1 10\r\n1 1 1 1 1 1 1 1 1 1\r\n",
                "0\r\n"
            ],
            [
                "2 10\r\n1 2 1 1 2 2 2 2 2 2\r\n",
                "4"
            ],
            [
                "3 10\r\n3 2 2 2 3 1 3 3 3 1\r\n",
                "9"
            ],
            [
                "4 10\r\n4 1 4 2 2 1 4 3 3 1\r\n",
                "16"
            ],
            [
                "5 10\r\n3 2 4 3 3 4 2 5 3 2\r\n",
                "25"
            ],
            [
                "6 10\r\n5 3 4 3 2 3 1 6 1 1\r\n",
                "36"
            ],
            [
                "7 10\r\n1 1 7 7 3 4 6 3 2 3\r\n",
                "49"
            ],
            [
                "8 10\r\n2 8 3 8 5 6 5 5 4 4\r\n",
                "64"
            ],
            [
                "5 1\r\n1\r\n",
                "19"
            ],
            [
                "6 1\r\n5\r\n",
                "22"
            ],
            [
                "7 1\r\n3\r\n",
                "27"
            ],
            [
                "8 1\r\n8\r\n",
                "34"
            ],
            [
                "9 1\r\n7\r\n",
                "37"
            ],
            [
                "10 1\r\n1\r\n",
                "44"
            ],
            [
                "1000 100\r\n343 745 296 856 507 192 780 459 9 193 753 28 334 871 589 105 612 751 708 129 32 628 974 641 323 596 604 759 906 272 606 898 726 304 279 448 589 565 735 53 935 966 424 363 153 900 722 597 501 125 512 282 744 460 529 488 67 895 407 863 59 984 211 458 578 461 999 10 411 521 738 842 689 160 168 924 313 926 576 106 11 585 772 694 221 403 20 842 64 113 787 161 457 998 921 813 225 633 231 78\r\n",
                "192528"
            ],
            [
                "2000 100\r\n1525 1999 265 1839 495 1756 666 602 560 1284 186 56 955 785 339 123 1365 1204 486 639 903 189 886 1054 1184 1908 474 282 176 1268 1742 198 430 1738 354 1389 995 666 1850 538 93 154 508 174 397 1622 85 1710 1849 1706 1332 1986 683 1051 1150 535 1872 1599 216 1198 441 719 576 1947 1997 60 133 262 198 1240 954 718 1119 616 1047 577 1629 777 1032 436 835 120 1740 1665 1164 152 839 1780 181 1616 256 366 1951 1211 1876 1459 1842 1606 1505 283\r\n",
                "395503"
            ],
            [
                "3000 100\r\n1002 1253 41 1014 483 911 2849 1042 1600 374 2723 867 1872 1212 2898 846 2606 144 968 1252 1287 750 2902 1571 2749 2324 1344 1508 1255 1855 2174 307 31 468 725 923 914 2255 68 2319 2548 2343 592 1794 641 240 2848 824 797 2503 1665 2178 1917 1834 771 2391 2188 2110 1834 2237 423 2047 2430 1732 825 851 971 107 984 2551 658 2489 1550 1777 2334 2422 1433 2332 1784 63 659 1759 2116 1637 514 606 1658 718 1297 2927 2509 1275 2150 2319 2727 401 1266 1683 2075 1784\r\n",
                "598503"
            ],
            [
                "4000 100\r\n1184 314 3114 3998 471 67 2327 2585 2047 3272 157 894 2981 934 2160 1568 3846 2893 2554 2761 2966 607 1110 792 3098 341 214 926 525 250 1311 1120 2143 1198 1992 3160 2321 1060 1183 1908 3002 2340 1379 3605 2181 2858 2507 1938 849 2789 2781 1075 3152 1721 3096 3734 1992 3517 747 3276 3701 2078 795 3709 2949 3450 3105 2464 3770 2374 170 68 3980 3529 917 75 3940 1374 1944 3689 1186 2294 1276 1801 3161 2356 1180 2952 1710 3535 3274 3992 540 1427 1578 1535 882 2656 3349 3477\r\n",
                "801509"
            ],
            [
                "5000 100\r\n3150 4568 3083 2877 4459 2222 2213 2729 4087 4362 1694 705 3898 553 1910 3586 3599 641 3331 271 349 3464 3319 717 2959 4461 3189 3152 4604 3541 3743 125 3039 2119 3067 3102 1535 2352 4401 3393 1161 1233 3463 1417 721 2772 3973 2051 1901 2074 3113 3267 1090 2311 1717 589 1796 28 260 3908 1979 5 3160 2494 1368 2241 2239 309 3853 93 3385 3944 1114 2881 4204 2728 3256 929 593 2827 1010 3829 2948 2773 103 4297 2999 4186 4018 2846 743 901 2034 1343 1022 181 4306 3925 2624 978\r\n",
                "1004505"
            ],
            [
                "6000 100\r\n4331 117 2860 2156 447 5082 3395 4169 2639 5453 2127 3732 2815 5275 4172 2308 3544 1286 1405 1588 1028 1025 743 5234 3524 2069 5059 3378 874 128 4880 234 3151 849 2142 2339 1646 1453 4516 4878 4615 5421 5738 1229 5965 3198 3632 5973 5144 5167 2934 4163 324 2902 338 148 4113 732 4173 3947 4257 1036 3526 5983 3004 840 5565 2858 5151 5108 5897 5819 2840 2041 5491 277 4764 3779 4345 2158 834 5172 2812 5041 2454 4047 4114 316 1431 5053 4804 5811 4424 1451 3873 1019 1218 5706 4794 4479\r\n",
                "1207504"
            ],
            [
                "7000 100\r\n809 6179 2933 5332 6435 4045 4578 3312 678 3247 6664 351 2732 6190 1923 4326 2489 3034 3991 2097 603 3882 1951 456 4577 382 3929 1092 1249 6227 6312 6342 2047 3283 3217 3873 4053 1450 2630 2955 69 3418 526 2336 1505 1112 4099 87 4900 452 1754 2059 3559 6789 4151 3195 5917 435 3982 3282 3534 5067 1379 1959 5424 439 4107 1511 5233 4123 1601 1590 975 4497 74 930 2568 526 5505 2784 5362 3 6484 2908 4396 5796 4444 4254 3251 2660 4569 5720 1622 4560 4724 1961 643 6679 1068 3684\r\n",
                "1410500"
            ],
            [
                "8000 100\r\n7990 4432 5901 5019 423 1200 7760 5752 7422 4337 4802 2570 7354 4912 2185 2344 6538 2783 1473 5311 3987 4739 7159 1677 3438 502 2800 1318 5223 4518 4448 6451 3455 5012 1588 814 4971 5847 3849 6248 6420 3607 2610 6852 1045 3730 757 6905 5248 3738 2382 7251 1305 7380 2476 7346 5721 5946 7599 5321 620 3802 5744 3744 2548 6230 5241 7059 6020 7842 7816 466 3109 2953 1361 7583 4884 6377 3257 3410 4482 7538 7452 1880 1043 6250 263 6192 5664 4972 6334 4333 1013 5476 2872 7095 2259 4949 5342 2185\r\n",
                "1613498"
            ],
            [
                "9000 100\r\n468 4494 1974 6298 8307 5060 942 191 7166 3427 3339 8189 7463 4530 8935 770 4482 6531 6250 116 8666 5004 3176 8194 2491 1815 7670 8249 6493 5105 177 5456 6056 742 7663 3052 8378 7844 2963 3733 1874 3603 6693 8959 8289 6644 224 314 7196 2535 4203 6147 6539 3971 1097 201 6037 8354 1216 3360 4602 6026 5110 1233 6375 3829 1375 1904 806 5857 2624 4341 7835 3409 5648 428 7392 8931 6905 4741 2202 4881 20 6852 7393 1000 6082 130 1780 2283 7099 3242 8507 3584 5019 5037 3683 3026 1912 6687\r\n",
                "1816501"
            ],
            [
                "10000 100\r\n4544 8312 5862 939 8211 3380 6031 1809 403 6481 9611 1867 3995 2475 8463 6414 8437 1439 7839 417 116 9582 9111 4367 876 1230 5526 4297 4180 5768 9854 1538 8763 4843 5654 5489 9872 584 6600 9378 6633 1476 3123 6181 7533 1721 6122 4206 5642 868 6802 3699 6240 3033 9960 9921 6371 699 6633 6376 7453 6228 617 9754 9977 5875 8269 4880 73 3129 6048 1797 8514 5595 1122 889 2011 7363 8276 8031 3602 207 6829 9279 3398 3136 3032 1013 9246 6893 4900 2208 2288 9614 5923 9876 2283 2657 4523 5304\r\n",
                "2019503"
            ],
            [
                "100000 1\r\n63256\r\n",
                "499992"
            ],
            [
                "100000 2\r\n46680 84411\r\n",
                "699984"
            ],
            [
                "100000 3\r\n62808 76360 42404\r\n",
                "899974"
            ],
            [
                "100000 4\r\n46233 25204 79854 39075\r\n",
                "1099962"
            ],
            [
                "100000 5\r\n29657 41344 93111 68553 91316\r\n",
                "1299948"
            ],
            [
                "100000 6\r\n13081 90189 97857 54927 7866 52421\r\n",
                "1499932"
            ],
            [
                "100000 7\r\n29209 71737 78411 51700 57119 31198 40258\r\n",
                "1699914"
            ],
            [
                "100000 8\r\n79929 87878 83156 81178 82181 77270 36433 21187\r\n",
                "1899894"
            ],
            [
                "100000 9\r\n96057 12530 96414 43360 31434 80239 8416 37879 56578\r\n",
                "2099872"
            ],
            [
                "100000 10\r\n13202 14678 45343 53910 34297 96330 24175 45117 25650 55090\r\n",
                "2299848"
            ],
            [
                "3 10\r\n3 3 3 3 3 3 3 3 3 3\r\n",
                "9"
            ],
            [
                "4 10\r\n1 1 1 1 1 1 1 1 1 3\r\n",
                "16"
            ],
            [
                "5 10\r\n2 2 2 2 2 2 2 2 2 2\r\n",
                "19"
            ],
            [
                "6 10\r\n4 4 4 4 4 4 4 4 4 1\r\n",
                "29"
            ],
            [
                "7 10\r\n2 2 2 2 2 2 2 2 2 1\r\n",
                "45"
            ],
            [
                "8 10\r\n7 7 7 7 7 7 7 7 7 2\r\n",
                "59"
            ],
            [
                "9 10\r\n8 8 8 8 8 8 8 8 8 5\r\n",
                "75"
            ],
            [
                "10 10\r\n9 9 9 9 9 9 9 9 9 6\r\n",
                "93"
            ],
            [
                "100000 1\r\n50000\r\n",
                "499992"
            ]
        ]
    }
]