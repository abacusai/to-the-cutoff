[
    {
        "name": "Stairs",
        "description": "For a permutation \n    p\n of numbers \n    1\n through \n    n\n, we define a\nstair array \n    a\n as follows: \n    a_i\n is length of the longest segment of\npermutation which contains position \n    i\n and is made of consecutive values\nin sorted order: \n    [x, x+1, \n    \u2026, y-1, y]\n or \n    [y, y-1, \n    \u2026,\n    x+1, x]\n for some \n    x \n    \u2264 y\n. For example, for permutation \n    p = [4,\n    1, 2, 3, 7, 6, 5]\n we have \n    a = [1, 3, 3, 3, 3, 3, 3]\n. You are given\nthe stair array \n    a\n. Your task is to calculate the number of permutations\nwhich have stair array equal to \n    a\n. Since the number can be big, compute\nit modulo \n    998\n     244\n     353\n. Note that this number can be equal to zero.\nInput The first line of input contains integer \n    n\n (\n    1 \n    \u2264 n \n    \u2264\n    10^5\n) \u2014 the length of a stair array \n    a\n. The second line of input\ncontains \n    n\n integers \n    a_1, a_2, \n    \u2026, a_n\n (\n    1 \n    \u2264 a_i \n    \u2264\n    n\n). Output Print the number of permutations which have stair array equal to\n\n    a\n. Since the number can be big, compute it modulo\n\n    998\n     244\n     353\n. Examples Input 6 3 3 3 1 1 1 Output 6 Input 7 4 4 4 4\n3 3 3 Output 6 Input 1 1 Output 1 Input 8 2 2 2 2 2 2 1 1 Output 370 Input 4 3\n2 3 1 Output 0\n\n",
        "cf_contest_id": 1553,
        "cf_index": "I",
        "cf_rating": 3400,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "divide and conquer",
            "dp",
            "fft",
            "math"
        ],
        "time_limit_seconds": 10.0,
        "memory_limit_bytes": 1024.0,
        "public_cases": [
            [
                "6\r\n3 3 3 1 1 1\r\n",
                "6\r\n"
            ],
            [
                "7\r\n4 4 4 4 3 3 3\r\n",
                "6\r\n"
            ],
            [
                "1\r\n1\r\n",
                "1\r\n"
            ],
            [
                "8\r\n2 2 2 2 2 2 1 1\r\n",
                "370\r\n"
            ],
            [
                "4\r\n3 2 3 1\r\n",
                "0"
            ]
        ],
        "private_cases": []
    }
]