[
    {
        "name": "Beautiful Matrix",
        "description": "Petya collects beautiful matrix. A matrix of size \n    n \n    \u00d7 n\n is\nbeautiful if: All elements of the matrix are integers between \n    1\n and\n\n    n\n; For every row of the matrix, all elements of this row are different;\nFor every pair of vertically adjacent elements, these elements are different.\nToday Petya bought a beautiful matrix \n    a\n of size \n    n \n    \u00d7 n\n, and\nnow he wants to determine its rarity. The rarity of the matrix is its index in\nthe list of beautiful matrices of size \n    n \n    \u00d7 n\n, sorted in\nlexicographical order. Matrix comparison is done row by row. (The index of\nlexicographically smallest matrix is zero). Since the number of beautiful\nmatrices may be huge, Petya wants you to calculate the rarity of the matrix\n\n    a\n modulo \n    998\n     244\n     353\n. Input The first line contains one\ninteger \n    n\n (\n    1 \n    \u2264 n \n    \u2264 2000\n) \u2014 the number of rows and columns\nin \n    a\n. Each of the next \n    n\n lines contains \n    n\n integers\n\n    a_i,j\n (\n    1 \n    \u2264 a_i,j\n    \u2264 n\n) \u2014 the elements of \n    a\n. It is\nguaranteed that \n    a\n is a beautiful matrix. Output Print one integer \u2014 the\nrarity of matrix \n    a\n, taken modulo \n    998\n     244\n     353\n. Examples Input\n2 2 1 1 2 Output 1 Input 3 1 2 3 2 3 1 3 1 2 Output 1 Input 3 1 2 3 3 1 2 2 3\n1 Output 3 Note There are only \n    2\n beautiful matrices of size \n    2\n    \n    \u00d7 2\n: There are the first \n    5\n beautiful matrices of size \n    3\n    \n    \u00d7 3\n in lexicographical order:\n\n",
        "cf_contest_id": 1085,
        "cf_index": "G",
        "cf_rating": 2900,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "data structures",
            "dp"
        ],
        "time_limit_seconds": 4.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "2\r\n2 1\r\n1 2\r\n",
                "1"
            ],
            [
                "3\r\n1 2 3\r\n2 3 1\r\n3 1 2\r\n",
                "1"
            ],
            [
                "3\r\n1 2 3\r\n3 1 2\r\n2 3 1\r\n",
                "3"
            ]
        ],
        "private_cases": [
            [
                "1\r\n1\r\n",
                "0"
            ],
            [
                "5\r\n1 4 2 3 5\r\n5 1 3 4 2\r\n3 2 4 1 5\r\n1 4 5 3 2\r\n5 2 3 4 1\r\n",
                "47918238"
            ],
            [
                "10\r\n5 1 6 2 8 3 4 10 9 7\r\n1 9 3 6 4 5 7 2 10 8\r\n10 1 7 8 3 2 4 6 5 9\r\n7 8 10 9 6 5 2 1 4 3\r\n6 5 1 3 2 7 9 10 8 4\r\n8 2 3 7 6 1 10 5 4 9\r\n9 6 8 5 10 3 1 7 2 4\r\n1 10 9 8 7 2 4 5 3 6\r\n5 8 2 6 4 3 9 10 7 1\r\n1 7 4 3 2 10 8 6 5 9\r\n",
                "428771577"
            ]
        ]
    }
]