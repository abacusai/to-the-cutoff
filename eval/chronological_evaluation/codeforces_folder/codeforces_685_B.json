[
    {
        "name": "Kay and Snowflake",
        "description": "After the piece of a devilish mirror hit the Kay's eye, he is no longer\ninterested in the beauty of the roses. Now he likes to watch snowflakes. Once\nupon a time, he found a huge snowflake that has a form of the tree (connected\nacyclic graph) consisting of n nodes. The root of tree has index 1. Kay is\nvery interested in the structure of this tree. After doing some research he\nformed q queries he is interested in. The i-th query asks to find a centroid\nof the subtree of the node vi. Your goal is to answer all queries. Subtree of\na node is a part of tree consisting of this node and all it's descendants\n(direct or not). In other words, subtree of node v is formed by nodes u, such\nthat node v is present on the path from u to root. Centroid of a tree (or a\nsubtree) is a node, such that if we erase it from the tree, the maximum size\nof the connected component will be at least two times smaller than the size of\nthe initial tree (or a subtree). Input The first line of the input contains\ntwo integers n and q (2 \u2264 n \u2264 300 000, 1 \u2264 q \u2264 300 000) \u2014 the size of the\ninitial tree and the number of queries respectively. The second line contains\nn - 1 integer p2, p3, ..., pn (1 \u2264 pi \u2264 n) \u2014 the indices of the parents of the\nnodes from 2 to n. Node 1 is a root of the tree. It's guaranteed that pi\ndefine a correct tree. Each of the following q lines contain a single integer\nvi (1 \u2264 vi \u2264 n) \u2014 the index of the node, that define the subtree, for which we\nwant to find a centroid. Output For each query print the index of a centroid\nof the corresponding subtree. If there are many suitable nodes, print any of\nthem. It's guaranteed, that each subtree has at least one centroid. Example\nInput 7 4 1 1 3 3 5 3 1 2 3 5 Output 3 2 3 6 Note The first query asks for a\ncentroid of the whole tree \u2014 this is node 3. If we delete node 3 the tree will\nsplit in four components, two of size 1 and two of size 2. The subtree of the\nsecond node consists of this node only, so the answer is 2. Node 3 is centroid\nof its own subtree. The centroids of the subtree of the node 5 are nodes 5 and\n6 \u2014 both answers are considered correct.\n\n",
        "cf_contest_id": 685,
        "cf_index": "B",
        "cf_rating": 1900,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "dfs and similar",
            "dp",
            "trees"
        ],
        "time_limit_seconds": 3.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "7 4\r\n1 1 3 3 5 3\r\n1\r\n2\r\n3\r\n5\r\n",
                "3\r\n2\r\n3\r\n6\r\n"
            ]
        ],
        "private_cases": [
            [
                "2 2\r\n1\r\n1\r\n2\r\n",
                "2\r\n2\r\n"
            ]
        ]
    }
]