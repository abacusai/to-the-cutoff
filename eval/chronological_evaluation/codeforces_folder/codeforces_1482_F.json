[
    {
        "name": "Useful Edges",
        "description": "You are given a weighted undirected graph on \n    n\n vertices along with\n\n    q\n triples \n    (u, v, l)\n, where in each triple \n    u\n and \n    v\n are\nvertices and \n    l\n is a positive integer. An edge \n    e\n is called useful\nif there is at least one triple \n    (u, v, l)\n and a path (not necessarily\nsimple) with the following properties: \n    u\n and \n    v\n are the endpoints\nof this path, \n    e\n is one of the edges of this path, the sum of weights of\nall edges on this path doesn't exceed \n    l\n. Please print the number of\nuseful edges in this graph. Input The first line contains two integers \n    n\n\nand \n    m\n (\n    2\n    \u2264 n\n    \u2264 600\n, \n    0\n    \u2264 m\n    \u2264\n    n(n-1)/2\n). Each of the following \n    m\n lines contains three\nintegers \n    u\n, \n    v\n and \n    w\n (\n    1\n    \u2264 u, v\n    \u2264 n\n, \n    u\n    \u2260\n    v\n, \n    1\n    \u2264 w\n    \u2264 10^9\n), denoting an edge connecting vertices\n\n    u\n and \n    v\n and having a weight \n    w\n. The following line contains\nthe only integer \n    q\n (\n    1\n    \u2264 q\n    \u2264\n    n(n-1)/2\n) denoting the\nnumber of triples. Each of the following \n    q\n lines contains three integers\n\n    u\n, \n    v\n and \n    l\n (\n    1\n    \u2264 u, v\n    \u2264 n\n, \n    u\n    \u2260 v\n,\n\n    1\n    \u2264 l\n    \u2264 10^9\n) denoting a triple \n    (u, v, l)\n. It's guaranteed\nthat: the graph doesn't contain loops or multiple edges; all pairs \n    (u,\n    v)\n in the triples are also different. Output Print a single integer\ndenoting the number of useful edges in the graph. Examples Input 4 6 1 2 1 2 3\n1 3 4 1 1 3 3 2 4 3 1 4 5 1 1 4 4 Output 5 Input 4 2 1 2 10 3 4 10 6 1 2 11 1\n3 11 1 4 11 2 3 11 2 4 11 3 4 9 Output 1 Input 3 2 1 2 1 2 3 2 1 1 2 5 Output\n2 Note In the first example each edge is useful, except the one of weight\n\n    5\n. In the second example only edge between \n    1\n and \n    2\n is\nuseful, because it belongs to the path \n    1-2\n, and \n    10 \n    \u2264 11\n. The\nedge between \n    3\n and \n    4\n, on the other hand, is not useful. In the\nthird example both edges are useful, for there is a path \n    1-2-3-2\n of\nlength exactly \n    5\n. Please note that the path may pass through a vertex\nmore than once.\n\n",
        "cf_contest_id": 1482,
        "cf_index": "F",
        "cf_rating": 2400,
        "difficulty": 0,
        "cf_tags": [
            "graphs",
            "shortest paths"
        ],
        "time_limit_seconds": 5.0,
        "memory_limit_bytes": 512.0,
        "public_cases": [],
        "private_cases": []
    }
]