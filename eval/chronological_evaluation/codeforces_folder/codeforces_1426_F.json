[
    {
        "name": "Number of Subsequences",
        "description": "You are given a string \n    s\n consisting of lowercase Latin letters \"a\", \"b\"\nand \"c\" and question marks \"?\". Let the number of question marks in the string\n\n    s\n be \n    k\n. Let's replace each question mark with one of the letters\n\"a\", \"b\" and \"c\". Here we can obtain all \n    3^k\n possible strings\nconsisting only of letters \"a\", \"b\" and \"c\". For example, if \n    s =\n\"ac?b?c\" then we can obtain the following strings: \n    [\n\"acabac\",\n\"acabbc\", \"acabcc\", \"acbbac\", \"acbbbc\", \"acbbcc\", \"accbac\", \"accbbc\",\n\"accbcc\"\n    ]\n. Your task is to count the total number of subsequences \"abc\"\nin all resulting strings. Since the answer can be very large, print it modulo\n\n    10^9 + 7\n. A subsequence of the string \n    t\n is such a sequence that\ncan be derived from the string \n    t\n after removing some (possibly, zero)\nnumber of letters without changing the order of remaining letters. For\nexample, the string \"baacbc\" contains two subsequences \"abc\" \u2014 a subsequence\nconsisting of letters at positions \n    (2, 5, 6)\n and a subsequence\nconsisting of letters at positions \n    (3, 5, 6)\n. Input The first line of\nthe input contains one integer \n    n\n \n    (3 \n    \u2264 n \n    \u2264 200\n     000)\n \u2014\nthe length of \n    s\n. The second line of the input contains the string\n\n    s\n of length \n    n\n consisting of lowercase Latin letters \"a\", \"b\" and\n\"c\" and question marks\"?\". Output Print the total number of subsequences \"abc\"\nin all strings you can obtain if you replace all question marks with letters\n\"a\", \"b\" and \"c\", modulo \n    10^9 + 7\n. Examples Input 6 ac?b?c Output 24\nInput 7 ??????? Output 2835 Input 9 cccbbbaaa Output 0 Input 5 a???c Output 46\nNote In the first example, we can obtain \n    9\n strings: \"acabac\" \u2014 there are\n\n    2\n subsequences \"abc\", \"acabbc\" \u2014 there are \n    4\n subsequences \"abc\",\n\"acabcc\" \u2014 there are \n    4\n subsequences \"abc\", \"acbbac\" \u2014 there are \n    2\n\nsubsequences \"abc\", \"acbbbc\" \u2014 there are \n    3\n subsequences \"abc\", \"acbbcc\"\n\u2014 there are \n    4\n subsequences \"abc\", \"accbac\" \u2014 there is \n    1\n\nsubsequence \"abc\", \"accbbc\" \u2014 there are \n    2\n subsequences \"abc\", \"accbcc\" \u2014\nthere are \n    2\n subsequences \"abc\". So, there are \n    2 + 4 + 4 + 2 + 3 + 4 +\n    1 + 2 + 2 = 24\n subsequences \"abc\" in total.\n\n",
        "cf_contest_id": 1426,
        "cf_index": "F",
        "cf_rating": 2000,
        "difficulty": 0,
        "cf_tags": [
            "combinatorics",
            "dp",
            "strings"
        ],
        "time_limit_seconds": 1.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "6\r\nac?b?c\r\n",
                "24\r\n"
            ],
            [
                "7\r\n???????\r\n",
                "2835\r\n"
            ],
            [
                "9\r\ncccbbbaaa\r\n",
                "0\r\n"
            ],
            [
                "5\r\na???c\r\n",
                "46\r\n"
            ]
        ],
        "private_cases": [
            [
                "3\r\n???\r\n",
                "1\r\n"
            ],
            [
                "3\r\nabc\r\n",
                "1\r\n"
            ],
            [
                "100\r\naccbaccabccbbbbabacabaaccacbcbcababbbcbcbcccabcbbc?caaabcabcaaccbccabaaaaccacabbaabcbbccbbababaacbca\r\n",
                "14634\r\n"
            ],
            [
                "100\r\ncbcbacbbba?aacaccabbabcbcbbccaccabcbbcbabc?bbbcabaabaabbccabbcabacbbcbacacccbaabcbcbaccababbbbccbaca\r\n",
                "53175\r\n"
            ],
            [
                "100\r\ncabcaabababcacaabaaccbaabcabcbaccbbcaabbbbacabbbcacbabaaabcaccbbacbabccabaabbaccaaacaabbabcaacaacccc\r\n",
                "7687\r\n"
            ],
            [
                "100\r\n??b?a?a???aca?c?a?ca??????ac?b???aabb?c?ac??cbca???a?b????baa?ca??b???cbc??c??ab?ac???c?bcbb?c??abac\r\n",
                "331264319\r\n"
            ],
            [
                "200\r\n???c????????ba?????c?b???c???a??a?b??bb?c???cccc?ac?????c??????b??c?aa?cb?ca?a??cc?b???a?c???c??bbb?cacbbac?ccc?a?aca??b??a??c?c?a??????b??a????baa?a?a?????a????bb??b?????ac?b?aacb??c????????a?c??????\r\n",
                "821576000\r\n"
            ],
            [
                "300\r\ncc?aabbb?ba?cbcb??b??ababcabcb???b?bcb?ac??a?acc?cba?aa?a???bc?????ca??ac???cb??caaca???aabbc?cb?bb?a?bbb?a?cbbaccbcaab?a???baab?ac?ab??a?b?ac?acbcbb?cc??bbbcc?c??cab?cac?c???accb???c?cc?bb???b?bca?bbaccca??b?c?bb?b?a??ccb?c?abbc?aaa???bca?ccb?bb?c?b???c???bcac??ca?ba?a?cbabbb??b?aaaba??b??a?bbcbbcb\r\n",
                "944418931\r\n"
            ]
        ]
    }
]