[
    {
        "name": "Powering the Hero (hard version)",
        "description": "This is a hard version of the problem. It differs from the easy one only by\nconstraints on \n    n\n and \n    t\n. There is a deck of \n    n\n cards, each of\nwhich is characterized by its power. There are two types of cards: a hero\ncard, the power of such a card is always equal to \n    0\n; a bonus card, the\npower of such a card is always positive. You can do the following with the\ndeck: take a card from the top of the deck; if this card is a bonus card, you\ncan put it on top of your bonus deck or discard; if this card is a hero card,\nthen the power of the top card from your bonus deck is added to his power (if\nit is not empty), after that the hero is added to your army, and the used\nbonus discards. Your task is to use such actions to gather an army with the\nmaximum possible total power. Input The first line of input data contains\nsingle integer \n    t\n (\n    1 \n    \u2264 t \n    \u2264 10^4\n) \u2014 the number of test cases\nin the test. The first line of each test case contains one integer \n    n\n\n(\n    1 \n    \u2264 n \n    \u2264 2 \n    \u00b7 10^5\n) \u2014 the number of cards in the deck. The\nsecond line of each test case contains \n    n\n integers \n    s_1, s_2, \n    \u2026,\n    s_n\n (\n    0 \n    \u2264 s_i \n    \u2264 10^9\n) \u2014 card powers in top-down order. It is\nguaranteed that the sum of \n    n\n over all test cases does not exceed \n    2\n    \n    \u00b7 10^5\n. Output Output \n    t\n numbers, each of which is the answer to\nthe corresponding test case \u2014 the maximum possible total power of the army\nthat can be achieved. Example Input 5 5 3 3 3 0 0 6 0 3 3 0 0 3 7 1 2 3 0 4 5\n0 7 1 2 5 0 4 3 0 5 3 1 0 0 4 Output 6 6 8 9 4 Note In the first sample, you\ncan take bonuses \n    1\n and \n    2\n. Both hero cards will receive \n    3\n\npower. If you take all the bonuses, one of them will remain unused. In the\nsecond sample, the hero's card on top of the deck cannot be powered up, and\nthe rest can be powered up with \n    2\n and \n    3\n bonuses and get \n    6\n\ntotal power. In the fourth sample, you can take bonuses \n    1\n, \n    2\n,\n\n    3\n, \n    5\n and skip the bonus \n    6\n, then the hero \n    4\n will be\nenhanced with a bonus \n    3\n by \n    5\n, and the hero \n    7\n with a bonus\n\n    5\n by \n    4\n. \n    4+5=9\n.\n\n",
        "cf_contest_id": 1800,
        "cf_index": "C2",
        "cf_rating": 1100,
        "difficulty": 0,
        "cf_tags": [
            "data structures",
            "greedy"
        ],
        "time_limit_seconds": 2.0,
        "memory_limit_bytes": 256.0,
        "public_cases": [
            [
                "5\r\n5\r\n3 3 3 0 0\r\n6\r\n0 3 3 0 0 3\r\n7\r\n1 2 3 0 4 5 0\r\n7\r\n1 2 5 0 4 3 0\r\n5\r\n3 1 0 0 4\r\n",
                "6\r\n6\r\n8\r\n9\r\n4\r\n"
            ]
        ],
        "private_cases": [
            [
                "1\r\n3\r\n520 1107 1314\r\n",
                "0\r\n"
            ],
            [
                "1\r\n2\r\n81392 0\r\n",
                "81392\r\n"
            ],
            [
                "1\r\n3\r\n5656 535165 55165\r\n",
                "0\r\n"
            ]
        ]
    }
]